# –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω –º–æ–¥–µ—Ä–Ω–∏–∑–∞—Ü–∏–∏ –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞

**–î–∞—Ç–∞:** 2025-01-XX  
**–í–µ—Ä—Å–∏—è:** 4.0.0  
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é  
**–û—Å–Ω–æ–≤–∞–Ω –Ω–∞:** `MULTIMODAL_ROUTE_SYSTEM_IMPROVEMENT_PLAN.md`, `IMPROVED_TECHNICAL_PLAN.md`, `diagnostic_technical.md`

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∏ –∫–ª—é—á–µ–≤—ã–µ –∑–∞–¥–∞—á–∏](#1-–≥–ª—É–±–æ–∫–∏–π-–∞–Ω–∞–ª–∏–∑-–∏-–∫–ª—é—á–µ–≤—ã–µ-–∑–∞–¥–∞—á–∏)
2. [–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —ç—Ç–∞–ø–∞–º–∏](#2-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏-–º–µ–∂–¥—É-—ç—Ç–∞–ø–∞–º–∏)
3. [–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏](#3-–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ-–æ—à–∏–±–∫–∏)
4. [–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω —Ä–∞–±–æ—Ç (Milestones)](#4-—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π-–ø–æ—à–∞–≥–æ–≤—ã–π-–ø–ª–∞–Ω-—Ä–∞–±–æ—Ç-milestones)
5. [–ù–∞–±–æ—Ä –∑–∞–¥–∞—á –¥–ª—è Cursor](#5-–Ω–∞–±–æ—Ä-–∑–∞–¥–∞—á-–¥–ª—è-cursor)
6. [–ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è](#6-–ø–æ—Ä—è–¥–æ–∫-–≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è)
7. [–°—Ö–µ–º—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≥—Ä–∞—Ñ–∞](#7-—Å—Ö–µ–º—ã-–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è-–≥—Ä–∞—Ñ–∞)
8. [–ò—Ç–æ–≥–æ–≤—ã–π –ø–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏](#8-–∏—Ç–æ–≥–æ–≤—ã–π-–ø–ª–∞–Ω-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)

---

## 1. –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∏ –∫–ª—é—á–µ–≤—ã–µ –∑–∞–¥–∞—á–∏

### 1.1 –ö–ª—é—á–µ–≤—ã–µ –∑–∞–¥–∞—á–∏ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º

#### üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï (–±–ª–æ–∫–∏—Ä—É—é—Ç —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã)

1. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ "–Ø–∫—É—Ç—Å–∫"**
   - –ü—Ä–æ–±–ª–µ–º–∞: `extractCityFromStopName()` –∏–∑–≤–ª–µ–∫–∞–µ—Ç "–¢—É–π–º–∞–∞–¥–∞" –≤–º–µ—Å—Ç–æ "–Ø–∫—É—Ç—Å–∫"
   - –í–ª–∏—è–Ω–∏–µ: –Ø–∫—É—Ç—Å–∫ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø—Ä–∏ –ø–æ–∏—Å–∫–µ, –º–∞—Ä—à—Ä—É—Ç—ã –Ω–µ —Å—Ç—Ä–æ—è—Ç—Å—è
   - –§–∞–π–ª—ã: `city-normalizer.ts`, `ODataSyncWorker.ts`, `RouteGraphBuilder.ts`

2. **–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–∂–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞ "–¢—É–π–º–∞–¥–∞"**
   - –ü—Ä–æ–±–ª–µ–º–∞: "–¢—É–π–º–∞–∞–¥–∞" —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥
   - –í–ª–∏—è–Ω–∏–µ: –ú—É—Å–æ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –ë–î, –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π
   - –§–∞–π–ª—ã: `ODataSyncWorker.ts`, `VirtualEntitiesGeneratorWorker.ts`

3. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –º—É—Å–æ—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ OData**
   - –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ –ë–î
   - –í–ª–∏—è–Ω–∏–µ: –ú—É—Å–æ—Ä–Ω—ã–µ –≥–æ—Ä–æ–¥–∞, –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, –æ–ø–µ—á–∞—Ç–∫–∏
   - –§–∞–π–ª—ã: `ODataSyncWorker.ts` (–Ω—É–∂–µ–Ω –Ω–æ–≤—ã–π `stop-validator.ts`)

#### üü† –í–´–°–û–ö–ò–ï (—Ä–∞—Å—à–∏—Ä—è—é—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å)

4. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤**
   - –ü—Ä–æ–±–ª–µ–º–∞: –§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ reference
   - –í–ª–∏—è–Ω–∏–µ: –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã –∏–∑ –†–æ—Å—Å–∏–∏ –≤ –Ø–∫—É—Ç–∏—é
   - –§–∞–π–ª—ã: `VirtualEntitiesGeneratorWorker.ts`, –Ω—É–∂–µ–Ω `unified-cities-loader.ts`

5. **–°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–æ–≥–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –≥–æ—Ä–æ–¥–æ–≤**
   - –ü—Ä–æ–±–ª–µ–º–∞: –†–∞–∑–¥–µ–ª—å–Ω—ã–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ –¥–ª—è –Ø–∫—É—Ç–∏–∏ –∏ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
   - –í–ª–∏—è–Ω–∏–µ: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏, —Å–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏
   - –§–∞–π–ª—ã: –ù–æ–≤—ã–π `unified-cities-loader.ts`

#### üü° –°–†–ï–î–ù–ò–ï (—É–ª—É—á—à–∞—é—Ç –∫–∞—á–µ—Å—Ç–≤–æ)

6. **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–º–µ—à–∞–Ω–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤**
   - –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ—Ç –ø–µ—Ä–µ—Å–∞–¥–æ–∫ –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
   - –í–ª–∏—è–Ω–∏–µ: –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç "–ú–æ—Å–∫–≤–∞ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –ß—É—Ä–∞–ø—á–∞"
   - –§–∞–π–ª—ã: `GraphBuilderWorker.ts`, `RouteGraphBuilder.ts`

7. **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–ø—Ä–∞–≤—ã –Ø–∫—É—Ç—Å–∫ ‚Üî –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö**
   - –ü—Ä–æ–±–ª–µ–º–∞: Ferry-—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
   - –í–ª–∏—è–Ω–∏–µ: –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–ø—Ä–∞–≤—É
   - –§–∞–π–ª—ã: `GraphBuilderWorker.ts`, `RouteGraphBuilder.ts`, mock-–¥–∞–Ω–Ω—ã–µ

8. **–í–∞–ª–∏–¥–∞—Ü–∏—è –≥—Ä–∞—Ñ–∞**
   - –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∞
   - –í–ª–∏—è–Ω–∏–µ: –°–∫—Ä—ã—Ç—ã–µ –æ—à–∏–±–∫–∏, –ø—Ä–æ–±–ª–µ–º—ã —Å–æ —Å–≤—è–∑–Ω–æ—Å—Ç—å—é
   - –§–∞–π–ª—ã: –ù–æ–≤—ã–π `graph-validator.ts`

### 1.2 –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –∑–∞–¥–∞—á–∞–º–∏

```
[–ö–†–ò–¢–ò–ß–ù–û]
‚îú‚îÄ‚îÄ –ó–∞–¥–∞—á–∞ 1: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ø–∫—É—Ç—Å–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ –¢—Ä–µ–±—É–µ—Ç: –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∞—ç—Ä–æ–ø–æ—Ä—Ç–æ–≤ (airports-reference.json)
‚îÇ   ‚îú‚îÄ‚îÄ –¢—Ä–µ–±—É–µ—Ç: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ extractCityFromStopName()
‚îÇ   ‚îî‚îÄ‚îÄ –ë–ª–æ–∫–∏—Ä—É–µ—Ç: –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ (–¥–∞–Ω–Ω—ã–µ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã)
‚îÇ
‚îú‚îÄ‚îÄ –ó–∞–¥–∞—á–∞ 2: –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¢—É–π–º–∞–¥—ã
‚îÇ   ‚îú‚îÄ‚îÄ –ó–∞–≤–∏—Å–∏—Ç –æ—Ç: –ó–∞–¥–∞—á–∞ 1 (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ extractCityFromStopName)
‚îÇ   ‚îî‚îÄ‚îÄ –¢—Ä–µ–±—É–µ—Ç: –í–∞–ª–∏–¥–∞—Ü–∏—è –≤ ODataSyncWorker
‚îÇ
‚îî‚îÄ‚îÄ –ó–∞–¥–∞—á–∞ 3: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –º—É—Å–æ—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    ‚îú‚îÄ‚îÄ –ó–∞–≤–∏—Å–∏—Ç –æ—Ç: –ó–∞–¥–∞—á–∞ 1 (–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≥–æ—Ä–æ–¥–æ–≤)
    ‚îú‚îÄ‚îÄ –¢—Ä–µ–±—É–µ—Ç: stop-validator.ts
    ‚îî‚îÄ‚îÄ –¢—Ä–µ–±—É–µ—Ç: unified-cities-reference –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏

[–í–´–°–û–ö–ò–ô]
‚îú‚îÄ‚îÄ –ó–∞–¥–∞—á–∞ 4: –§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ –ó–∞–≤–∏—Å–∏—Ç –æ—Ç: –ó–∞–¥–∞—á–∞ 3 (–≤–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ unified-reference)
‚îÇ   ‚îú‚îÄ‚îÄ –¢—Ä–µ–±—É–µ—Ç: russia-federal-cities-reference.json
‚îÇ   ‚îî‚îÄ‚îÄ –¢—Ä–µ–±—É–µ—Ç: unified-cities-loader.ts
‚îÇ
‚îî‚îÄ‚îÄ –ó–∞–¥–∞—á–∞ 5: –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫
    ‚îú‚îÄ‚îÄ –ó–∞–≤–∏—Å–∏—Ç –æ—Ç: –ó–∞–¥–∞—á–∞ 4 (–¥–∞–Ω–Ω—ã–µ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤)
    ‚îî‚îÄ‚îÄ –ë–ª–æ–∫–∏—Ä—É–µ—Ç: –ó–∞–¥–∞—á–∞ 4 (–Ω—É–∂–µ–Ω –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏)

[–°–†–ï–î–ù–ò–ô]
‚îú‚îÄ‚îÄ –ó–∞–¥–∞—á–∞ 6: –°–º–µ—à–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ –ó–∞–≤–∏—Å–∏—Ç –æ—Ç: –ó–∞–¥–∞—á–∞ 4 (—Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞)
‚îÇ   ‚îú‚îÄ‚îÄ –ó–∞–≤–∏—Å–∏—Ç –æ—Ç: –ó–∞–¥–∞—á–∞ 7 (ferry –¥–ª—è –ø–µ—Ä–µ–ø—Ä–∞–≤—ã)
‚îÇ   ‚îî‚îÄ‚îÄ –¢—Ä–µ–±—É–µ—Ç: –†—ë–±—Ä–∞ –ø–µ—Ä–µ—Å–∞–¥–∫–∏ –≤ GraphBuilderWorker
‚îÇ
‚îú‚îÄ‚îÄ –ó–∞–¥–∞—á–∞ 7: –ü–µ—Ä–µ–ø—Ä–∞–≤–∞
‚îÇ   ‚îú‚îÄ‚îÄ –ó–∞–≤–∏—Å–∏—Ç –æ—Ç: –ó–∞–¥–∞—á–∞ 1 (–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö ‚Üí –Ø–∫—É—Ç—Å–∫)
‚îÇ   ‚îî‚îÄ‚îÄ –¢—Ä–µ–±—É–µ—Ç: FERRY –≤ TransportType enum
‚îÇ
‚îî‚îÄ‚îÄ –ó–∞–¥–∞—á–∞ 8: –í–∞–ª–∏–¥–∞—Ü–∏—è –≥—Ä–∞—Ñ–∞
    ‚îú‚îÄ‚îÄ –ó–∞–≤–∏—Å–∏—Ç –æ—Ç: –ó–∞–¥–∞—á–∞ 6 (–ø–µ—Ä–µ—Å–∞–¥–∫–∏)
    ‚îú‚îÄ‚îÄ –ó–∞–≤–∏—Å–∏—Ç –æ—Ç: –ó–∞–¥–∞—á–∞ 7 (ferry-—Ä—ë–±—Ä–∞)
    ‚îî‚îÄ‚îÄ –¢—Ä–µ–±—É–µ—Ç: graph-validator.ts
```

### 1.3 –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏, –≤–ª–∏—è—é—â–∏–µ –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø–æ–∏—Å–∫–∞

#### –û—à–∏–±–∫–∞ #1: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
- **–ú–µ—Å—Ç–æ:** `city-normalizer.ts:121-180` ‚Üí `extractCityFromStopName()`
- **–°–∏–º–ø—Ç–æ–º:** "–ê—ç—Ä–æ–ø–æ—Ä—Ç –Ø–∫—É—Ç—Å–∫ (–¢—É–π–º–∞–∞–¥–∞)" ‚Üí `city_id = "–¢—É–π–º–∞–∞–¥–∞"` –≤–º–µ—Å—Ç–æ `"–Ø–∫—É—Ç—Å–∫"`
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏–µ:** –Ø–∫—É—Ç—Å–∫ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø—Ä–∏ –ø–æ–∏—Å–∫–µ, –º–∞—Ä—à—Ä—É—Ç—ã –Ω–µ —Å—Ç—Ä–æ—è—Ç—Å—è
- **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üî¥ –ë–õ–û–ö–ò–†–£–Æ–©–ê–Ø

#### –û—à–∏–±–∫–∞ #2: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ OData
- **–ú–µ—Å—Ç–æ:** `ODataSyncWorker.ts:252-284` ‚Üí `parseODataResponse()`
- **–°–∏–º–ø—Ç–æ–º:** –ú—É—Å–æ—Ä–Ω—ã–µ –≥–æ—Ä–æ–¥–∞, –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏–µ:** –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –≥—Ä–∞—Ñ–µ, –æ—à–∏–±–∫–∏ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ
- **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üî¥ –ë–õ–û–ö–ò–†–£–Æ–©–ê–Ø

#### –û—à–∏–±–∫–∞ #3: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ –≤ reference
- **–ú–µ—Å—Ç–æ:** `VirtualEntitiesGeneratorWorker.ts` ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ `yakutia-cities-reference.json`
- **–°–∏–º–ø—Ç–æ–º:** –ú–∞—Ä—à—Ä—É—Ç—ã –∏–∑ –ú–æ—Å–∫–≤—ã, –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–∞ –∏ –¥—Ä. –Ω–µ —Å—Ç—Ä–æ—è—Ç—Å—è
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏–µ:** –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –Ø–∫—É—Ç–∏–∏
- **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü† –í–´–°–û–ö–ê–Ø

#### –û—à–∏–±–∫–∞ #4: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä—ë–±–µ—Ä –ø–µ—Ä–µ—Å–∞–¥–∫–∏ –≤ –≥—Ä–∞—Ñ–µ
- **–ú–µ—Å—Ç–æ:** `GraphBuilderWorker.ts` ‚Üí `buildGraphStructure()`
- **–°–∏–º–ø—Ç–æ–º:** –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç "–ú–æ—Å–∫–≤–∞ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –ß—É—Ä–∞–ø—á–∞"
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏–µ:** –°–º–µ—à–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç
- **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü° –°–†–ï–î–ù–Ø–Ø

#### –û—à–∏–±–∫–∞ #5: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ ferry-—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
- **–ú–µ—Å—Ç–æ:** `TransportType` enum –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç `FERRY`
- **–°–∏–º–ø—Ç–æ–º:** –ü–µ—Ä–µ–ø—Ä–∞–≤–∞ –Ø–∫—É—Ç—Å–∫ ‚Üî –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏–µ:** –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–ø—Ä–∞–≤—É
- **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü° –°–†–ï–î–ù–Ø–Ø

---

## 2. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —ç—Ç–∞–ø–∞–º–∏

### –ì—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —ç—Ç–∞–ø–æ–≤

```
–≠—Ç–∞–ø 1 (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
    ‚îÇ
    ‚îú‚îÄ‚Üí –°–æ–∑–¥–∞–µ—Ç: airports-reference.json, suburbs-reference.json
    ‚îú‚îÄ‚Üí –°–æ–∑–¥–∞–µ—Ç: stop-validator.ts
    ‚îú‚îÄ‚Üí –û–±–Ω–æ–≤–ª—è–µ—Ç: extractCityFromStopName()
    ‚îî‚îÄ‚Üí –û–±–Ω–æ–≤–ª—è–µ—Ç: ODataSyncWorker (–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è + –≤–∞–ª–∏–¥–∞—Ü–∏—è)
         ‚îÇ
         ‚îî‚îÄ‚Üí [–ë–õ–û–ö–ò–†–£–ï–¢] –≠—Ç–∞–ø 2 (–¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã)

–≠—Ç–∞–ø 2 (–§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞)
    ‚îÇ
    ‚îú‚îÄ‚Üí –ó–∞–≤–∏—Å–∏—Ç –æ—Ç: –≠—Ç–∞–ø 1 (–≤–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ unified-reference)
    ‚îú‚îÄ‚Üí –°–æ–∑–¥–∞–µ—Ç: russia-federal-cities-reference.json
    ‚îú‚îÄ‚Üí –°–æ–∑–¥–∞–µ—Ç: unified-cities-loader.ts
    ‚îú‚îÄ‚Üí –û–±–Ω–æ–≤–ª—è–µ—Ç: VirtualEntitiesGeneratorWorker
    ‚îî‚îÄ‚Üí –°–æ–∑–¥–∞–µ—Ç: AirRouteGeneratorWorker
         ‚îÇ
         ‚îî‚îÄ‚Üí [–ë–õ–û–ö–ò–†–£–ï–¢] –≠—Ç–∞–ø 3 (–Ω—É–∂–Ω—ã —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–æ–≤)

–≠—Ç–∞–ø 3 (–°–º–µ—à–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –∏ –ø–µ—Ä–µ–ø—Ä–∞–≤–∞)
    ‚îÇ
    ‚îú‚îÄ‚Üí –ó–∞–≤–∏—Å–∏—Ç –æ—Ç: –≠—Ç–∞–ø 1 (–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö)
    ‚îú‚îÄ‚Üí –ó–∞–≤–∏—Å–∏—Ç –æ—Ç: –≠—Ç–∞–ø 2 (—Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞)
    ‚îú‚îÄ‚Üí –û–±–Ω–æ–≤–ª—è–µ—Ç: mock-–¥–∞–Ω–Ω—ã–µ (stops.json, routes.json, flights.json)
    ‚îú‚îÄ‚Üí –û–±–Ω–æ–≤–ª—è–µ—Ç: GraphBuilderWorker (–ø–µ—Ä–µ—Å–∞–¥–∫–∏)
    ‚îî‚îÄ‚Üí –û–±–Ω–æ–≤–ª—è–µ—Ç: RouteGraphBuilder (ferry)
         ‚îÇ
         ‚îî‚îÄ‚Üí [–ë–õ–û–ö–ò–†–£–ï–¢] –≠—Ç–∞–ø 4 (–Ω—É–∂–µ–Ω –≥—Ä–∞—Ñ —Å –ø–µ—Ä–µ—Å–∞–¥–∫–∞–º–∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏)

–≠—Ç–∞–ø 4 (–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∞, –≤–∞–ª–∏–¥–∞—Ü–∏—è, –ø–µ—Ä–µ—Å–∞–¥–∫–∏)
    ‚îÇ
    ‚îú‚îÄ‚Üí –ó–∞–≤–∏—Å–∏—Ç –æ—Ç: –≠—Ç–∞–ø 3 (–≥—Ä–∞—Ñ —Å –ø–µ—Ä–µ—Å–∞–¥–∫–∞–º–∏ –∏ ferry)
    ‚îú‚îÄ‚Üí –°–æ–∑–¥–∞–µ—Ç: graph-validator.ts
    ‚îú‚îÄ‚Üí –û–±–Ω–æ–≤–ª—è–µ—Ç: GraphBuilderWorker (–≤–∞–ª–∏–¥–∞—Ü–∏—è)
    ‚îî‚îÄ‚Üí –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —É–ª—É—á—à–µ–Ω–∏–π
```

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—É—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—É—Ç—å –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏:**
1. –≠—Ç–∞–ø 1 ‚Üí –≠—Ç–∞–ø 2 ‚Üí –≠—Ç–∞–ø 3 ‚Üí –≠—Ç–∞–ø 4

**–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ (–º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ):**
- –°–æ–∑–¥–∞–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ (airports, suburbs, federal cities)
- –ù–∞–ø–∏—Å–∞–Ω–∏–µ unit-—Ç–µ—Å—Ç–æ–≤ –¥–ª—è –Ω–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ mock-–¥–∞–Ω–Ω—ã—Ö

---

## 3. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏

### 3.1 –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫

#### –û—à–∏–±–∫–∞ #1: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ "–Ø–∫—É—Ç—Å–∫"

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```typescript
// city-normalizer.ts:134-158
const words = stopName.match(/[–ê-–Ø–∞-—è–Å—ë]+(?:-[–ê-–Ø–∞-—è–Å—ë]+)*/g);
const lastWord = words[words.length - 1].toLowerCase();
// –ü—Ä–æ–±–ª–µ–º–∞: –¥–ª—è "–ê—ç—Ä–æ–ø–æ—Ä—Ç –Ø–∫—É—Ç—Å–∫ (–¢—É–π–º–∞–∞–¥–∞)" –∏–∑–≤–ª–µ–∫–∞–µ—Ç "–¢—É–π–º–∞–∞–¥–∞"
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω "–ê—ç—Ä–æ–ø–æ—Ä—Ç [–ì–æ—Ä–æ–¥] ([–ê—ç—Ä–æ–ø–æ—Ä—Ç])"
2. –ï—Å–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –≤ —Å–∫–æ–±–∫–∞—Ö –Ω–∞–π–¥–µ–Ω–æ –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ –∞—ç—Ä–æ–ø–æ—Ä—Ç–æ–≤ ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ä–æ–¥ –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
3. –ò–Ω–∞—á–µ ‚Üí –∏–∑–≤–ª–µ—á—å –≥–æ—Ä–æ–¥ –∏–∑ —á–∞—Å—Ç–∏ –î–û —Å–∫–æ–±–æ–∫

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/src/shared/utils/city-normalizer.ts` (—Å—Ç—Ä–æ–∫–∏ 121-180)
- –ù–æ–≤—ã–π: `backend/src/shared/utils/airports-loader.ts`
- –ù–æ–≤—ã–π: `backend/data/reference/airports-reference.json`

#### –û—à–∏–±–∫–∞ #2: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ OData

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```typescript
// ODataSyncWorker.ts:258-284
const stops = response.stops.map((stopData: any) => {
  // –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏!
  return new RealStop(...);
});
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞:**
1. –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è (`name`, `latitude`, `longitude`)
2. –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (–¥–∏–∞–ø–∞–∑–æ–Ω, –Ω–µ NaN)
3. –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å `city_id` —á–µ—Ä–µ–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `city_id` –µ—Å—Ç—å –≤ unified-reference
5. –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –∑–∞–ø–∏—Å–∏ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/src/application/workers/ODataSyncWorker.ts` (—Å—Ç—Ä–æ–∫–∏ 252-284)
- –ù–æ–≤—ã–π: `backend/src/shared/validators/stop-validator.ts`

#### –û—à–∏–±–∫–∞ #3: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```typescript
// VirtualEntitiesGeneratorWorker.ts:32
import { getAllYakutiaCities } from '../../shared/utils/yakutia-cities-loader';
// –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ –≥–æ—Ä–æ–¥–∞ –Ø–∫—É—Ç–∏–∏
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞:**
1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `unified-cities-loader.ts` –≤–º–µ—Å—Ç–æ `yakutia-cities-loader.ts`
2. –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–ª—è —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
3. –°–æ–∑–¥–∞–≤–∞—Ç—å hub-based –º–∞—Ä—à—Ä—É—Ç—ã: —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –≥–æ—Ä–æ–¥ –Ø–∫—É—Ç–∏–∏

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/src/application/workers/VirtualEntitiesGeneratorWorker.ts`
- –ù–æ–≤—ã–π: `backend/src/shared/utils/unified-cities-loader.ts`
- –ù–æ–≤—ã–π: `backend/data/reference/russia-federal-cities-reference.json`

#### –û—à–∏–±–∫–∞ #4: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–µ—Ä–µ—Å–∞–¥–æ–∫ –≤ –≥—Ä–∞—Ñ–µ

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```typescript
// GraphBuilderWorker.ts:130-300
// –°–æ–∑–¥–∞–µ—Ç —Ä—ë–±—Ä–∞ —Ç–æ–ª—å–∫–æ –∏–∑ –º–∞—Ä—à—Ä—É—Ç–æ–≤
// –ù–µ—Ç —Ä—ë–±–µ—Ä –ø–µ—Ä–µ—Å–∞–¥–∫–∏ –º–µ–∂–¥—É –æ—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏ –≤ –æ–¥–Ω–æ–º –≥–æ—Ä–æ–¥–µ
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞:**
1. –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ –≥–æ—Ä–æ–¥–∞–º
2. –°–æ–∑–¥–∞–≤–∞—Ç—å —Ä—ë–±—Ä–∞ –ø–µ—Ä–µ—Å–∞–¥–∫–∏ –º–µ–∂–¥—É –æ—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏ –≤ –æ–¥–Ω–æ–º –≥–æ—Ä–æ–¥–µ
3. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å –≤–µ—Å –ø–µ—Ä–µ—Å–∞–¥–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–æ–≤ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/src/application/workers/GraphBuilderWorker.ts` (—Å—Ç—Ä–æ–∫–∏ 130-300)
- `backend/src/application/route-builder/RouteGraphBuilder.ts`

#### –û—à–∏–±–∫–∞ #5: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ FERRY –≤ TransportType

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```typescript
// Route.ts:6
export type TransportType = 'BUS' | 'TRAIN' | 'PLANE' | 'WATER';
// –ù–µ—Ç 'FERRY'
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –í `RouteSegment.ts` –µ—Å—Ç—å enum —Å `FERRY = 'ferry'`, –Ω–æ –≤ `Route.ts` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è union type –±–µ–∑ FERRY.

**–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞:**
1. –î–æ–±–∞–≤–∏—Ç—å `'FERRY'` –≤ `TransportType` –≤ `Route.ts`
2. –ò–ª–∏ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `RouteSegment.TransportType` enum

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/src/domain/entities/Route.ts` (—Å—Ç—Ä–æ–∫–∞ 6)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–∞—Ö

---

## 4. –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω —Ä–∞–±–æ—Ç (Milestones)

### Milestone 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–≠—Ç–∞–ø 1)

**–¶–µ–ª—å:** –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö, —É—Å—Ç—Ä–∞–Ω–∏—Ç—å –±–ª–æ–∫–∏—Ä—É—é—â–∏–µ –æ—à–∏–±–∫–∏

**–í—Ä–µ–º—è:** 2-3 –¥–Ω—è

**–ó–∞–¥–∞—á–∏:**

#### M1.1: –°–æ–∑–¥–∞–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ –∞—ç—Ä–æ–ø–æ—Ä—Ç–æ–≤ –∏ –ø—Ä–∏–≥–æ—Ä–æ–¥–æ–≤
- [ ] –°–æ–∑–¥–∞—Ç—å `backend/data/reference/airports-reference.json`
  - –í–∫–ª—é—á–∏—Ç—å: –¢—É–π–º–∞–∞–¥–∞, –®–µ—Ä–µ–º–µ—Ç—å–µ–≤–æ, –î–æ–º–æ–¥–µ–¥–æ–≤–æ, –í–Ω—É–∫–æ–≤–æ, –ü—É–ª–∫–æ–≤–æ, –¢–æ–ª–º–∞—á—ë–≤–æ, –ï–º–µ–ª—å—è–Ω–æ–≤–æ, –ö–æ–ª—å—Ü–æ–≤–æ
  - –°—Ç—Ä—É–∫—Ç—É—Ä–∞: `{ name, city, aliases, normalizedName }`
- [ ] –°–æ–∑–¥–∞—Ç—å `backend/data/reference/suburbs-reference.json`
  - –í–∫–ª—é—á–∏—Ç—å: –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö ‚Üí –Ø–∫—É—Ç—Å–∫, –ë–µ—Ä–∫–∞–∫–∏—Ç ‚Üí –ù–µ—Ä—é–Ω–≥—Ä–∏
  - –°—Ç—Ä—É–∫—Ç—É—Ä–∞: `{ name, mainCity, type, normalizedName }`
- [ ] –°–æ–∑–¥–∞—Ç—å `backend/src/shared/utils/airports-loader.ts`
  - –§—É–Ω–∫—Ü–∏–∏: `loadAirportsReference()`, `getCityByAirportName()`
- [ ] –°–æ–∑–¥–∞—Ç—å `backend/src/shared/utils/suburbs-loader.ts`
  - –§—É–Ω–∫—Ü–∏–∏: `loadSuburbsReference()`, `getMainCityBySuburb()`
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è –∑–∞–≥—Ä—É–∑—á–∏–∫–æ–≤

#### M1.2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ `extractCityFromStopName()`
- [ ] –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å `getCityByAirportName` –≤ `city-normalizer.ts`
- [ ] –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–∞—Ç—Ç–µ—Ä–Ω–∞ "–ê—ç—Ä–æ–ø–æ—Ä—Ç [–ì–æ—Ä–æ–¥] ([–ê—ç—Ä–æ–ø–æ—Ä—Ç])"
  - –ü—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –≤ —Å–∫–æ–±–∫–∞—Ö —á–µ—Ä–µ–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∞—ç—Ä–æ–ø–æ—Ä—Ç–æ–≤
  - –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ä–æ–¥ –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
- [ ] –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–∞—Ç—Ç–µ—Ä–Ω–∞ "–ê—ç—Ä–æ–ø–æ—Ä—Ç [–ì–æ—Ä–æ–¥]" (–±–µ–∑ —Å–∫–æ–±–æ–∫)
  - –ò–∑–≤–ª–µ–∫–∞—Ç—å –≥–æ—Ä–æ–¥ –∏–∑ —á–∞—Å—Ç–∏ –î–û —Å–ª–æ–≤–∞ "–ê—ç—Ä–æ–ø–æ—Ä—Ç"
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –ª–æ–≥–∏–∫—É –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è –Ω–æ–≤—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
  - "–ê—ç—Ä–æ–ø–æ—Ä—Ç –Ø–∫—É—Ç—Å–∫ (–¢—É–π–º–∞–∞–¥–∞)" ‚Üí "–Ø–∫—É—Ç—Å–∫"
  - "–ê—ç—Ä–æ–ø–æ—Ä—Ç –ú–æ—Å–∫–≤–∞ –®–µ—Ä–µ–º–µ—Ç—å–µ–≤–æ" ‚Üí "–ú–æ—Å–∫–≤–∞"
  - "–ê–≤—Ç–æ—Å—Ç–∞–Ω—Ü–∏—è –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –Ø–∫—É—Ç—Å–∫" ‚Üí "–Ø–∫—É—Ç—Å–∫"

#### M1.3: –°–æ–∑–¥–∞–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–∞ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫
- [ ] –°–æ–∑–¥–∞—Ç—å `backend/src/shared/validators/stop-validator.ts`
  - –§—É–Ω–∫—Ü–∏—è: `validateStopData(stopData): ValidationResult`
  - –ü—Ä–æ–≤–µ—Ä–∫–∏:
    - `name` –Ω–µ –ø—É—Å—Ç–æ–π, –¥–ª–∏–Ω–∞ >= 3 —Å–∏–º–≤–æ–ª–æ–≤
    - `latitude` –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [-90, 90], –Ω–µ NaN
    - `longitude` –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [-180, 180], –Ω–µ NaN
    - `cityId` –Ω–µ —Å–ª—É–∂–µ–±–Ω–æ–µ —Å–ª–æ–≤–æ (—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è, –≥–ª–∞–≤–Ω—ã–π, —Ç—É–π–º–∞–∞–¥–∞ –∏ —Ç.–¥.)
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–∞

#### M1.4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `ODataSyncWorker`
- [ ] –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å `getCityByAirportName`, `getMainCityBySuburb`, `validateStopData`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `parseODataResponse()`:
  - –ü–æ—Å–ª–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è `city_id` —á–µ—Ä–µ–∑ `extractCityFromStopName()`:
    1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ `suburbs-reference` ‚Üí –µ—Å–ª–∏ –ø—Ä–∏–≥–æ—Ä–æ–¥, –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `mainCity`
    2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ `airports-reference` ‚Üí –µ—Å–ª–∏ –∞—ç—Ä–æ–ø–æ—Ä—Ç, –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –≥–æ—Ä–æ–¥
    3. –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ `validateStopData()`
    4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `city_id` –µ—Å—Ç—å –≤ unified-reference (–ø–æ–∫–∞ —Ç–æ–ª—å–∫–æ yakutia, –ø–æ—Ç–æ–º –¥–æ–±–∞–≤–∏–º federal)
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∞–ª–∏–¥–Ω—ã—Ö/–Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –æ—Å—Ç–∞–Ω–æ–≤–æ–∫
  - –°–ø–∏—Å–æ–∫ –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞ Milestone 1:**
- ‚úÖ "–ê—ç—Ä–æ–ø–æ—Ä—Ç –Ø–∫—É—Ç—Å–∫ (–¢—É–π–º–∞–∞–¥–∞)" ‚Üí `city_id = "–Ø–∫—É—Ç—Å–∫"`
- ‚úÖ "–ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö" ‚Üí `city_id = "–Ø–∫—É—Ç—Å–∫"`
- ‚úÖ "–¢—É–π–º–∞–∞–¥–∞" –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥
- ‚úÖ –ú—É—Å–æ—Ä–Ω—ã–µ –∑–∞–ø–∏—Å–∏ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –í—Å–µ unit-—Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç

---

### Milestone 2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ (–≠—Ç–∞–ø 2)

**–¶–µ–ª—å:** –î–æ–±–∞–≤–∏—Ç—å 10 —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤, –æ–±–µ—Å–ø–µ—á–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã –†–æ—Å—Å–∏—è ‚Üí –Ø–∫—É—Ç–∏—è

**–í—Ä–µ–º—è:** 3-4 –¥–Ω—è

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** Milestone 1 (–≤–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ unified-reference)

**–ó–∞–¥–∞—á–∏:**

#### M2.1: –°–æ–∑–¥–∞–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
- [ ] –°–æ–∑–¥–∞—Ç—å `backend/data/reference/russia-federal-cities-reference.json`
  - –í–∫–ª—é—á–∏—Ç—å 10 –≥–æ—Ä–æ–¥–æ–≤: –ú–æ—Å–∫–≤–∞, –°–ü–±, –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫, –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫, –ò—Ä–∫—É—Ç—Å–∫, –•–∞–±–∞—Ä–æ–≤—Å–∫, –í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫, –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥, –ö–∞–∑–∞–Ω—å, –ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥
  - –î–ª—è –∫–∞–∂–¥–æ–≥–æ: –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, —Ä–µ–≥–∏–æ–Ω, –∞—ç—Ä–æ–ø–æ—Ä—Ç—ã, `isKeyCity: true`, `isFederalCity: true`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç

#### M2.2: –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–æ–≥–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
- [ ] –°–æ–∑–¥–∞—Ç—å `backend/src/shared/utils/unified-cities-loader.ts`
  - –§—É–Ω–∫—Ü–∏—è: `loadUnifiedCitiesReference(): Map<string, UnifiedCity>`
    - –ó–∞–≥—Ä—É–∂–∞–µ—Ç `yakutia-cities-reference.json` + `russia-federal-cities-reference.json`
    - –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤ –µ–¥–∏–Ω—ã–π Map —Å –∫–ª—é—á–æ–º `normalizedName`
  - –§—É–Ω–∫—Ü–∏—è: `getUnifiedCity(cityName): UnifiedCity | undefined`
  - –§—É–Ω–∫—Ü–∏—è: `isCityInUnifiedReference(cityName): boolean`
  - –§—É–Ω–∫—Ü–∏—è: `getAllFederalCities(): UnifiedCity[]`
  - –§—É–Ω–∫—Ü–∏—è: `getAllYakutiaCities(): UnifiedCity[]`
- [ ] –¢–∏–ø: `UnifiedCity { name, normalizedName, latitude, longitude, region, isKeyCity, isFederalCity, airports? }`
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã

#### M2.3: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `ODataSyncWorker` –¥–ª—è unified-reference
- [ ] –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å `isCityInUnifiedReference` –∏–∑ `unified-cities-loader.ts`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤ `parseODataResponse()`:
  - –ü—Ä–æ–≤–µ—Ä—è—Ç—å `city_id` —á–µ—Ä–µ–∑ `isCityInUnifiedReference()` (–≤–º–µ—Å—Ç–æ —Ç–æ–ª—å–∫–æ yakutia)
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã

#### M2.4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `VirtualEntitiesGeneratorWorker`
- [ ] –ó–∞–º–µ–Ω–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã:
  - –£–¥–∞–ª–∏—Ç—å: `yakutia-cities-loader.ts`
  - –î–æ–±–∞–≤–∏—Ç—å: `unified-cities-loader.ts`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä:
  - –£–¥–∞–ª–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä `citiesDirectory: CityCoordinates`
  - –ó–∞–≥—Ä—É–∂–∞—Ç—å –≥–æ—Ä–æ–¥–∞ —á–µ—Ä–µ–∑ `getAllYakutiaCities()` + `getAllFederalCities()`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `generateVirtualStops()`:
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `getAllFederalCities()` + `getAllYakutiaCities()`
  - –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏:
    - –ì–æ—Ä–æ–¥ –µ—Å—Ç—å –≤ unified-reference
    - –ù–µ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ –≤ –ë–î –¥–ª—è —ç—Ç–æ–≥–æ –≥–æ—Ä–æ–¥–∞
    - `isKeyCity: true`
- [ ] –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å `ensureYakutiaCitiesConnectivity()` ‚Üí `ensureCitiesConnectivity()`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `ensureCitiesConnectivity()`:
  - –î–ª—è –ø–∞—Ä **—Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥ ‚Üí –≥–æ—Ä–æ–¥ –Ø–∫—É—Ç–∏–∏**: —Å–æ–∑–¥–∞–≤–∞—Ç—å hub-based –º–∞—Ä—à—Ä—É—Ç—ã —á–µ—Ä–µ–∑ –Ø–∫—É—Ç—Å–∫
    - –ú–∞—Ä—à—Ä—É—Ç 1: —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥ ‚Üí –Ø–∫—É—Ç—Å–∫ (PLANE, 240 –º–∏–Ω, 2000 –∫–º)
    - –ú–∞—Ä—à—Ä—É—Ç 2: –Ø–∫—É—Ç—Å–∫ ‚Üí –≥–æ—Ä–æ–¥ –Ø–∫—É—Ç–∏–∏ (BUS, 180 –º–∏–Ω, 200 –∫–º)
  - –î–ª—è –ø–∞—Ä **—Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥ ‚Üí —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥**: —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø—Ä—è–º—ã–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã (PLANE, 180 –º–∏–Ω, 1500 –∫–º)
  - –î–ª—è –ø–∞—Ä **–≥–æ—Ä–æ–¥ –Ø–∫—É—Ç–∏–∏ ‚Üí –≥–æ—Ä–æ–¥ –Ø–∫—É—Ç–∏–∏**: –æ—Å—Ç–∞–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –ª–æ–≥–∏–∫—É
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `initializeWorkers.ts`:
  - –£–¥–∞–ª–∏—Ç—å –ø–µ—Ä–µ–¥–∞—á—É `yakutiaCitiesDirectory` –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä `VirtualEntitiesGeneratorWorker`
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã

#### M2.5: –°–æ–∑–¥–∞–Ω–∏–µ `AirRouteGeneratorWorker`
- [ ] –°–æ–∑–¥–∞—Ç—å `backend/src/application/workers/AirRouteGeneratorWorker.ts`
  - –ö–ª–∞—Å—Å: `AirRouteGeneratorWorker extends BaseBackgroundWorker`
  - –ú–µ—Ç–æ–¥: `canRun()` ‚Üí –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ dataset
  - –ú–µ—Ç–æ–¥: `executeWorkerLogic()`:
    1. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ –∏–∑ unified-reference
    2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞:
       - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∞–≤–∏–∞–º–∞—Ä—à—Ä—É—Ç–∞ –≤ –ë–î (–Ø–∫—É—Ç—Å–∫ ‚Üî —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥)
       - –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí —Å–æ–∑–¥–∞–µ—Ç –º–∞—Ä—à—Ä—É—Ç:
         - –ü—Ä—è–º–æ–π: —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥ ‚Üí –Ø–∫—É—Ç—Å–∫ (PLANE, 240 –º–∏–Ω, 2000 –∫–º)
         - –û–±—Ä–∞—Ç–Ω—ã–π: –Ø–∫—É—Ç—Å–∫ ‚Üí —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥ (PLANE, 240 –º–∏–Ω, 2000 –∫–º)
       - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–µ–π—Å—ã –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–æ–≤ (–µ–∂–µ–¥–Ω–µ–≤–Ω–æ, 2-3 —Ä–µ–π—Å–∞: 08:00, 14:00, 20:00)
    3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –º–∞—Ä—à—Ä—É—Ç—ã –∏ —Ä–µ–π—Å—ã –≤ –ë–î
- [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ –ø–∞–π–ø–ª–∞–π–Ω –≤–æ—Ä–∫–µ—Ä–æ–≤ (`initializeWorkers.ts`):
  - –ü–æ—Ä—è–¥–æ–∫: ODataSyncWorker ‚Üí **AirRouteGeneratorWorker** ‚Üí VirtualEntitiesGeneratorWorker ‚Üí GraphBuilderWorker
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞ Milestone 2:**
- ‚úÖ 10 —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Å–∏—Å—Ç–µ–º–µ
- ‚úÖ –ú–∞—Ä—à—Ä—É—Ç—ã –∏–∑ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ –≤ –Ø–∫—É—Ç–∏—é —Å—Ç—Ä–æ—è—Ç—Å—è (—á–µ—Ä–µ–∑ –Ø–∫—É—Ç—Å–∫)
- ‚úÖ –ú–∞—Ä—à—Ä—É—Ç—ã –º–µ–∂–¥—É —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–º–∏ –≥–æ—Ä–æ–¥–∞–º–∏ —Å—Ç—Ä–æ—è—Ç—Å—è (–ø—Ä—è–º—ã–µ)
- ‚úÖ –í—Å–µ unit-—Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç

---

### Milestone 3: –°–º–µ—à–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –∏ –ø–µ—Ä–µ–ø—Ä–∞–≤–∞ (–≠—Ç–∞–ø 3)

**–¶–µ–ª—å:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–º–µ—à–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã (air + ground + ferry), –ø–µ—Ä–µ–ø—Ä–∞–≤—É –Ø–∫—É—Ç—Å–∫ ‚Üî –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö

**–í—Ä–µ–º—è:** 4-5 –¥–Ω–µ–π

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** Milestone 1 (–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö), Milestone 2 (—Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞)

**–ó–∞–¥–∞—á–∏:**

#### M3.1: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ mock-–¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `backend/data/mock/stops.json`:
  - –î–æ–±–∞–≤–∏—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–ª—è —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤:
    - `stop-030`: "–ê—ç—Ä–æ–ø–æ—Ä—Ç –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫ –¢–æ–ª–º–∞—á—ë–≤–æ" (55.0084, 82.9357)
    - `stop-031`: "–ê—ç—Ä–æ–ø–æ—Ä—Ç –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫ –ï–º–µ–ª—å—è–Ω–æ–≤–æ" (56.0089, 92.8537)
    - `stop-032`: "–ê—ç—Ä–æ–ø–æ—Ä—Ç –•–∞–±–∞—Ä–æ–≤—Å–∫" (48.4802, 135.0719)
    - `stop-033`: "–ê—ç—Ä–æ–ø–æ—Ä—Ç –í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫" (43.1155, 131.8855)
    - `stop-034`: "–ê—ç—Ä–æ–ø–æ—Ä—Ç –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥ –ö–æ–ª—å—Ü–æ–≤–æ" (56.8431, 60.6454)
    - `stop-035`: "–ê—ç—Ä–æ–ø–æ—Ä—Ç –ö–∞–∑–∞–Ω—å" (55.8304, 49.0661)
    - `stop-036`: "–ê—ç—Ä–æ–ø–æ—Ä—Ç –ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥ –°—Ç—Ä–∏–≥–∏–Ω–æ" (56.2965, 43.9361)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `backend/data/mock/routes.json`:
  - –î–æ–±–∞–≤–∏—Ç—å –∞–≤–∏–∞–º–∞—Ä—à—Ä—É—Ç—ã –∏–∑ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ –≤ –Ø–∫—É—Ç—Å–∫:
    - `route-030`: "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫ - –Ø–∫—É—Ç—Å–∫ (–ê–≤–∏–∞)" (stop-030 ‚Üí stop-001, PLANE, 240 –º–∏–Ω, 2800 –∫–º, 15000 —Ä—É–±)
    - `route-031`: "–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫ - –Ø–∫—É—Ç—Å–∫ (–ê–≤–∏–∞)" (stop-031 ‚Üí stop-001, PLANE, 180 –º–∏–Ω, 2200 –∫–º, 12000 —Ä—É–±)
    - `route-032`: "–•–∞–±–∞—Ä–æ–≤—Å–∫ - –Ø–∫—É—Ç—Å–∫ (–ê–≤–∏–∞)" (stop-032 ‚Üí stop-001, PLANE, 300 –º–∏–Ω, 3200 –∫–º, 18000 —Ä—É–±)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `backend/data/mock/flights.json`:
  - –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–π—Å—ã –¥–ª—è –Ω–æ–≤—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ (–µ–∂–µ–¥–Ω–µ–≤–Ω–æ, 2-3 —Ä–µ–π—Å–∞ –≤ –¥–µ–Ω—å)

#### M3.2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ –∏ –º–∞—Ä—à—Ä—É—Ç–æ–≤ –¥–ª—è –ø–µ—Ä–µ–ø—Ä–∞–≤—ã
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `backend/data/mock/stops.json`:
  - –î–æ–±–∞–≤–∏—Ç—å:
    - `stop-027`: "–ü–∞—Ä–æ–º–Ω–∞—è –ø–µ—Ä–µ–ø—Ä–∞–≤–∞ –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö" (61.9500, 129.6000, ferry_terminal, cityId: "—è–∫—É—Ç—Å–∫")
    - `stop-028`: "–ü—Ä–∏—Å—Ç–∞–Ω—å –Ø–∫—É—Ç—Å–∫" (62.0278, 129.7042, ferry_terminal, cityId: "—è–∫—É—Ç—Å–∫")
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `backend/data/mock/routes.json`:
  - –î–æ–±–∞–≤–∏—Ç—å ferry-–º–∞—Ä—à—Ä—É—Ç—ã:
    - `route-040`: "–Ø–∫—É—Ç—Å–∫ - –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö (–ü–∞—Ä–æ–º)" (stop-028 ‚Üí stop-027, FERRY, 20 –º–∏–Ω, 15 –∫–º, 500 —Ä—É–±)
    - `route-041`: "–ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö - –Ø–∫—É—Ç—Å–∫ (–ü–∞—Ä–æ–º)" (stop-027 ‚Üí stop-028, FERRY, 20 –º–∏–Ω, 15 –∫–º, 500 —Ä—É–±)
  - –î–æ–±–∞–≤–∏—Ç—å `metadata.ferrySchedule`:
    - `summer: { start: "06:00", end: "23:00", frequency: 30 }`
    - `winter: { start: "07:00", end: "22:00", frequency: 45 }`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `backend/data/mock/flights.json`:
  - –î–æ–±–∞–≤–∏—Ç—å "—Ä–µ–π—Å—ã" –¥–ª—è ferry-–º–∞—Ä—à—Ä—É—Ç–æ–≤ (–∫–∞–∂–¥—ã–µ 30-45 –º–∏–Ω—É—Ç –≤ —Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è)

#### M3.3: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ FERRY –≤ TransportType
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `backend/src/domain/entities/Route.ts`:
  - –ò–∑–º–µ–Ω–∏—Ç—å: `export type TransportType = 'BUS' | 'TRAIN' | 'PLANE' | 'WATER' | 'FERRY';`
  - –û–±–Ω–æ–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é: –¥–æ–±–∞–≤–∏—Ç—å `'FERRY'` –≤ `validTransportTypes`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `TransportType` –≤ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–∞—Ö
- [ ] –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (–µ—Å–ª–∏ –µ—Å—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç —Å `RouteSegment.TransportType` enum)

#### M3.4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `GraphBuilderWorker` –¥–ª—è –ø–µ—Ä–µ—Å–∞–¥–æ–∫
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `buildGraphStructure()`:
  - –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ä—ë–±–µ—Ä –∏–∑ –º–∞—Ä—à—Ä—É—Ç–æ–≤:
    1. –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ –≥–æ—Ä–æ–¥–∞–º (–ø–æ `cityId`)
    2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–æ—Ä–æ–¥–∞ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ä—ë–±—Ä–∞ –ø–µ—Ä–µ—Å–∞–¥–∫–∏ –º–µ–∂–¥—É –æ—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏:
       - –ï—Å–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ –æ–¥–Ω–æ–º –≥–æ—Ä–æ–¥–µ ‚Üí —Å–æ–∑–¥–∞—Ç—å –¥–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ä—ë–±—Ä–∞ –ø–µ—Ä–µ—Å–∞–¥–∫–∏
       - –¢–∏–ø —Ä–µ–±—Ä–∞: `TRANSFER`
       - –í–µ—Å: —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å —á–µ—Ä–µ–∑ `calculateTransferWeight(stop1, stop2)`
- [ ] –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `calculateTransferWeight()`:
  - –õ–æ–≥–∏–∫–∞:
    - Air ‚Üí Ground: 90 –º–∏–Ω—É—Ç
    - Ground ‚Üí Air: 120 –º–∏–Ω—É—Ç
    - Ground ‚Üí Ground: 60 –º–∏–Ω—É—Ç
    - Air ‚Üí Ferry: 90 –º–∏–Ω—É—Ç
    - Ferry ‚Üí Ground: 30 –º–∏–Ω—É—Ç
    - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: 60 –º–∏–Ω—É—Ç
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Ä–∞—Å—á–µ—Ç –≤–µ—Å–∞ –¥–ª—è ferry-–º–∞—Ä—à—Ä—É—Ç–æ–≤:
  - –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–ø—Ä–∞–≤—ã: 20 –º–∏–Ω—É—Ç
  - –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –ø–∞—Ä–æ–º–∞:
    - –õ–µ—Ç–æ–º: 15-20 –º–∏–Ω—É—Ç (—á–∞—Å—Ç–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ)
    - –ó–∏–º–æ–π: 30-45 –º–∏–Ω—É—Ç (—Ä–µ–¥–∫–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ)
  - –ò—Ç–æ–≥–æ–≤—ã–π –≤–µ—Å: 20 + –æ–∂–∏–¥–∞–Ω–∏–µ (35-65 –º–∏–Ω—É—Ç)
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `metadata.ferrySchedule` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–µ–∑–æ–Ω–∞
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã

#### M3.5: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `RouteGraphBuilder` –¥–ª—è ferry
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `buildFromDataset()`:
  - –ü—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å —Ç–∏–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞:
    - –ï—Å–ª–∏ `transportType === 'FERRY'` ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `TransportType.FERRY`
  - –°–æ–∑–¥–∞–≤–∞—Ç—å —Ä—ë–±—Ä–∞ –¥–ª—è ferry-–º–∞—Ä—à—Ä—É—Ç–æ–≤ —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º –≤–µ—Å–æ–º:
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `duration` –∏–∑ –º–∞—Ä—à—Ä—É—Ç–∞ (20 –º–∏–Ω—É—Ç)
    - –î–æ–±–∞–≤–ª—è—Ç—å –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∏–∑ `metadata.ferrySchedule`
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞ Milestone 3:**
- ‚úÖ –°–º–µ—à–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã (air + ground + ferry) —Å—Ç—Ä–æ—è—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ü–µ—Ä–µ–ø—Ä–∞–≤–∞ –Ø–∫—É—Ç—Å–∫ ‚Üî –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ ferry-—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç
- ‚úÖ –ü–µ—Ä–µ—Å–∞–¥–∫–∏ –º–µ–∂–¥—É —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞–º–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –≤–µ—Å–∞–º–∏
- ‚úÖ –í—Å–µ unit-—Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç

---

### Milestone 4: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∞, –≤–∞–ª–∏–¥–∞—Ü–∏—è, –ø–µ—Ä–µ—Å–∞–¥–∫–∏ (–≠—Ç–∞–ø 4)

**–¶–µ–ª—å:** –í–∞–ª–∏–¥–∞—Ü–∏—è –≥—Ä–∞—Ñ–∞, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ—Å–∞–¥–æ–∫, —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

**–í—Ä–µ–º—è:** 3-4 –¥–Ω—è

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** Milestone 3 (–≥—Ä–∞—Ñ —Å –ø–µ—Ä–µ—Å–∞–¥–∫–∞–º–∏ –∏ ferry)

**–ó–∞–¥–∞—á–∏:**

#### M4.1: –°–æ–∑–¥–∞–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–∞ –≥—Ä–∞—Ñ–∞
- [ ] –°–æ–∑–¥–∞—Ç—å `backend/src/shared/validators/graph-validator.ts`
  - –§—É–Ω–∫—Ü–∏—è: `validateGraphStructure(nodes, edges): GraphValidationResult`
    - –ü—Ä–æ–≤–µ—Ä–∫–∞: –≤—Å–µ —Ä—ë–±—Ä–∞ –∏–º–µ—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤–µ—Å (> 0, –Ω–µ NaN, –Ω–µ Infinity)
    - –ü—Ä–æ–≤–µ—Ä–∫–∞: –≤—Å–µ —É–∑–ª—ã –∏–º–µ—é—Ç —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ –≤—Ö–æ–¥—è—â–µ–µ –∏–ª–∏ –∏—Å—Ö–æ–¥—è—â–µ–µ —Ä–µ–±—Ä–æ
    - –ü—Ä–æ–≤–µ—Ä–∫–∞: —Å–≤—è–∑–Ω–æ—Å—Ç—å –≥—Ä–∞—Ñ–∞ (BFS –æ—Ç hub-—É–∑–ª–∞ "–Ø–∫—É—Ç—Å–∫")
    - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–∑–ª–æ–≤, —Ä—ë–±–µ—Ä, –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —É–∑–ª–æ–≤, –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–≤—è–∑–Ω–æ—Å—Ç–∏
  - –§—É–Ω–∫—Ü–∏—è: `validateTransferEdges(edges): ValidationResult`
    - –ü—Ä–æ–≤–µ—Ä–∫–∞: —Ä—ë–±—Ä–∞ –ø–µ—Ä–µ—Å–∞–¥–∫–∏ —Å–æ–∑–¥–∞–Ω—ã —Ç–æ–ª—å–∫–æ –º–µ–∂–¥—É –æ—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏ –≤ –æ–¥–Ω–æ–º –≥–æ—Ä–æ–¥–µ
    - –ü—Ä–æ–≤–µ—Ä–∫–∞: –≤–µ—Å —Ä—ë–±–µ—Ä –ø–µ—Ä–µ—Å–∞–¥–∫–∏ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 30-120 –º–∏–Ω—É—Ç
  - –§—É–Ω–∫—Ü–∏—è: `validateFerryEdges(edges): ValidationResult`
    - –ü—Ä–æ–≤–µ—Ä–∫–∞: ferry-—Ä—ë–±—Ä–∞ –∏–º–µ—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤–µ—Å (20-65 –º–∏–Ω—É—Ç)
    - –ü—Ä–æ–≤–µ—Ä–∫–∞: ferry-—Ä—ë–±—Ä–∞ —Å–≤—è–∑—ã–≤–∞—é—Ç —Ç–æ–ª—å–∫–æ ferry_terminal –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã

#### M4.2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ `GraphBuilderWorker`
- [ ] –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã –∏–∑ `graph-validator.ts`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `executeWorkerLogic()`:
  - –ü–æ—Å–ª–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∞ –≤—ã–∑–≤–∞—Ç—å `validateGraphStructure()`
  - –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ä—ë–±–µ—Ä –ø–µ—Ä–µ—Å–∞–¥–∫–∏ –≤—ã–∑–≤–∞—Ç—å `validateTransferEdges()`
  - –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è ferry-—Ä—ë–±–µ—Ä –≤—ã–∑–≤–∞—Ç—å `validateFerryEdges()`
  - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
  - –î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã

#### M4.3: –û—Ç–ª–∞–¥–∫–∞ –≥—Ä–∞—Ñ–∞ –¥–ª—è —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `GraphBuilderWorker`:
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–∑–ª–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä—ë–±–µ—Ä, —Å–≤—è–∑—ã–≤–∞—é—â–∏—Ö —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ —Å –Ø–∫—É—Ç–∏–µ–π
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–Ω–æ—Å—Ç–∏ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ —Å hub-—É–∑–ª–æ–º (–Ø–∫—É—Ç—Å–∫)
- [ ] –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:
  - –í—Ä–µ–º—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∞
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–∑–ª–æ–≤/—Ä—ë–±–µ—Ä –ø–æ —Ç–∏–ø–∞–º —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä—ë–±–µ—Ä –ø–µ—Ä–µ—Å–∞–¥–∫–∏

#### M4.4: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –º–∞—Ä—à—Ä—É—Ç—ã –∏–∑ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞:
  - –ú–æ—Å–∫–≤–∞ ‚Üí –Ø–∫—É—Ç—Å–∫
  - –ú–æ—Å–∫–≤–∞ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –ß—É—Ä–∞–ø—á–∞
  - –ú–æ—Å–∫–≤–∞ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö
  - –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –û–ª—ë–∫–º–∏–Ω—Å–∫
  - –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –ú–∏—Ä–Ω—ã–π
- [ ] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
  - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Ä–µ–º—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∞
  - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Ä–µ–º—è –ø–æ–∏—Å–∫–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤
  - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞ Milestone 4:**
- ‚úÖ –ì—Ä–∞—Ñ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —É–∑–ª–æ–≤ –∏ –≤–µ—Å–æ–≤
- ‚úÖ –û–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç—Å—è –∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –ø—Ä–æ–±–ª–µ–º—ã —Å–≤—è–∑–Ω–æ—Å—Ç–∏
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —É—Å—Ç–æ–π—á–∏–≤–∞ –∫ –æ—à–∏–±–∫–∞–º
- ‚úÖ –í—Å–µ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã —Å—Ç—Ä–æ—è—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## 5. –ù–∞–±–æ—Ä –∑–∞–¥–∞—á –¥–ª—è Cursor

### 5.1 –§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è (9 —Ñ–∞–π–ª–æ–≤)

| ‚Ññ | –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|---|------|------------|-----------|
| 1 | `backend/data/reference/airports-reference.json` | –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∞—ç—Ä–æ–ø–æ—Ä—Ç–æ–≤ –∏ –∏—Ö –≥–æ—Ä–æ–¥–æ–≤ | üî¥ –ö–†–ò–¢–ò–ß–ù–û |
| 2 | `backend/data/reference/suburbs-reference.json` | –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø—Ä–∏–≥–æ—Ä–æ–¥–æ–≤ –∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ | üî¥ –ö–†–ò–¢–ò–ß–ù–û |
| 3 | `backend/data/reference/russia-federal-cities-reference.json` | –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ | üü† –í–´–°–û–ö–ò–ô |
| 4 | `backend/src/shared/utils/airports-loader.ts` | –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –∞—ç—Ä–æ–ø–æ—Ä—Ç–æ–≤ | üî¥ –ö–†–ò–¢–ò–ß–ù–û |
| 5 | `backend/src/shared/utils/suburbs-loader.ts` | –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –ø—Ä–∏–≥–æ—Ä–æ–¥–æ–≤ | üî¥ –ö–†–ò–¢–ò–ß–ù–û |
| 6 | `backend/src/shared/utils/unified-cities-loader.ts` | –ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–æ–≥–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ | üü† –í–´–°–û–ö–ò–ô |
| 7 | `backend/src/shared/validators/stop-validator.ts` | –í–∞–ª–∏–¥–∞—Ü–∏—è –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ | üî¥ –ö–†–ò–¢–ò–ß–ù–û |
| 8 | `backend/src/shared/validators/graph-validator.ts` | –í–∞–ª–∏–¥–∞—Ü–∏—è –≥—Ä–∞—Ñ–∞ | üü° –°–†–ï–î–ù–ò–ô |
| 9 | `backend/src/application/workers/AirRouteGeneratorWorker.ts` | –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∞–≤–∏–∞–º–∞—Ä—à—Ä—É—Ç–æ–≤ | üü† –í–´–°–û–ö–ò–ô |

### 5.2 –§–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (10 —Ñ–∞–π–ª–æ–≤)

| ‚Ññ | –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏—è | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|---|------|-----------|-----------|
| 1 | `backend/src/shared/utils/city-normalizer.ts` | –ò—Å–ø—Ä–∞–≤–∏—Ç—å `extractCityFromStopName()` –¥–ª—è –∞—ç—Ä–æ–ø–æ—Ä—Ç–æ–≤ | üî¥ –ö–†–ò–¢–ò–ß–ù–û |
| 2 | `backend/src/application/workers/ODataSyncWorker.ts` | –î–æ–±–∞–≤–∏—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤ `parseODataResponse()` | üî¥ –ö–†–ò–¢–ò–ß–ù–û |
| 3 | `backend/src/application/workers/VirtualEntitiesGeneratorWorker.ts` | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å unified-cities-loader, –æ–±–Ω–æ–≤–∏—Ç—å `ensureCitiesConnectivity()` | üü† –í–´–°–û–ö–ò–ô |
| 4 | `backend/src/application/workers/GraphBuilderWorker.ts` | –î–æ–±–∞–≤–∏—Ç—å —Ä—ë–±—Ä–∞ –ø–µ—Ä–µ—Å–∞–¥–∫–∏, –≤–∞–ª–∏–¥–∞—Ü–∏—é –≥—Ä–∞—Ñ–∞ | üü° –°–†–ï–î–ù–ò–ô |
| 5 | `backend/src/application/route-builder/RouteGraphBuilder.ts` | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ ferry-–º–∞—Ä—à—Ä—É—Ç–æ–≤, –ø–µ—Ä–µ—Å–∞–¥–æ–∫ | üü° –°–†–ï–î–ù–ò–ô |
| 6 | `backend/src/domain/entities/Route.ts` | –î–æ–±–∞–≤–∏—Ç—å `'FERRY'` –≤ `TransportType` | üü° –°–†–ï–î–ù–ò–ô |
| 7 | `backend/data/mock/stops.json` | –î–æ–±–∞–≤–∏—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–ª—è –ø–µ—Ä–µ–ø—Ä–∞–≤—ã –∏ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ | üü† –í–´–°–û–ö–ò–ô |
| 8 | `backend/data/mock/routes.json` | –î–æ–±–∞–≤–∏—Ç—å ferry-–º–∞—Ä—à—Ä—É—Ç—ã –∏ –∞–≤–∏–∞–º–∞—Ä—à—Ä—É—Ç—ã –∏–∑ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ | üü† –í–´–°–û–ö–ò–ô |
| 9 | `backend/data/mock/flights.json` | –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–π—Å—ã –¥–ª—è –Ω–æ–≤—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ | üü† –í–´–°–û–ö–ò–ô |
| 10 | `backend/src/infrastructure/workers/initializeWorkers.ts` | –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å `AirRouteGeneratorWorker`, –æ–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä `VirtualEntitiesGeneratorWorker` | üü† –í–´–°–û–ö–ò–ô |

### 5.3 –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–µ—Ä–µ–ø–∏—Å–∞–Ω–∏—è (6 —Ñ—É–Ω–∫—Ü–∏–π)

| ‚Ññ | –§—É–Ω–∫—Ü–∏—è | –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|---|---------|------|-----------|
| 1 | `extractCityFromStopName()` | `city-normalizer.ts:121-180` | –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–∞—Ç—Ç–µ—Ä–Ω–∞ "–ê—ç—Ä–æ–ø–æ—Ä—Ç [–ì–æ—Ä–æ–¥] ([–ê—ç—Ä–æ–ø–æ—Ä—Ç])" |
| 2 | `parseODataResponse()` | `ODataSyncWorker.ts:252-284` | –î–æ–±–∞–≤–∏—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏, –≤–∞–ª–∏–¥–∞—Ü–∏—é |
| 3 | `generateVirtualStops()` | `VirtualEntitiesGeneratorWorker.ts:~100-200` | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫, –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ |
| 4 | `ensureYakutiaCitiesConnectivity()` ‚Üí `ensureCitiesConnectivity()` | `VirtualEntitiesGeneratorWorker.ts:499-600` | –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å, –¥–æ–±–∞–≤–∏—Ç—å —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞, hub-based –º–∞—Ä—à—Ä—É—Ç—ã |
| 5 | `buildGraphStructure()` | `GraphBuilderWorker.ts:~130-300` | –î–æ–±–∞–≤–∏—Ç—å —Ä—ë–±—Ä–∞ –ø–µ—Ä–µ—Å–∞–¥–∫–∏, —Ä–∞—Å—á–µ—Ç –≤–µ—Å–∞ –ø–µ—Ä–µ—Å–∞–¥–∫–∏ |
| 6 | `calculateWeightWithValidation()` | `GraphBuilderWorker.ts` | –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—á–µ—Ç –≤–µ—Å–∞ –¥–ª—è ferry-–º–∞—Ä—à—Ä—É—Ç–æ–≤ —Å —É—á–µ—Ç–æ–º —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏ |

### 5.4 –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è (4 —Å—Ç—Ä—É–∫—Ç—É—Ä—ã)

| ‚Ññ | –°—Ç—Ä—É–∫—Ç—É—Ä–∞ | –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|---|-----------|------|-----------|
| 1 | `TransportType` type | `Route.ts:6` | –î–æ–±–∞–≤–∏—Ç—å `'FERRY'` |
| 2 | `GraphNeighbor` interface | `IGraphRepository.ts` | –î–æ–±–∞–≤–∏—Ç—å `transportType?: string` (–µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç) |
| 3 | `Route.metadata` | `Route.ts` | –î–æ–±–∞–≤–∏—Ç—å `ferrySchedule?: { summer: {...}, winter: {...} }` |
| 4 | `VirtualRoute` | `VirtualRoute.ts` | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `FERRY` —Ç–∏–ø–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ |

### 5.5 –ù–æ–≤—ã–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã –∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏

| ‚Ññ | –ù–∞–∑–≤–∞–Ω–∏–µ | –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|---|----------|------|------------|
| 1 | `AirRouteGeneratorWorker` | `AirRouteGeneratorWorker.ts` | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∞–≤–∏–∞–º–∞—Ä—à—Ä—É—Ç–æ–≤ –∏–∑ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ –≤ –Ø–∫—É—Ç—Å–∫ |
| 2 | `airports-reference.json` | `data/reference/airports-reference.json` | –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∞—ç—Ä–æ–ø–æ—Ä—Ç–æ–≤ –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ |
| 3 | `suburbs-reference.json` | `data/reference/suburbs-reference.json` | –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø—Ä–∏–≥–æ—Ä–æ–¥–æ–≤ –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ |
| 4 | `russia-federal-cities-reference.json` | `data/reference/russia-federal-cities-reference.json` | –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ |

### 5.6 –¢–µ—Å—Ç—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

| ‚Ññ | –¢–µ—Å—Ç | –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|---|------|------|-----------|
| 1 | `city-normalizer.test.ts` | `__tests__/unit/utils/` | –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∞—ç—Ä–æ–ø–æ—Ä—Ç–æ–≤ |
| 2 | `ODataSyncWorker.test.ts` | `__tests__/unit/workers/` | –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ |
| 3 | `VirtualEntitiesGeneratorWorker.test.ts` | `__tests__/unit/workers/` | –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è unified-cities-loader |
| 4 | `GraphBuilderWorker.test.ts` | `__tests__/unit/workers/` | –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –ø–µ—Ä–µ—Å–∞–¥–æ–∫ –∏ ferry |
| 5 | `stop-validator.test.ts` | `__tests__/unit/validators/` | –ù–æ–≤—ã–π —Ñ–∞–π–ª |
| 6 | `graph-validator.test.ts` | `__tests__/unit/validators/` | –ù–æ–≤—ã–π —Ñ–∞–π–ª |
| 7 | `AirRouteGeneratorWorker.test.ts` | `__tests__/unit/workers/` | –ù–æ–≤—ã–π —Ñ–∞–π–ª |
| 8 | `OptimizedBuildRouteUseCase.integration.test.ts` | `__tests__/integration/use-cases/` | –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è —Å–º–µ—à–∞–Ω–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ |

---

## 6. –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### 6.1 –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–¥–∞—á (–≤—ã–ø–æ–ª–Ω–∏–º –ø–æ –æ—á–µ—Ä–µ–¥–∏)

#### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ (–º–æ–∂–Ω–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)
1. –°–æ–∑–¥–∞—Ç—å `airports-reference.json`
2. –°–æ–∑–¥–∞—Ç—å `suburbs-reference.json`
3. –°–æ–∑–¥–∞—Ç—å `russia-federal-cities-reference.json`

#### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑—á–∏–∫–æ–≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤
4. –°–æ–∑–¥–∞—Ç—å `airports-loader.ts`
5. –°–æ–∑–¥–∞—Ç—å `suburbs-loader.ts`
6. –°–æ–∑–¥–∞—Ç—å `unified-cities-loader.ts`

#### –®–∞–≥ 3: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ (–∫—Ä–∏—Ç–∏—á–Ω–æ)
7. –û–±–Ω–æ–≤–∏—Ç—å `extractCityFromStopName()` –≤ `city-normalizer.ts`
8. –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è `city-normalizer.ts`

#### –®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–æ–≤
9. –°–æ–∑–¥–∞—Ç—å `stop-validator.ts`
10. –°–æ–∑–¥–∞—Ç—å `graph-validator.ts` (–ø–æ–∫–∞ –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
11. –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–æ–≤

#### –®–∞–≥ 5: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ ODataSyncWorker (–∫—Ä–∏—Ç–∏—á–Ω–æ)
12. –û–±–Ω–æ–≤–∏—Ç—å `parseODataResponse()` –≤ `ODataSyncWorker.ts`:
    - –î–æ–±–∞–≤–∏—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏
    - –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é —á–µ—Ä–µ–∑ `stop-validator.ts`
    - –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —á–µ—Ä–µ–∑ `isCityInUnifiedReference()`
13. –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è `ODataSyncWorker.ts`

#### –®–∞–≥ 6: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ VirtualEntitiesGeneratorWorker
14. –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã (unified-cities-loader –≤–º–µ—Å—Ç–æ yakutia-cities-loader)
15. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä (—É–¥–∞–ª–∏—Ç—å citiesDirectory)
16. –û–±–Ω–æ–≤–∏—Ç—å `generateVirtualStops()`
17. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –∏ –æ–±–Ω–æ–≤–∏—Ç—å `ensureCitiesConnectivity()`
18. –û–±–Ω–æ–≤–∏—Ç—å `initializeWorkers.ts` (—É–¥–∞–ª–∏—Ç—å –ø–µ—Ä–µ–¥–∞—á—É citiesDirectory)
19. –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è `VirtualEntitiesGeneratorWorker.ts`

#### –®–∞–≥ 7: –°–æ–∑–¥–∞–Ω–∏–µ AirRouteGeneratorWorker
20. –°–æ–∑–¥–∞—Ç—å `AirRouteGeneratorWorker.ts`
21. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ `initializeWorkers.ts`
22. –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã

#### –®–∞–≥ 8: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ mock-–¥–∞–Ω–Ω—ã—Ö
23. –û–±–Ω–æ–≤–∏—Ç—å `stops.json` (–¥–æ–±–∞–≤–∏—Ç—å —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ –∏ –ø–µ—Ä–µ–ø—Ä–∞–≤—É)
24. –û–±–Ω–æ–≤–∏—Ç—å `routes.json` (–¥–æ–±–∞–≤–∏—Ç—å –∞–≤–∏–∞–º–∞—Ä—à—Ä—É—Ç—ã –∏ ferry-–º–∞—Ä—à—Ä—É—Ç—ã)
25. –û–±–Ω–æ–≤–∏—Ç—å `flights.json` (–¥–æ–±–∞–≤–∏—Ç—å —Ä–µ–π—Å—ã)

#### –®–∞–≥ 9: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ FERRY –≤ TransportType
26. –û–±–Ω–æ–≤–∏—Ç—å `Route.ts` (–¥–æ–±–∞–≤–∏—Ç—å 'FERRY' –≤ TransportType)
27. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–∞—Ö

#### –®–∞–≥ 10: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ GraphBuilderWorker –¥–ª—è –ø–µ—Ä–µ—Å–∞–¥–æ–∫
28. –î–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ –ø–æ –≥–æ—Ä–æ–¥–∞–º
29. –î–æ–±–∞–≤–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Ä—ë–±–µ—Ä –ø–µ—Ä–µ—Å–∞–¥–∫–∏
30. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `calculateTransferWeight()`
31. –û–±–Ω–æ–≤–∏—Ç—å —Ä–∞—Å—á–µ—Ç –≤–µ—Å–∞ –¥–ª—è ferry-–º–∞—Ä—à—Ä—É—Ç–æ–≤
32. –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã

#### –®–∞–≥ 11: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ RouteGraphBuilder
33. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É FERRY —Ç–∏–ø–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
34. –û–±–Ω–æ–≤–∏—Ç—å —Ä–∞—Å—á–µ—Ç –≤–µ—Å–∞ –¥–ª—è ferry-–º–∞—Ä—à—Ä—É—Ç–æ–≤
35. –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã

#### –®–∞–≥ 12: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∞
36. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å `graph-validator.ts` –≤ `GraphBuilderWorker`
37. –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
38. –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã

#### –®–∞–≥ 13: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
39. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ unit-—Ç–µ—Å—Ç—ã
40. –ó–∞–ø—É—Å—Ç–∏—Ç—å integration-—Ç–µ—Å—Ç—ã
41. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
42. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

### 6.2 –ü–æ—Ä—è–¥–æ–∫ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

**–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞:**
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –Ω–µ—Ç –æ—à–∏–±–æ–∫ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –Ω–µ—Ç –æ—à–∏–±–æ–∫ –ª–∏–Ω—Ç–µ—Ä–∞
4. –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ git (–µ—Å–ª–∏ –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç)

**–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ Milestone:**
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
3. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
4. –°–æ–∑–¥–∞—Ç—å git tag –¥–ª—è milestone

---

## 7. –°—Ö–µ–º—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≥—Ä–∞—Ñ–∞

### 7.1 –¢–µ–∫—É—â–∞—è —Å—Ö–µ–º–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∞

```
[ODataSyncWorker]
    ‚îÇ
    ‚îú‚îÄ‚Üí –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ OData
    ‚îú‚îÄ‚Üí –ü–∞—Ä—Å–∏—Ç –≤ RealStop, Route, Flight
    ‚îî‚îÄ‚Üí –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ PostgreSQL
         ‚îÇ
[VirtualEntitiesGeneratorWorker]
    ‚îÇ
    ‚îú‚îÄ‚Üí –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≥–æ—Ä–æ–¥–∞ –∏–∑ yakutia-cities-reference.json
    ‚îú‚îÄ‚Üí –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç VirtualStop –¥–ª—è –≥–æ—Ä–æ–¥–æ–≤ –±–µ–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –æ—Å—Ç–∞–Ω–æ–≤–æ–∫
    ‚îú‚îÄ‚Üí –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç VirtualRoute –¥–ª—è –ø–∞—Ä –≥–æ—Ä–æ–¥–æ–≤ –Ø–∫—É—Ç–∏–∏
    ‚îî‚îÄ‚Üí –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ PostgreSQL
         ‚îÇ
[GraphBuilderWorker]
    ‚îÇ
    ‚îú‚îÄ‚Üí –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ (real + virtual)
    ‚îú‚îÄ‚Üí –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ –º–∞—Ä—à—Ä—É—Ç—ã (real + virtual)
    ‚îú‚îÄ‚Üí –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ —Ä–µ–π—Å—ã
    ‚îú‚îÄ‚Üí –°–æ–∑–¥–∞–µ—Ç —É–∑–ª—ã –≥—Ä–∞—Ñ–∞ (nodes = stops)
    ‚îú‚îÄ‚Üí –°–æ–∑–¥–∞–µ—Ç —Ä—ë–±—Ä–∞ –≥—Ä–∞—Ñ–∞ (edges = routes)
    ‚îî‚îÄ‚Üí –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≥—Ä–∞—Ñ –≤ Redis
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå –ù–µ—Ç —Ä—ë–±–µ—Ä –ø–µ—Ä–µ—Å–∞–¥–∫–∏ –º–µ–∂–¥—É –æ—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏ –≤ –æ–¥–Ω–æ–º –≥–æ—Ä–æ–¥–µ
- ‚ùå –ù–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ ferry-–º–∞—Ä—à—Ä—É—Ç–æ–≤
- ‚ùå –ù–µ—Ç —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤

### 7.2 –ù–æ–≤–∞—è —Å—Ö–µ–º–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∞

```
[ODataSyncWorker]
    ‚îÇ
    ‚îú‚îÄ‚Üí –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ OData
    ‚îú‚îÄ‚Üí –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç city_id —á–µ—Ä–µ–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ (–∞—ç—Ä–æ–ø–æ—Ä—Ç—ã, –ø—Ä–∏–≥–æ—Ä–æ–¥—ã)
    ‚îú‚îÄ‚Üí –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ stop-validator
    ‚îú‚îÄ‚Üí –ü—Ä–æ–≤–µ—Ä—è–µ—Ç city_id —á–µ—Ä–µ–∑ unified-cities-reference
    ‚îú‚îÄ‚Üí –ü–∞—Ä—Å–∏—Ç –≤ RealStop, Route, Flight
    ‚îî‚îÄ‚Üí –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ PostgreSQL
         ‚îÇ
[AirRouteGeneratorWorker] (–ù–û–í–´–ô)
    ‚îÇ
    ‚îú‚îÄ‚Üí –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ –∏–∑ unified-cities-reference
    ‚îú‚îÄ‚Üí –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∞–≤–∏–∞–º–∞—Ä—à—Ä—É—Ç—ã: —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥ ‚Üî –Ø–∫—É—Ç—Å–∫
    ‚îú‚îÄ‚Üí –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–µ–π—Å—ã –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–æ–≤
    ‚îî‚îÄ‚Üí –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ PostgreSQL
         ‚îÇ
[VirtualEntitiesGeneratorWorker]
    ‚îÇ
    ‚îú‚îÄ‚Üí –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≥–æ—Ä–æ–¥–∞ –∏–∑ unified-cities-reference (–Ø–∫—É—Ç–∏—è + —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ)
    ‚îú‚îÄ‚Üí –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç VirtualStop –¥–ª—è –≥–æ—Ä–æ–¥–æ–≤ –±–µ–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –æ—Å—Ç–∞–Ω–æ–≤–æ–∫
    ‚îú‚îÄ‚Üí –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç VirtualRoute:
    ‚îÇ   ‚îú‚îÄ‚Üí –§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –≥–æ—Ä–æ–¥ –Ø–∫—É—Ç–∏–∏ (hub-based)
    ‚îÇ   ‚îú‚îÄ‚Üí –§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥ ‚Üí —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥ (–ø—Ä—è–º—ã–µ)
    ‚îÇ   ‚îî‚îÄ‚Üí –ì–æ—Ä–æ–¥ –Ø–∫—É—Ç–∏–∏ ‚Üí –≥–æ—Ä–æ–¥ –Ø–∫—É—Ç–∏–∏ (—Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è –ª–æ–≥–∏–∫–∞)
    ‚îî‚îÄ‚Üí –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ PostgreSQL
         ‚îÇ
[GraphBuilderWorker]
    ‚îÇ
    ‚îú‚îÄ‚Üí –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ (real + virtual)
    ‚îú‚îÄ‚Üí –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ –º–∞—Ä—à—Ä—É—Ç—ã (real + virtual)
    ‚îú‚îÄ‚Üí –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ —Ä–µ–π—Å—ã
    ‚îú‚îÄ‚Üí –°–æ–∑–¥–∞–µ—Ç —É–∑–ª—ã –≥—Ä–∞—Ñ–∞ (nodes = stops)
    ‚îú‚îÄ‚Üí –°–æ–∑–¥–∞–µ—Ç —Ä—ë–±—Ä–∞ –∏–∑ –º–∞—Ä—à—Ä—É—Ç–æ–≤ (edges = routes)
    ‚îú‚îÄ‚Üí –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ –≥–æ—Ä–æ–¥–∞–º
    ‚îú‚îÄ‚Üí –°–æ–∑–¥–∞–µ—Ç —Ä—ë–±—Ä–∞ –ø–µ—Ä–µ—Å–∞–¥–∫–∏ –º–µ–∂–¥—É –æ—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏ –≤ –æ–¥–Ω–æ–º –≥–æ—Ä–æ–¥–µ:
    ‚îÇ   ‚îú‚îÄ‚Üí –¢–∏–ø: TRANSFER
    ‚îÇ   ‚îî‚îÄ‚Üí –í–µ—Å: calculateTransferWeight() (60-120 –º–∏–Ω—É—Ç)
    ‚îú‚îÄ‚Üí –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –≤–µ—Å –¥–ª—è ferry-–º–∞—Ä—à—Ä—É—Ç–æ–≤ (20 –º–∏–Ω + –æ–∂–∏–¥–∞–Ω–∏–µ)
    ‚îú‚îÄ‚Üí –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –≥—Ä–∞—Ñ —á–µ—Ä–µ–∑ graph-validator
    ‚îî‚îÄ‚Üí –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≥—Ä–∞—Ñ –≤ Redis
```

**–£–ª—É—á—à–µ–Ω–∏—è:**
- ‚úÖ –†—ë–±—Ä–∞ –ø–µ—Ä–µ—Å–∞–¥–∫–∏ –º–µ–∂–¥—É –æ—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏ –≤ –æ–¥–Ω–æ–º –≥–æ—Ä–æ–¥–µ
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ ferry-–º–∞—Ä—à—Ä—É—Ç–æ–≤
- ‚úÖ –§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ –≤–∫–ª—é—á–µ–Ω—ã
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≥—Ä–∞—Ñ–∞ –ø–æ—Å–ª–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è

### 7.3 –°—Ö–µ–º–∞ —Ä—ë–±–µ—Ä –ø–µ—Ä–µ—Å–∞–¥–∫–∏

```
–ì–æ—Ä–æ–¥: –Ø–∫—É—Ç—Å–∫
    ‚îÇ
    ‚îú‚îÄ‚Üí –û—Å—Ç–∞–Ω–æ–≤–∫–∞ 1: "–ê—ç—Ä–æ–ø–æ—Ä—Ç –Ø–∫—É—Ç—Å–∫ (–¢—É–π–º–∞–∞–¥–∞)"
    ‚îÇ   ‚îÇ
    ‚îÇ   ‚îú‚îÄ‚Üí [TRANSFER, 90 –º–∏–Ω] ‚Üí –û—Å—Ç–∞–Ω–æ–≤–∫–∞ 2: "–ê–≤—Ç–æ—Å—Ç–∞–Ω—Ü–∏—è –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –Ø–∫—É—Ç—Å–∫"
    ‚îÇ   ‚îú‚îÄ‚Üí [TRANSFER, 90 –º–∏–Ω] ‚Üí –û—Å—Ç–∞–Ω–æ–≤–∫–∞ 3: "–ü—Ä–∏—Å—Ç–∞–Ω—å –Ø–∫—É—Ç—Å–∫"
    ‚îÇ   ‚îî‚îÄ‚Üí [PLANE, 240 –º–∏–Ω] ‚Üí –û—Å—Ç–∞–Ω–æ–≤–∫–∞ 4: "–ê—ç—Ä–æ–ø–æ—Ä—Ç –ú–æ—Å–∫–≤–∞ –®–µ—Ä–µ–º–µ—Ç—å–µ–≤–æ"
    ‚îÇ
    ‚îú‚îÄ‚Üí –û—Å—Ç–∞–Ω–æ–≤–∫–∞ 2: "–ê–≤—Ç–æ—Å—Ç–∞–Ω—Ü–∏—è –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –Ø–∫—É—Ç—Å–∫"
    ‚îÇ   ‚îÇ
    ‚îÇ   ‚îú‚îÄ‚Üí [TRANSFER, 90 –º–∏–Ω] ‚Üí –û—Å—Ç–∞–Ω–æ–≤–∫–∞ 1: "–ê—ç—Ä–æ–ø–æ—Ä—Ç –Ø–∫—É—Ç—Å–∫"
    ‚îÇ   ‚îú‚îÄ‚Üí [TRANSFER, 60 –º–∏–Ω] ‚Üí –û—Å—Ç–∞–Ω–æ–≤–∫–∞ 3: "–ü—Ä–∏—Å—Ç–∞–Ω—å –Ø–∫—É—Ç—Å–∫"
    ‚îÇ   ‚îî‚îÄ‚Üí [BUS, 180 –º–∏–Ω] ‚Üí –û—Å—Ç–∞–Ω–æ–≤–∫–∞ 5: "–ê–≤—Ç–æ—Å—Ç–∞–Ω—Ü–∏—è –û–ª—ë–∫–º–∏–Ω—Å–∫"
    ‚îÇ
    ‚îî‚îÄ‚Üí –û—Å—Ç–∞–Ω–æ–≤–∫–∞ 3: "–ü—Ä–∏—Å—Ç–∞–Ω—å –Ø–∫—É—Ç—Å–∫"
        ‚îÇ
        ‚îú‚îÄ‚Üí [TRANSFER, 30 –º–∏–Ω] ‚Üí –û—Å—Ç–∞–Ω–æ–≤–∫–∞ 2: "–ê–≤—Ç–æ—Å—Ç–∞–Ω—Ü–∏—è –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –Ø–∫—É—Ç—Å–∫"
        ‚îî‚îÄ‚Üí [FERRY, 40 –º–∏–Ω] ‚Üí –û—Å—Ç–∞–Ω–æ–≤–∫–∞ 6: "–ü–∞—Ä–æ–º–Ω–∞—è –ø–µ—Ä–µ–ø—Ä–∞–≤–∞ –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö"
```

### 7.4 –°—Ö–µ–º–∞ —Å–º–µ—à–∞–Ω–Ω–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞

**–ü—Ä–∏–º–µ—Ä: –ú–æ—Å–∫–≤–∞ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö**

```
–ú–æ—Å–∫–≤–∞ (–ê—ç—Ä–æ–ø–æ—Ä—Ç –®–µ—Ä–µ–º–µ—Ç—å–µ–≤–æ)
    ‚îÇ
    ‚îî‚îÄ‚Üí [PLANE, 240 –º–∏–Ω] ‚Üí –Ø–∫—É—Ç—Å–∫ (–ê—ç—Ä–æ–ø–æ—Ä—Ç –¢—É–π–º–∞–∞–¥–∞)
            ‚îÇ
            ‚îî‚îÄ‚Üí [TRANSFER, 90 –º–∏–Ω] ‚Üí –Ø–∫—É—Ç—Å–∫ (–ü—Ä–∏—Å—Ç–∞–Ω—å)
                    ‚îÇ
                    ‚îî‚îÄ‚Üí [FERRY, 40 –º–∏–Ω] ‚Üí –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö (–ü–∞—Ä–æ–º–Ω–∞—è –ø–µ—Ä–µ–ø—Ä–∞–≤–∞)
```

**–í–µ—Å –º–∞—Ä—à—Ä—É—Ç–∞:** 240 + 90 + 40 = **370 –º–∏–Ω—É—Ç** (‚âà6 —á–∞—Å–æ–≤ 10 –º–∏–Ω—É—Ç)

---

## 8. –ò—Ç–æ–≥–æ–≤—ã–π –ø–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 8.1 –û–±—â–∏–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ø–ª–∞–Ω

**–¶–µ–ª—å:** –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö, –¥–æ–±–∞–≤–∏—Ç—å —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞, —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–º–µ—à–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –∏ –ø–µ—Ä–µ–ø—Ä–∞–≤—É, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≥—Ä–∞—Ñ.

**–û–±—â–µ–µ –≤—Ä–µ–º—è:** 12-16 –¥–Ω–µ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

**–≠—Ç–∞–ø—ã:**
1. **–≠—Ç–∞–ø 1 (2-3 –¥–Ω—è):** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
2. **–≠—Ç–∞–ø 2 (3-4 –¥–Ω—è):** –§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞
3. **–≠—Ç–∞–ø 3 (4-5 –¥–Ω–µ–π):** –°–º–µ—à–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –∏ –ø–µ—Ä–µ–ø—Ä–∞–≤–∞
4. **–≠—Ç–∞–ø 4 (3-4 –¥–Ω—è):** –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∞, –≤–∞–ª–∏–¥–∞—Ü–∏—è, –ø–µ—Ä–µ—Å–∞–¥–∫–∏

### 8.2 –ü–æ–¥–∑–∞–¥–∞—á–∏ –ø–æ –∫–∞–∂–¥–æ–º—É —ç—Ç–∞–ø—É

#### –≠—Ç–∞–ø 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**M1.1: –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ –∞—ç—Ä–æ–ø–æ—Ä—Ç–æ–≤ –∏ –ø—Ä–∏–≥–æ—Ä–æ–¥–æ–≤**
- –°–æ–∑–¥–∞—Ç—å `airports-reference.json` (8 –∞—ç—Ä–æ–ø–æ—Ä—Ç–æ–≤)
- –°–æ–∑–¥–∞—Ç—å `suburbs-reference.json` (2 –ø—Ä–∏–≥–æ—Ä–æ–¥–∞)
- –°–æ–∑–¥–∞—Ç—å `airports-loader.ts`
- –°–æ–∑–¥–∞—Ç—å `suburbs-loader.ts`
- Unit-—Ç–µ—Å—Ç—ã –¥–ª—è –∑–∞–≥—Ä—É–∑—á–∏–∫–æ–≤

**M1.2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ `extractCityFromStopName()`**
- –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–∞—Ç—Ç–µ—Ä–Ω–∞ "–ê—ç—Ä–æ–ø–æ—Ä—Ç [–ì–æ—Ä–æ–¥] ([–ê—ç—Ä–æ–ø–æ—Ä—Ç])"
- –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–∞—Ç—Ç–µ—Ä–Ω–∞ "–ê—ç—Ä–æ–ø–æ—Ä—Ç [–ì–æ—Ä–æ–¥]" (–±–µ–∑ —Å–∫–æ–±–æ–∫)
- Unit-—Ç–µ—Å—Ç—ã –¥–ª—è –Ω–æ–≤—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤

**M1.3: –í–∞–ª–∏–¥–∞—Ç–æ—Ä –æ—Å—Ç–∞–Ω–æ–≤–æ–∫**
- –°–æ–∑–¥–∞—Ç—å `stop-validator.ts`
- Unit-—Ç–µ—Å—Ç—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–∞

**M1.4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `ODataSyncWorker`**
- –î–æ–±–∞–≤–∏—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏
- –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é —á–µ—Ä–µ–∑ `stop-validator.ts`
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —á–µ—Ä–µ–∑ `isCityInUnifiedReference()`
- Unit-—Ç–µ—Å—Ç—ã –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

#### –≠—Ç–∞–ø 2: –§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞

**M2.1: –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤**
- –°–æ–∑–¥–∞—Ç—å `russia-federal-cities-reference.json` (10 –≥–æ—Ä–æ–¥–æ–≤)

**M2.2: –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫**
- –°–æ–∑–¥–∞—Ç—å `unified-cities-loader.ts`
- Unit-—Ç–µ—Å—Ç—ã

**M2.3: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `ODataSyncWorker` –¥–ª—è unified-reference**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `isCityInUnifiedReference()` –≤–º–µ—Å—Ç–æ —Ç–æ–ª—å–∫–æ yakutia

**M2.4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `VirtualEntitiesGeneratorWorker`**
- –ó–∞–º–µ–Ω–∏—Ç—å `yakutia-cities-loader` –Ω–∞ `unified-cities-loader`
- –û–±–Ω–æ–≤–∏—Ç—å `generateVirtualStops()`
- –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –∏ –æ–±–Ω–æ–≤–∏—Ç—å `ensureCitiesConnectivity()`
- –û–±–Ω–æ–≤–∏—Ç—å `initializeWorkers.ts`
- Unit-—Ç–µ—Å—Ç—ã

**M2.5: –°–æ–∑–¥–∞–Ω–∏–µ `AirRouteGeneratorWorker`**
- –°–æ–∑–¥–∞—Ç—å `AirRouteGeneratorWorker.ts`
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ –ø–∞–π–ø–ª–∞–π–Ω –≤–æ—Ä–∫–µ—Ä–æ–≤
- Unit-—Ç–µ—Å—Ç—ã

#### –≠—Ç–∞–ø 3: –°–º–µ—à–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –∏ –ø–µ—Ä–µ–ø—Ä–∞–≤–∞

**M3.1: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ mock-–¥–∞–Ω–Ω—ã—Ö**
- –û–±–Ω–æ–≤–∏—Ç—å `stops.json` (—Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ + –ø–µ—Ä–µ–ø—Ä–∞–≤–∞)
- –û–±–Ω–æ–≤–∏—Ç—å `routes.json` (–∞–≤–∏–∞–º–∞—Ä—à—Ä—É—Ç—ã + ferry-–º–∞—Ä—à—Ä—É—Ç—ã)
- –û–±–Ω–æ–≤–∏—Ç—å `flights.json` (—Ä–µ–π—Å—ã)

**M3.2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ FERRY –≤ TransportType**
- –û–±–Ω–æ–≤–∏—Ç—å `Route.ts`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–∞—Ö

**M3.3: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `GraphBuilderWorker` –¥–ª—è –ø–µ—Ä–µ—Å–∞–¥–æ–∫**
- –î–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ –ø–æ –≥–æ—Ä–æ–¥–∞–º
- –î–æ–±–∞–≤–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Ä—ë–±–µ—Ä –ø–µ—Ä–µ—Å–∞–¥–∫–∏
- –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `calculateTransferWeight()`
- –û–±–Ω–æ–≤–∏—Ç—å —Ä–∞—Å—á–µ—Ç –≤–µ—Å–∞ –¥–ª—è ferry-–º–∞—Ä—à—Ä—É—Ç–æ–≤
- Unit-—Ç–µ—Å—Ç—ã

**M3.4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `RouteGraphBuilder`**
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ FERRY —Ç–∏–ø–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
- –û–±–Ω–æ–≤–∏—Ç—å —Ä–∞—Å—á–µ—Ç –≤–µ—Å–∞ –¥–ª—è ferry-–º–∞—Ä—à—Ä—É—Ç–æ–≤
- Unit-—Ç–µ—Å—Ç—ã

#### –≠—Ç–∞–ø 4: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∞, –≤–∞–ª–∏–¥–∞—Ü–∏—è, –ø–µ—Ä–µ—Å–∞–¥–∫–∏

**M4.1: –í–∞–ª–∏–¥–∞—Ç–æ—Ä –≥—Ä–∞—Ñ–∞**
- –°–æ–∑–¥–∞—Ç—å `graph-validator.ts`
- Unit-—Ç–µ—Å—Ç—ã

**M4.2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏**
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ `GraphBuilderWorker`
- –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- Unit-—Ç–µ—Å—Ç—ã

**M4.3: –û—Ç–ª–∞–¥–∫–∞ –≥—Ä–∞—Ñ–∞**
- –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
- –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

**M4.4: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

### 8.3 –°–ø–∏—Å–æ–∫ —É–ª—É—á—à–µ–Ω–∏–π –ø–æ —Ñ–∞–π–ª–∞–º

#### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã (9 —Ñ–∞–π–ª–æ–≤)

1. `backend/data/reference/airports-reference.json` - –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∞—ç—Ä–æ–ø–æ—Ä—Ç–æ–≤
2. `backend/data/reference/suburbs-reference.json` - –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø—Ä–∏–≥–æ—Ä–æ–¥–æ–≤
3. `backend/data/reference/russia-federal-cities-reference.json` - –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
4. `backend/src/shared/utils/airports-loader.ts` - –ó–∞–≥—Ä—É–∑—á–∏–∫ –∞—ç—Ä–æ–ø–æ—Ä—Ç–æ–≤
5. `backend/src/shared/utils/suburbs-loader.ts` - –ó–∞–≥—Ä—É–∑—á–∏–∫ –ø—Ä–∏–≥–æ—Ä–æ–¥–æ–≤
6. `backend/src/shared/utils/unified-cities-loader.ts` - –ó–∞–≥—Ä—É–∑—á–∏–∫ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–æ–≥–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
7. `backend/src/shared/validators/stop-validator.ts` - –í–∞–ª–∏–¥–∞—Ç–æ—Ä –æ—Å—Ç–∞–Ω–æ–≤–æ–∫
8. `backend/src/shared/validators/graph-validator.ts` - –í–∞–ª–∏–¥–∞—Ç–æ—Ä –≥—Ä–∞—Ñ–∞
9. `backend/src/application/workers/AirRouteGeneratorWorker.ts` - –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∞–≤–∏–∞–º–∞—Ä—à—Ä—É—Ç–æ–≤

#### –û–±–Ω–æ–≤–ª—è–µ–º—ã–µ —Ñ–∞–π–ª—ã (10 —Ñ–∞–π–ª–æ–≤)

1. `backend/src/shared/utils/city-normalizer.ts` - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ `extractCityFromStopName()`
2. `backend/src/application/workers/ODataSyncWorker.ts` - –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
3. `backend/src/application/workers/VirtualEntitiesGeneratorWorker.ts` - Unified-cities-loader, `ensureCitiesConnectivity()`
4. `backend/src/application/workers/GraphBuilderWorker.ts` - –†—ë–±—Ä–∞ –ø–µ—Ä–µ—Å–∞–¥–∫–∏, –≤–∞–ª–∏–¥–∞—Ü–∏—è
5. `backend/src/application/route-builder/RouteGraphBuilder.ts` - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ ferry
6. `backend/src/domain/entities/Route.ts` - –î–æ–±–∞–≤–∏—Ç—å `'FERRY'` –≤ `TransportType`
7. `backend/data/mock/stops.json` - –û—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–ª—è –ø–µ—Ä–µ–ø—Ä–∞–≤—ã –∏ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
8. `backend/data/mock/routes.json` - Ferry-–º–∞—Ä—à—Ä—É—Ç—ã –∏ –∞–≤–∏–∞–º–∞—Ä—à—Ä—É—Ç—ã
9. `backend/data/mock/flights.json` - –†–µ–π—Å—ã –¥–ª—è –Ω–æ–≤—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤
10. `backend/src/infrastructure/workers/initializeWorkers.ts` - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è `AirRouteGeneratorWorker`

### 8.4 –°–ø–∏—Å–æ–∫ –Ω–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π

1. **AirportsLoader** (`airports-loader.ts`)
   - `loadAirportsReference(): Map<string, string>`
   - `getCityByAirportName(airportName): string | undefined`

2. **SuburbsLoader** (`suburbs-loader.ts`)
   - `loadSuburbsReference(): Map<string, string>`
   - `getMainCityBySuburb(suburbName): string | undefined`

3. **UnifiedCitiesLoader** (`unified-cities-loader.ts`)
   - `loadUnifiedCitiesReference(): Map<string, UnifiedCity>`
   - `getUnifiedCity(cityName): UnifiedCity | undefined`
   - `isCityInUnifiedReference(cityName): boolean`
   - `getAllFederalCities(): UnifiedCity[]`
   - `getAllYakutiaCities(): UnifiedCity[]`

4. **StopValidator** (`stop-validator.ts`)
   - `validateStopData(stopData): ValidationResult`

5. **GraphValidator** (`graph-validator.ts`)
   - `validateGraphStructure(nodes, edges): GraphValidationResult`
   - `validateTransferEdges(edges): ValidationResult`
   - `validateFerryEdges(edges): ValidationResult`

6. **AirRouteGeneratorWorker** (`AirRouteGeneratorWorker.ts`)
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∞–≤–∏–∞–º–∞—Ä—à—Ä—É—Ç–æ–≤ –∏–∑ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ –≤ –Ø–∫—É—Ç—Å–∫

### 8.5 –°—Ö–µ–º—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≥—Ä–∞—Ñ–∞

#### –°—Ö–µ–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä—ë–±–µ—Ä –ø–µ—Ä–µ—Å–∞–¥–∫–∏

```typescript
// –ü—Å–µ–≤–¥–æ–∫–æ–¥
function buildGraphWithTransfers(stops, routes) {
  const nodes = createNodesFromStops(stops);
  const edges = createEdgesFromRoutes(routes);
  
  // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ –≥–æ—Ä–æ–¥–∞–º
  const stopsByCity = groupStopsByCity(stops);
  
  // –î–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–æ—Ä–æ–¥–∞ —Å–æ–∑–¥–∞–µ–º —Ä—ë–±—Ä–∞ –ø–µ—Ä–µ—Å–∞–¥–∫–∏
  for (const [city, cityStops] of stopsByCity) {
    if (cityStops.length < 2) continue;
    
    // –°–æ–∑–¥–∞–µ–º —Ä—ë–±—Ä–∞ –º–µ–∂–¥—É –≤—Å–µ–º–∏ –ø–∞—Ä–∞–º–∏ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ –≤ –≥–æ—Ä–æ–¥–µ
    for (let i = 0; i < cityStops.length; i++) {
      for (let j = i + 1; j < cityStops.length; j++) {
        const weight = calculateTransferWeight(cityStops[i], cityStops[j]);
        
        // –î–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ä—ë–±—Ä–∞
        edges.push({
          fromStopId: cityStops[i].id,
          toStopId: cityStops[j].id,
          weight: weight,
          transportType: 'TRANSFER'
        });
        
        edges.push({
          fromStopId: cityStops[j].id,
          toStopId: cityStops[i].id,
          weight: weight,
          transportType: 'TRANSFER'
        });
      }
    }
  }
  
  return { nodes, edges };
}
```

#### –°—Ö–µ–º–∞ —Ä–∞—Å—á–µ—Ç–∞ –≤–µ—Å–∞ ferry-–º–∞—Ä—à—Ä—É—Ç–∞

```typescript
// –ü—Å–µ–≤–¥–æ–∫–æ–¥
function calculateFerryWeight(route, currentDate) {
  const baseDuration = route.duration || 20; // 20 –º–∏–Ω—É—Ç –ø–µ—Ä–µ–ø—Ä–∞–≤–∞
  const schedule = route.metadata?.ferrySchedule;
  
  if (!schedule) {
    return baseDuration + 30; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é +30 –º–∏–Ω—É—Ç –æ–∂–∏–¥–∞–Ω–∏—è
  }
  
  // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–µ–∑–æ–Ω (–ª–µ—Ç–æ/–∑–∏–º–∞)
  const month = currentDate.getMonth(); // 0-11
  const isSummer = month >= 4 && month <= 9; // –ú–∞–π-–û–∫—Ç—è–±—Ä—å
  
  const seasonSchedule = isSummer ? schedule.summer : schedule.winter;
  const waitTime = seasonSchedule.frequency / 2; // –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è
  
  return baseDuration + waitTime;
}
```

### 8.6 –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

#### –§–∞–∑–∞ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–º–æ–∂–Ω–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)
1. ‚úÖ –°–æ–∑–¥–∞—Ç—å –≤—Å–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ (airports, suburbs, federal-cities)
2. ‚úÖ –°–æ–∑–¥–∞—Ç—å –≤—Å–µ –∑–∞–≥—Ä—É–∑—á–∏–∫–∏ (airports-loader, suburbs-loader, unified-cities-loader)
3. ‚úÖ –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è –∑–∞–≥—Ä—É–∑—á–∏–∫–æ–≤

#### –§–∞–∑–∞ 2: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ)
4. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å `extractCityFromStopName()` –≤ `city-normalizer.ts`
5. ‚úÖ –°–æ–∑–¥–∞—Ç—å `stop-validator.ts`
6. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å `ODataSyncWorker.parseODataResponse()`:
   - –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏
   - –í–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ `stop-validator.ts`
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ `isCityInUnifiedReference()`
7. ‚úÖ –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ó–∞–ø—É—Å—Ç–∏—Ç—å ODataSyncWorker, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –Ø–∫—É—Ç—Å–∫ –ø–æ—è–≤–ª—è–µ—Ç—Å—è, –¢—É–π–º–∞–¥–∞ –∏—Å—á–µ–∑–∞–µ—Ç

#### –§–∞–∑–∞ 3: –§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ)
8. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å `ODataSyncWorker` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è unified-reference
9. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å `VirtualEntitiesGeneratorWorker`:
   - Unified-cities-loader
   - `generateVirtualStops()` –¥–ª—è —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
   - `ensureCitiesConnectivity()` –¥–ª—è hub-based –º–∞—Ä—à—Ä—É—Ç–æ–≤
10. ‚úÖ –°–æ–∑–¥–∞—Ç—å `AirRouteGeneratorWorker`
11. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å `AirRouteGeneratorWorker` –≤ –ø–∞–π–ø–ª–∞–π–Ω
12. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å `initializeWorkers.ts`
13. ‚úÖ –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã

**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤–æ—Ä–∫–µ—Ä—ã, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ –¥–æ—Å—Ç—É–ø–Ω—ã, –º–∞—Ä—à—Ä—É—Ç—ã —Å—Ç—Ä–æ—è—Ç—Å—è

#### –§–∞–∑–∞ 4: –°–º–µ—à–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –∏ –ø–µ—Ä–µ–ø—Ä–∞–≤–∞ (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ)
14. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å mock-–¥–∞–Ω–Ω—ã–µ (stops.json, routes.json, flights.json)
15. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å `'FERRY'` –≤ `TransportType` –≤ `Route.ts`
16. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å `GraphBuilderWorker`:
   - –†—ë–±—Ä–∞ –ø–µ—Ä–µ—Å–∞–¥–∫–∏
   - `calculateTransferWeight()`
   - –†–∞—Å—á–µ—Ç –≤–µ—Å–∞ –¥–ª—è ferry
17. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å `RouteGraphBuilder` –¥–ª—è ferry
18. ‚úÖ –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã

**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–º–µ—à–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã, –ø–µ—Ä–µ–ø—Ä–∞–≤—É

#### –§–∞–∑–∞ 5: –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ)
19. ‚úÖ –°–æ–∑–¥–∞—Ç—å `graph-validator.ts`
20. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤ `GraphBuilderWorker`
21. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–µ—Ç—Ä–∏–∫–∏
22. ‚úÖ –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã

**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã

#### –§–∞–∑–∞ 6: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
23. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ unit-—Ç–µ—Å—Ç—ã
24. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç—å integration-—Ç–µ—Å—Ç—ã
25. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã:
   - –ú–æ—Å–∫–≤–∞ ‚Üí –Ø–∫—É—Ç—Å–∫
   - –ú–æ—Å–∫–≤–∞ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –ß—É—Ä–∞–ø—á–∞
   - –ú–æ—Å–∫–≤–∞ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö
   - –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –û–ª—ë–∫–º–∏–Ω—Å–∫
   - –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –ú–∏—Ä–Ω—ã–π
26. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

---

## 9. –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

### 9.1 –°–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤

| ‚Ññ | –ú–∞—Ä—à—Ä—É—Ç | –¢–∏–ø—ã —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ | –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç |
|---|---------|-----------------|---------------------|
| 1 | –ú–æ—Å–∫–≤–∞ ‚Üí –Ø–∫—É—Ç—Å–∫ | PLANE | –ü—Ä—è–º–æ–π –∞–≤–∏–∞–º–∞—Ä—à—Ä—É—Ç, 240 –º–∏–Ω—É—Ç |
| 2 | –ú–æ—Å–∫–≤–∞ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –ß—É—Ä–∞–ø—á–∞ | PLANE + TRANSFER + BUS | –ê–≤–∏–∞ ‚Üí –ø–µ—Ä–µ—Å–∞–¥–∫–∞ (90 –º–∏–Ω) ‚Üí –∞–≤—Ç–æ–±—É—Å |
| 3 | –ú–æ—Å–∫–≤–∞ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö | PLANE + TRANSFER + FERRY | –ê–≤–∏–∞ ‚Üí –ø–µ—Ä–µ—Å–∞–¥–∫–∞ (90 –º–∏–Ω) ‚Üí –ø–µ—Ä–µ–ø—Ä–∞–≤–∞ (40 –º–∏–Ω) |
| 4 | –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –û–ª—ë–∫–º–∏–Ω—Å–∫ | PLANE + TRANSFER + BUS | –ê–≤–∏–∞ ‚Üí –ø–µ—Ä–µ—Å–∞–¥–∫–∞ (90 –º–∏–Ω) ‚Üí –∞–≤—Ç–æ–±—É—Å |
| 5 | –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –ú–∏—Ä–Ω—ã–π | PLANE + TRANSFER + BUS | –ê–≤–∏–∞ ‚Üí –ø–µ—Ä–µ—Å–∞–¥–∫–∞ (90 –º–∏–Ω) ‚Üí –∞–≤—Ç–æ–±—É—Å |
| 6 | –Ø–∫—É—Ç—Å–∫ ‚Üí –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö | FERRY | –ü–µ—Ä–µ–ø—Ä–∞–≤–∞, 40 –º–∏–Ω—É—Ç (–ª–µ—Ç–æ) –∏–ª–∏ 65 –º–∏–Ω—É—Ç (–∑–∏–º–∞) |
| 7 | –ú–æ—Å–∫–≤–∞ ‚Üí –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫ ‚Üí –Ø–∫—É—Ç—Å–∫ | PLANE + PLANE | –î–≤–∞ –∞–≤–∏–∞—Å–µ–≥–º–µ–Ω—Ç–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å –º–∞—Ä—à—Ä—É—Ç –ú–æ—Å–∫–≤–∞ ‚Üí –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫) |

### 9.2 –ß–µ–∫–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- [ ] **–Ø–∫—É—Ç—Å–∫ —Å–Ω–æ–≤–∞ –≤ –¥–∞–Ω–Ω—ã—Ö**
  - –ó–∞–ø—Ä–æ—Å: `GET /api/v1/routes/search?from=–Ø–∫—É—Ç—Å–∫&to=–û–ª—ë–∫–º–∏–Ω—Å–∫`
  - –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –ú–∞—Ä—à—Ä—É—Ç –Ω–∞–π–¥–µ–Ω, `fromCity = "–Ø–∫—É—Ç—Å–∫"`

- [ ] **–ù–µ—Ç –º—É—Å–æ—Ä–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤**
  - –ó–∞–ø—Ä–æ—Å –∫ –ë–î: `SELECT DISTINCT city_id FROM stops WHERE city_id LIKE '%—Ç—É–π–º–∞%'`
  - –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –ü—É—Å—Ç–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏–ª–∏ —Ç–æ–ª—å–∫–æ "–Ø–∫—É—Ç—Å–∫"

- [ ] **–ú–æ—Å–∫–≤–∞ –∏ –¥—Ä—É–≥–∏–µ –≥–æ—Ä–æ–¥–∞ —Å—Ç—Ä–æ—è—Ç –º–∞—Ä—à—Ä—É—Ç—ã**
  - –ó–∞–ø—Ä–æ—Å: `GET /api/v1/routes/search?from=–ú–æ—Å–∫–≤–∞&to=–Ø–∫—É—Ç—Å–∫`
  - –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –ú–∞—Ä—à—Ä—É—Ç –Ω–∞–π–¥–µ–Ω, `fromCity = "–ú–æ—Å–∫–≤–∞"`

- [ ] **–°–º–µ—à–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã —Å—Ç—Ä–æ—è—Ç—Å—è**
  - –ó–∞–ø—Ä–æ—Å: `GET /api/v1/routes/search?from=–ú–æ—Å–∫–≤–∞&to=–ß—É—Ä–∞–ø—á–∞`
  - –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –ú–∞—Ä—à—Ä—É—Ç –Ω–∞–π–¥–µ–Ω, —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–µ–≥–º–µ–Ω—Ç—ã PLANE + TRANSFER + BUS

- [ ] **–ü–µ—Ä–µ–ø—Ä–∞–≤–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç**
  - –ó–∞–ø—Ä–æ—Å: `GET /api/v1/routes/search?from=–Ø–∫—É—Ç—Å–∫&to=–ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö`
  - –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –ú–∞—Ä—à—Ä—É—Ç –Ω–∞–π–¥–µ–Ω, —Ç–∏–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ = FERRY

- [ ] **–ì—Ä–∞—Ñ –ø–æ–ª–æ–Ω –∏ —Å–≤—è–∑–µ–Ω**
  - –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≥—Ä–∞—Ñ–∞
  - –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: `isValid = true`, –Ω–µ—Ç –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —É–∑–ª–æ–≤

---

## 10. –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞

### 10.1 –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏

- **–ù–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤:** 9
- **–û–±–Ω–æ–≤–ª—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:** 10
- **–ù–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π:** 6
- **–ü–µ—Ä–µ–ø–∏—Å—ã–≤–∞–µ–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π:** 6
- **–ù–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤:** 8
- **–û–±—â–µ–µ –≤—Ä–µ–º—è:** 12-16 –¥–Ω–µ–π

### 10.2 –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

1. ‚úÖ –Ø–∫—É—Ç—Å–∫ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
2. ‚úÖ "–¢—É–π–º–∞–¥–∞" –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥
3. ‚úÖ –ú—É—Å–æ—Ä–Ω—ã–µ –∑–∞–ø–∏—Å–∏ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö
4. ‚úÖ 10 —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Å–∏—Å—Ç–µ–º–µ
5. ‚úÖ –ú–∞—Ä—à—Ä—É—Ç—ã –∏–∑ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ –≤ –Ø–∫—É—Ç–∏—é —Å—Ç—Ä–æ—è—Ç—Å—è
6. ‚úÖ –°–º–µ—à–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã (air + ground + ferry) —Å—Ç—Ä–æ—è—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
7. ‚úÖ –ü–µ—Ä–µ–ø—Ä–∞–≤–∞ –Ø–∫—É—Ç—Å–∫ ‚Üî –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ ferry-—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç
8. ‚úÖ –ü–µ—Ä–µ—Å–∞–¥–∫–∏ –º–µ–∂–¥—É —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞–º–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
9. ‚úÖ –ì—Ä–∞—Ñ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —É–∑–ª–æ–≤ –∏ –≤–µ—Å–æ–≤
10. ‚úÖ –°–∏—Å—Ç–µ–º–∞ —É—Å—Ç–æ–π—á–∏–≤–∞ –∫ –æ—à–∏–±–∫–∞–º, –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –æ—à–∏–±–∫–∏ –Ω–µ –≤–æ–∑–Ω–∏–∫–∞—é—Ç

### 10.3 –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏—è

| –†–∏—Å–∫ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –í–ª–∏—è–Ω–∏–µ | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|------|-------------|---------|-----------|
| –ö–æ–Ω—Ñ–ª–∏–∫—Ç TransportType (Route.ts vs RouteSegment.ts) | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–æ–µ | –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ enum |
| –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≥—Ä–∞—Ñ–∞ —Å –ø–µ—Ä–µ—Å–∞–¥–∫–∞–º–∏ | –ù–∏–∑–∫–∞—è | –°—Ä–µ–¥–Ω–µ–µ | –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ |
| –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ | –ù–∏–∑–∫–∞—è | –í—ã—Å–æ–∫–æ–µ | –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å, –º–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö |
| –û—à–∏–±–∫–∏ –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞—Ö | –°—Ä–µ–¥–Ω—è—è | –°—Ä–µ–¥–Ω–µ–µ | –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤, unit-—Ç–µ—Å—Ç—ã |

---

## 11. –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 11.1 –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- [x] –ê–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω
- [x] –ö–ª—é—á–µ–≤—ã–µ –∑–∞–¥–∞—á–∏ –≤—ã—è–≤–ª–µ–Ω—ã
- [x] –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
- [x] –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –Ω–∞–π–¥–µ–Ω—ã
- [x] –ü–ª–∞–Ω —Ä–∞–±–æ—Ç —Å–æ—Å—Ç–∞–≤–ª–µ–Ω
- [x] –ó–∞–¥–∞—á–∏ –¥–ª—è Cursor —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω—ã
- [x] –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω

### 11.2 –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥

**–ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–ª–∞–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º:**
1. –ù–∞—á–∞—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —Å Milestone 1 (–≠—Ç–∞–ø 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
2. –í—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–¥–∞—á–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ —Å–æ–≥–ª–∞—Å–Ω–æ —Ä–∞–∑–¥–µ–ª—É 6.1
3. –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞ –∑–∞–ø—É—Å–∫–∞—Ç—å —Ç–µ—Å—Ç—ã –∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å
4. –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ Milestone –ø—Ä–æ–≤–æ–¥–∏—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É

---

**–î–æ–∫—É–º–µ–Ω—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –û–∂–∏–¥–∞—é –∫–æ–º–∞–Ω–¥—ã "–ù–∞—á–∏–Ω–∞–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é" –¥–ª—è —Å—Ç–∞—Ä—Ç–∞ —Ä–∞–±–æ—Ç.**

**–ö–æ–Ω–µ—Ü –¥–æ–∫—É–º–µ–Ω—Ç–∞**