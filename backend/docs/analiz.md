# –ü–æ–ª–Ω—ã–π —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–ª–∞–Ω –¥–æ—Ä–∞–±–æ—Ç–æ–∫ –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤

**–î–∞—Ç–∞:** 2025-01-XX  
**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é  
**–û—Å–Ω–æ–≤–∞–Ω –Ω–∞:** –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Å–∏—Å—Ç–µ–º—ã –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –≥–æ—Ä–æ–¥–∞–º–∏](#1-–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-–ø—Ä–æ–±–ª–µ–º—ã-—Å-–≥–æ—Ä–æ–¥–∞–º–∏)
2. [–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ –†–§](#2-–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ-—Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö-–≥–æ—Ä–æ–¥–æ–≤-—Ä—Ñ)
3. [–ú–∞—Ä—à—Ä—É—Ç—ã –†–æ—Å—Å–∏—è ‚Üí –Ø–∫—É—Ç–∏—è](#3-–º–∞—Ä—à—Ä—É—Ç—ã-—Ä–æ—Å—Å–∏—è--—è–∫—É—Ç–∏—è)
4. [–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–ø—Ä–∞–≤—ã (FERRY)](#4-–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ-–ø–µ—Ä–µ–ø—Ä–∞–≤—ã-ferry)
5. [–£–ª—É—á—à–µ–Ω–∏–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∞](#5-—É–ª—É—á—à–µ–Ω–∏–µ-–ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è-–≥—Ä–∞—Ñ–∞)
6. [–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–æ—Ä–∫–µ—Ä–æ–≤ –∏ –∏—Ö –ø–æ—Ä—è–¥–æ–∫](#6-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ-–≤–æ—Ä–∫–µ—Ä–æ–≤-–∏-–∏—Ö-–ø–æ—Ä—è–¥–æ–∫)
7. [–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã](#7-–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ-–º–∞—Ä—à—Ä—É—Ç—ã)
8. [–ö–æ–Ω–µ—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç](#8-–∫–æ–Ω–µ—á–Ω—ã–π-—Ä–µ–∑—É–ª—å—Ç–∞—Ç)

---

## 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –≥–æ—Ä–æ–¥–∞–º–∏

### 1.1 –ü—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ —Ä–µ—à–∏—Ç—å

#### –ü—Ä–æ–±–ª–µ–º–∞ 1.1: –ò—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏–µ "–Ø–∫—É—Ç—Å–∫"
- **–°–∏–º–ø—Ç–æ–º:** "–ê—ç—Ä–æ–ø–æ—Ä—Ç –Ø–∫—É—Ç—Å–∫ (–¢—É–π–º–∞–∞–¥–∞)" ‚Üí –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è "–¢—É–π–º–∞–∞–¥–∞" –≤–º–µ—Å—Ç–æ "–Ø–∫—É—Ç—Å–∫"
- **–ü—Ä–∏—á–∏–Ω–∞:** `extractCityFromStopName()` –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω "–ê—ç—Ä–æ–ø–æ—Ä—Ç [–ì–æ—Ä–æ–¥] ([–ê—ç—Ä–æ–ø–æ—Ä—Ç])"
- **–í–ª–∏—è–Ω–∏–µ:** –Ø–∫—É—Ç—Å–∫ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø—Ä–∏ –ø–æ–∏—Å–∫–µ, –º–∞—Ä—à—Ä—É—Ç—ã –Ω–µ —Å—Ç—Ä–æ—è—Ç—Å—è

#### –ü—Ä–æ–±–ª–µ–º–∞ 1.2: –ü–æ—è–≤–ª–µ–Ω–∏–µ –ª–æ–∂–Ω–æ–≥–æ "–¢—É–π–º–∞–¥–∞"
- **–°–∏–º–ø—Ç–æ–º:** "–¢—É–π–º–∞–∞–¥–∞" —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥ –≤ –ë–î
- **–ü—Ä–∏—á–∏–Ω–∞:** –¢–∞ –∂–µ, —á—Ç–æ –≤ 1.1
- **–í–ª–∏—è–Ω–∏–µ:** –ú—É—Å–æ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –ë–î, –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π

#### –ü—Ä–æ–±–ª–µ–º–∞ 1.3: –ú—É—Å–æ—Ä–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ –∏–∑ OData
- **–°–∏–º–ø—Ç–æ–º:** –ì–æ—Ä–æ–¥–∞ "—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è", "–≥–ª–∞–≤–Ω—ã–π", "–ø–∞—Å—Å–∞–∂–∏—Ä—Å–∫–∏–π" –∏ —Ç.–¥.
- **–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ –ë–î
- **–í–ª–∏—è–Ω–∏–µ:** –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –≥—Ä–∞—Ñ–µ, –æ—à–∏–±–∫–∏ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ

#### –ü—Ä–æ–±–ª–µ–º–∞ 1.4: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–≥–æ—Ä–æ–¥–æ–≤
- **–°–∏–º–ø—Ç–æ–º:** "–ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö" –Ω–µ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç—Å—è –≤ "–Ø–∫—É—Ç—Å–∫"
- **–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ—Ç —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –ø—Ä–∏–≥–æ—Ä–æ–¥–æ–≤
- **–í–ª–∏—è–Ω–∏–µ:** –ü—Ä–∏–≥–æ—Ä–æ–¥—ã –ø–æ—è–≤–ª—è—é—Ç—Å—è –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞

### 1.2 –ü–ª–∞–Ω —Ä–µ—à–µ–Ω–∏—è

#### –®–∞–≥ 1.1: –°–æ–∑–¥–∞–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏

**–§–∞–π–ª:** `backend/data/reference/airports-reference.json` (–ù–û–í–´–ô)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:**
```json
{
  "version": "1.0.0",
  "airports": [
    {
      "name": "–¢—É–π–º–∞–∞–¥–∞",
      "city": "–Ø–∫—É—Ç—Å–∫",
      "aliases": ["–¢—É–π–º–∞–¥–∞", "Yakutsk Airport", "YKS"],
      "normalizedName": "—Ç—É–π–º–∞–∞–¥–∞"
    },
    {
      "name": "–®–µ—Ä–µ–º–µ—Ç—å–µ–≤–æ",
      "city": "–ú–æ—Å–∫–≤–∞",
      "aliases": ["SVO", "Sheremetyevo"],
      "normalizedName": "—à–µ—Ä–µ–º–µ—Ç—å–µ–≤–æ"
    },
    // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∞—ç—Ä–æ–ø–æ—Ä—Ç—ã
  ]
}
```

**–í–∫–ª—é—á–∏—Ç—å –∞—ç—Ä–æ–ø–æ—Ä—Ç—ã:**
- –¢—É–π–º–∞–∞–¥–∞ ‚Üí –Ø–∫—É—Ç—Å–∫
- –®–µ—Ä–µ–º–µ—Ç—å–µ–≤–æ ‚Üí –ú–æ—Å–∫–≤–∞
- –î–æ–º–æ–¥–µ–¥–æ–≤–æ ‚Üí –ú–æ—Å–∫–≤–∞
- –í–Ω—É–∫–æ–≤–æ ‚Üí –ú–æ—Å–∫–≤–∞
- –ü—É–ª–∫–æ–≤–æ ‚Üí –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥
- –¢–æ–ª–º–∞—á—ë–≤–æ ‚Üí –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫
- –ï–º–µ–ª—å—è–Ω–æ–≤–æ ‚Üí –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫
- –ö–æ–ª—å—Ü–æ–≤–æ ‚Üí –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥

**–§–∞–π–ª:** `backend/data/reference/suburbs-reference.json` (–ù–û–í–´–ô)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:**
```json
{
  "version": "1.0.0",
  "suburbs": [
    {
      "name": "–ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö",
      "mainCity": "–Ø–∫—É—Ç—Å–∫",
      "type": "ferry_terminal",
      "normalizedName": "–Ω–∏–∂–Ω–∏–π –±–µ—Å—Ç—è—Ö"
    },
    {
      "name": "–ë–µ—Ä–∫–∞–∫–∏—Ç",
      "mainCity": "–ù–µ—Ä—é–Ω–≥—Ä–∏",
      "type": "railway_station",
      "normalizedName": "–±–µ—Ä–∫–∞–∫–∏—Ç"
    }
  ]
}
```

#### –®–∞–≥ 1.2: –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑—á–∏–∫–æ–≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤

**–§–∞–π–ª:** `backend/src/shared/utils/airports-loader.ts` (–ù–û–í–´–ô)

**–§—É–Ω–∫—Ü–∏–∏:**
- `loadAirportsReference(): Map<string, string>`
  - –ó–∞–≥—Ä—É–∂–∞–µ—Ç `airports-reference.json`
  - –°–æ–∑–¥–∞–µ—Ç Map: –∫–ª—é—á = –Ω–∞–∑–≤–∞–Ω–∏–µ –∞—ç—Ä–æ–ø–æ—Ä—Ç–∞ (–≤–∫–ª—é—á–∞—è aliases), –∑–Ω–∞—á–µ–Ω–∏–µ = –≥–æ—Ä–æ–¥
  - –ö—ç—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç (singleton pattern)
- `getCityByAirportName(airportName: string): string | undefined`
  - –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –∞—ç—Ä–æ–ø–æ—Ä—Ç–∞ (toLowerCase, trim)
  - –ò—â–µ—Ç –≤ Map –ø–æ –∫–ª—é—á—É
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≥–æ—Ä–æ–¥ –∏–ª–∏ undefined

**–§–∞–π–ª:** `backend/src/shared/utils/suburbs-loader.ts` (–ù–û–í–´–ô)

**–§—É–Ω–∫—Ü–∏–∏:**
- `loadSuburbsReference(): Map<string, string>`
  - –ó–∞–≥—Ä—É–∂–∞–µ—Ç `suburbs-reference.json`
  - –°–æ–∑–¥–∞–µ—Ç Map: –∫–ª—é—á = –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–≥–æ—Ä–æ–¥–∞, –∑–Ω–∞—á–µ–Ω–∏–µ = –æ—Å–Ω–æ–≤–Ω–æ–π –≥–æ—Ä–æ–¥
  - –ö—ç—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç (singleton pattern)
- `getMainCityBySuburb(suburbName: string): string | undefined`
  - –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–≥–æ—Ä–æ–¥–∞ (toLowerCase, trim)
  - –ò—â–µ—Ç –≤ Map –ø–æ –∫–ª—é—á—É
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –≥–æ—Ä–æ–¥ –∏–ª–∏ undefined

#### –®–∞–≥ 1.3: –°–æ–∑–¥–∞–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–∞ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫

**–§–∞–π–ª:** `backend/src/shared/validators/stop-validator.ts` (–ù–û–í–´–ô)

**–§—É–Ω–∫—Ü–∏–∏:**
- `validateStopData(stopData: any): ValidationResult`
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ `name`: –Ω–µ –ø—É—Å—Ç–æ–π, –¥–ª–∏–Ω–∞ >= 3 —Å–∏–º–≤–æ–ª–æ–≤, –Ω–µ —Ç–æ–ª—å–∫–æ –ø—Ä–æ–±–µ–ª—ã
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ `latitude`: —á–∏—Å–ª–æ, –¥–∏–∞–ø–∞–∑–æ–Ω [-90, 90], –Ω–µ NaN, –Ω–µ Infinity
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ `longitude`: —á–∏—Å–ª–æ, –¥–∏–∞–ø–∞–∑–æ–Ω [-180, 180], –Ω–µ NaN, –Ω–µ Infinity
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ `cityId`: –Ω–µ –ø—É—Å—Ç–æ–π, –Ω–µ —Å–ª—É–∂–µ–±–Ω–æ–µ —Å–ª–æ–≤–æ (—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è, –≥–ª–∞–≤–Ω—ã–π, –ø–∞—Å—Å–∞–∂–∏—Ä—Å–∫–∏–π, —Ç—É–π–º–∞–∞–¥–∞ –∏ —Ç.–¥.)
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `{ isValid: boolean, errors: string[] }`

**–°–ø–∏—Å–æ–∫ —Å–ª—É–∂–µ–±–Ω—ã—Ö —Å–ª–æ–≤ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:**
- —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è, –≥–ª–∞–≤–Ω—ã–π, –ø–∞—Å—Å–∞–∂–∏—Ä—Å–∫–∏–π, –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π, –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π
- —Ç—É–π–º–∞–∞–¥–∞, —Ç—É–π–º–∞–¥–∞ (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ –Ø–∫—É—Ç—Å–∫ —á–µ—Ä–µ–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫)

#### –®–∞–≥ 1.4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `extractCityFromStopName()`

**–§–∞–π–ª:** `backend/src/shared/utils/city-normalizer.ts`

**–§—É–Ω–∫—Ü–∏—è:** `extractCityFromStopName(stopName?: string, address?: string): string`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
1. **–î–æ–±–∞–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç:** `getCityByAirportName` –∏–∑ `airports-loader.ts`

2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ "–ê—ç—Ä–æ–ø–æ—Ä—Ç [–ì–æ—Ä–æ–¥] ([–ê—ç—Ä–æ–ø–æ—Ä—Ç])":**
   - –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ: `/–ê—ç—Ä–æ–ø–æ—Ä—Ç\s+([–ê-–Ø–∞-—è–Å—ë\-\s]+)\s*\(([^)]+)\)/i`
   - –ò–∑–≤–ª–µ—á—å –Ω–∞–∑–≤–∞–Ω–∏–µ –∞—ç—Ä–æ–ø–æ—Ä—Ç–∞ –∏–∑ —Å–∫–æ–±–æ–∫ (–≥—Ä—É–ø–ø–∞ 2)
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ `getCityByAirportName(airportName)`
   - –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ ‚Üí –≤–µ—Ä–Ω—É—Ç—å –≥–æ—Ä–æ–¥ –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
   - –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ ‚Üí –∏–∑–≤–ª–µ—á—å –≥–æ—Ä–æ–¥ –∏–∑ —á–∞—Å—Ç–∏ –î–û —Å–∫–æ–±–æ–∫ (–≥—Ä—É–ø–ø–∞ 1)

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ "–ê—ç—Ä–æ–ø–æ—Ä—Ç [–ì–æ—Ä–æ–¥]" (–±–µ–∑ —Å–∫–æ–±–æ–∫):**
   - –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ: `/–ê—ç—Ä–æ–ø–æ—Ä—Ç\s+([–ê-–Ø–∞-—è–Å—ë\-\s]+)/i`
   - –ò–∑–≤–ª–µ—á—å –≥–æ—Ä–æ–¥ –∏–∑ —á–∞—Å—Ç–∏ –ø–æ—Å–ª–µ —Å–ª–æ–≤–∞ "–ê—ç—Ä–æ–ø–æ—Ä—Ç" (–≥—Ä—É–ø–ø–∞ 1)
   - –í–µ—Ä–Ω—É—Ç—å –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–π –≥–æ—Ä–æ–¥

4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ "–ê—ç—Ä–æ–ø–æ—Ä—Ç [–ì–æ—Ä–æ–¥] [–ù–∞–∑–≤–∞–Ω–∏–µ –∞—ç—Ä–æ–ø–æ—Ä—Ç–∞]":**
   - –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ: `/–ê—ç—Ä–æ–ø–æ—Ä—Ç\s+([–ê-–Ø–∞-—è–Å—ë\-\s]+)\s+([–ê-–Ø–∞-—è–Å—ë\-\s]+)/i`
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Ç–æ—Ä–æ–µ —Å–ª–æ–≤–æ —á–µ—Ä–µ–∑ `getCityByAirportName()`
   - –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ ‚Üí –≤–µ—Ä–Ω—É—Ç—å –≥–æ—Ä–æ–¥ –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
   - –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ ‚Üí –≤–µ—Ä–Ω—É—Ç—å –ø–µ—Ä–≤–æ–µ —Å–ª–æ–≤–æ (–≥–æ—Ä–æ–¥)

5. **–°—É—â–µ—Å—Ç–≤—É—é—â–∞—è –ª–æ–≥–∏–∫–∞:** –û—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ fallback –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤

**–ü—Ä–∏–º–µ—Ä—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏:**
- "–ê—ç—Ä–æ–ø–æ—Ä—Ç –Ø–∫—É—Ç—Å–∫ (–¢—É–π–º–∞–∞–¥–∞)" ‚Üí "–Ø–∫—É—Ç—Å–∫" (—á–µ—Ä–µ–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫)
- "–ê—ç—Ä–æ–ø–æ—Ä—Ç –ú–æ—Å–∫–≤–∞ –®–µ—Ä–µ–º–µ—Ç—å–µ–≤–æ" ‚Üí "–ú–æ—Å–∫–≤–∞" (—á–µ—Ä–µ–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫)
- "–ê—ç—Ä–æ–ø–æ—Ä—Ç –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫ –¢–æ–ª–º–∞—á—ë–≤–æ" ‚Üí "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫" (—á–µ—Ä–µ–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫)
- "–ê—ç—Ä–æ–ø–æ—Ä—Ç –Ø–∫—É—Ç—Å–∫" ‚Üí "–Ø–∫—É—Ç—Å–∫" (–∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–∞)

#### –®–∞–≥ 1.5: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `ODataSyncWorker.parseODataResponse()`

**–§–∞–π–ª:** `backend/src/application/workers/ODataSyncWorker.ts`

**–ú–µ—Ç–æ–¥:** `parseODataResponse(response: ODataResponse)`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
1. **–î–æ–±–∞–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã:**
   - `getCityByAirportName` –∏–∑ `airports-loader.ts`
   - `getMainCityBySuburb` –∏–∑ `suburbs-loader.ts`
   - `validateStopData` –∏–∑ `stop-validator.ts`
   - `isCityInUnifiedReference` –∏–∑ `unified-cities-loader.ts` (–ø–æ–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ yakutia)

2. **–û–±–Ω–æ–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫:**
   - –ü–æ—Å–ª–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è `cityName` —á–µ—Ä–µ–∑ `extractCityFromStopName()`:
     - **–®–∞–≥ 1:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ `getMainCityBySuburb(cityName)` ‚Üí –µ—Å–ª–∏ –ø—Ä–∏–≥–æ—Ä–æ–¥, –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `mainCity`
     - **–®–∞–≥ 2:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ `getCityByAirportName(cityName)` ‚Üí –µ—Å–ª–∏ –∞—ç—Ä–æ–ø–æ—Ä—Ç, –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –≥–æ—Ä–æ–¥
     - **–®–∞–≥ 3:** –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å `cityName` —á–µ—Ä–µ–∑ `normalizeCityName()`
     - **–®–∞–≥ 4:** –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ `validateStopData(stopData)` ‚Üí –µ—Å–ª–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ, –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
     - **–®–∞–≥ 5:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π `cityName` –µ—Å—Ç—å –≤ unified-reference (–ø–æ–∫–∞ —Ç–æ–ª—å–∫–æ yakutia, –ø–æ—Ç–æ–º –æ–±–Ω–æ–≤–∏–º)

3. **–î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:**
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∞–ª–∏–¥–Ω—ã—Ö –æ—Å—Ç–∞–Ω–æ–≤–æ–∫
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ (—Å –ø—Ä–∏—á–∏–Ω–∞–º–∏)
   - –°–ø–∏—Å–æ–∫ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
   - –°–ø–∏—Å–æ–∫ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ (–ø—Ä–∏–≥–æ—Ä–æ–¥ ‚Üí –æ—Å–Ω–æ–≤–Ω–æ–π –≥–æ—Ä–æ–¥, –∞—ç—Ä–æ–ø–æ—Ä—Ç ‚Üí –≥–æ—Ä–æ–¥)

**–ü—Ä–∏–º–µ—Ä—ã –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏:**
- "–ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö" ‚Üí "–Ø–∫—É—Ç—Å–∫" (—á–µ—Ä–µ–∑ suburbs-reference)
- "–ë–µ—Ä–∫–∞–∫–∏—Ç" ‚Üí "–ù–µ—Ä—é–Ω–≥—Ä–∏" (—á–µ—Ä–µ–∑ suburbs-reference)
- "–¢—É–π–º–∞–∞–¥–∞" ‚Üí "–Ø–∫—É—Ç—Å–∫" (—á–µ—Ä–µ–∑ airports-reference)
- "—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è" ‚Üí –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å (—á–µ—Ä–µ–∑ stop-validator)

### 1.3 –§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è

1. `backend/data/reference/airports-reference.json`
2. `backend/data/reference/suburbs-reference.json`
3. `backend/src/shared/utils/airports-loader.ts`
4. `backend/src/shared/utils/suburbs-loader.ts`
5. `backend/src/shared/validators/stop-validator.ts`

### 1.4 –§–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

1. `backend/src/shared/utils/city-normalizer.ts` - —Ñ—É–Ω–∫—Ü–∏—è `extractCityFromStopName()`
2. `backend/src/application/workers/ODataSyncWorker.ts` - –º–µ—Ç–æ–¥ `parseODataResponse()`

### 1.5 –¢–µ—Å—Ç—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

1. `backend/src/__tests__/unit/utils/airports-loader.test.ts` (–ù–û–í–´–ô)
2. `backend/src/__tests__/unit/utils/suburbs-loader.test.ts` (–ù–û–í–´–ô)
3. `backend/src/__tests__/unit/validators/stop-validator.test.ts` (–ù–û–í–´–ô)
4. `backend/src/__tests__/unit/utils/city-normalizer.test.ts` (–û–ë–ù–û–í–ò–¢–¨)
5. `backend/src/__tests__/unit/workers/ODataSyncWorker.test.ts` (–û–ë–ù–û–í–ò–¢–¨)

---

## 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ –†–§

### 2.1 –°–ø–∏—Å–æ–∫ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤

1. –ú–æ—Å–∫–≤–∞
2. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥
3. –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫
4. –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫
5. –ò—Ä–∫—É—Ç—Å–∫
6. –•–∞–±–∞—Ä–æ–≤—Å–∫
7. –í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫
8. –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥
9. –ö–∞–∑–∞–Ω—å
10. –ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥

### 2.2 –ü–ª–∞–Ω –¥–æ–±–∞–≤–ª–µ–Ω–∏—è

#### –®–∞–≥ 2.1: –°–æ–∑–¥–∞–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤

**–§–∞–π–ª:** `backend/data/reference/russia-federal-cities-reference.json` (–ù–û–í–´–ô)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:**
```json
{
  "version": "1.0.0",
  "cities": [
    {
      "name": "–ú–æ—Å–∫–≤–∞",
      "normalizedName": "–º–æ—Å–∫–≤–∞",
      "latitude": 55.7558,
      "longitude": 37.6173,
      "region": "Central",
      "isKeyCity": true,
      "isFederalCity": true,
      "airports": ["–®–µ—Ä–µ–º–µ—Ç—å–µ–≤–æ", "–î–æ–º–æ–¥–µ–¥–æ–≤–æ", "–í–Ω—É–∫–æ–≤–æ"]
    },
    {
      "name": "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
      "normalizedName": "—Å–∞–Ω–∫—Ç-–ø–µ—Ç–µ—Ä–±—É—Ä–≥",
      "latitude": 59.9343,
      "longitude": 30.3351,
      "region": "Northwest",
      "isKeyCity": true,
      "isFederalCity": true,
      "airports": ["–ü—É–ª–∫–æ–≤–æ"]
    },
    // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ 8 –≥–æ—Ä–æ–¥–æ–≤
  ]
}
```

**–î–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–æ—Ä–æ–¥–∞ —É–∫–∞–∑–∞—Ç—å:**
- `name`: –ü–æ–ª–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞
- `normalizedName`: –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ (lowercase, –±–µ–∑ –¥–µ—Ñ–∏—Å–æ–≤)
- `latitude`, `longitude`: –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–∞ –≥–æ—Ä–æ–¥–∞
- `region`: –†–µ–≥–∏–æ–Ω (Central, Northwest, Siberia, FarEast, Ural, Volga)
- `isKeyCity`: true (–≤—Å–µ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ - –∫–ª—é—á–µ–≤—ã–µ)
- `isFederalCity`: true
- `airports`: –ú–∞—Å—Å–∏–≤ –Ω–∞–∑–≤–∞–Ω–∏–π –∞—ç—Ä–æ–ø–æ—Ä—Ç–æ–≤ (–¥–ª—è —Å–≤—è–∑–∏ —Å airports-reference.json)

#### –®–∞–≥ 2.2: –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–æ–≥–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞

**–§–∞–π–ª:** `backend/src/shared/utils/unified-cities-loader.ts` (–ù–û–í–´–ô)

**–¢–∏–ø –¥–∞–Ω–Ω—ã—Ö:**
```typescript
interface UnifiedCity {
  name: string;
  normalizedName: string;
  latitude: number;
  longitude: number;
  region: string;
  isKeyCity: boolean;
  isFederalCity: boolean;
  airports?: string[];
}
```

**–§—É–Ω–∫—Ü–∏–∏:**
- `loadUnifiedCitiesReference(): Map<string, UnifiedCity>`
  - –ó–∞–≥—Ä—É–∂–∞–µ—Ç `yakutia-cities-reference.json`
  - –ó–∞–≥—Ä—É–∂–∞–µ—Ç `russia-federal-cities-reference.json`
  - –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤ –µ–¥–∏–Ω—ã–π Map —Å –∫–ª—é—á–æ–º `normalizedName`
  - –ö—ç—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç (singleton pattern)
- `getUnifiedCity(cityName: string): UnifiedCity | undefined`
  - –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞
  - –ò—â–µ—Ç –≤ Map –ø–æ –∫–ª—é—á—É
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≥–æ—Ä–æ–¥ –∏–ª–∏ undefined
- `isCityInUnifiedReference(cityName: string): boolean`
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –≥–æ—Ä–æ–¥–∞ –≤ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–æ–º —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ ODataSyncWorker
- `getAllFederalCities(): UnifiedCity[]`
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ (—Ñ–∏–ª—å—Ç—Ä –ø–æ `isFederalCity: true`)
- `getAllYakutiaCities(): UnifiedCity[]`
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ –≥–æ—Ä–æ–¥–∞ –Ø–∫—É—Ç–∏–∏ (—Ñ–∏–ª—å—Ç—Ä –ø–æ `isFederalCity: false` –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—é –ø–æ–ª—è)

#### –®–∞–≥ 2.3: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `ODataSyncWorker` –¥–ª—è unified-reference

**–§–∞–π–ª:** `backend/src/application/workers/ODataSyncWorker.ts`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç `isCityInUnifiedReference` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è unified-reference (–≤–º–µ—Å—Ç–æ —Ç–æ–ª—å–∫–æ yakutia)
- –¢–µ–ø–µ—Ä—å –≤–∞–ª–∏–¥–∞—Ü–∏—è –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≥–æ—Ä–æ–¥–∞ –∏ –≤ –Ø–∫—É—Ç–∏–∏, –∏ –≤ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–∞—Ö

#### –®–∞–≥ 2.4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `VirtualEntitiesGeneratorWorker`

**–§–∞–π–ª:** `backend/src/application/workers/VirtualEntitiesGeneratorWorker.ts`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
1. **–ò–º–ø–æ—Ä—Ç—ã:**
   - –£–¥–∞–ª–∏—Ç—å: `getAllYakutiaCities`, `getYakutiaCitiesDirectory` –∏–∑ `yakutia-cities-loader.ts`
   - –î–æ–±–∞–≤–∏—Ç—å: `getAllFederalCities`, `getAllYakutiaCities`, `isCityInUnifiedReference` –∏–∑ `unified-cities-loader.ts`

2. **–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä:**
   - –£–¥–∞–ª–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä `citiesDirectory: CityCoordinates`
   - –ó–∞–≥—Ä—É–∂–∞—Ç—å –≥–æ—Ä–æ–¥–∞ —á–µ—Ä–µ–∑ `getAllYakutiaCities()` + `getAllFederalCities()` –≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Å–∞

3. **–ú–µ—Ç–æ–¥ `generateVirtualStops()`:**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `getAllFederalCities()` + `getAllYakutiaCities()` –≤–º–µ—Å—Ç–æ `this.citiesDirectory`
   - –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏:
     - –ì–æ—Ä–æ–¥ –µ—Å—Ç—å –≤ unified-reference (–ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ `isCityInUnifiedReference()`)
     - –ù–µ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ –≤ –ë–î –¥–ª—è —ç—Ç–æ–≥–æ –≥–æ—Ä–æ–¥–∞
     - `isKeyCity: true`

4. **–ú–µ—Ç–æ–¥ `ensureYakutiaCitiesConnectivity()` ‚Üí –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –≤ `ensureCitiesConnectivity()`:**
   - –û–±–Ω–æ–≤–∏—Ç—å –ª–æ–≥–∏–∫—É:
     - –î–ª—è –ø–∞—Ä **—Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥ ‚Üí –≥–æ—Ä–æ–¥ –Ø–∫—É—Ç–∏–∏**: —Å–æ–∑–¥–∞–≤–∞—Ç—å hub-based –º–∞—Ä—à—Ä—É—Ç—ã —á–µ—Ä–µ–∑ –Ø–∫—É—Ç—Å–∫
       - –ú–∞—Ä—à—Ä—É—Ç 1: —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥ ‚Üí –Ø–∫—É—Ç—Å–∫ (PLANE, 240 –º–∏–Ω, 2000 –∫–º)
       - –ú–∞—Ä—à—Ä—É—Ç 2: –Ø–∫—É—Ç—Å–∫ ‚Üí –≥–æ—Ä–æ–¥ –Ø–∫—É—Ç–∏–∏ (BUS, 180 –º–∏–Ω, 200 –∫–º)
     - –î–ª—è –ø–∞—Ä **—Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥ ‚Üí —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥**: —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø—Ä—è–º—ã–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã (PLANE, 180 –º–∏–Ω, 1500 –∫–º)
     - –î–ª—è –ø–∞—Ä **–≥–æ—Ä–æ–¥ –Ø–∫—É—Ç–∏–∏ ‚Üí –≥–æ—Ä–æ–¥ –Ø–∫—É—Ç–∏–∏**: –æ—Å—Ç–∞–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –ª–æ–≥–∏–∫—É

#### –®–∞–≥ 2.5: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `initializeWorkers.ts`

**–§–∞–π–ª:** `backend/src/infrastructure/workers/initializeWorkers.ts`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫—É: `const yakutiaCitiesDirectory = getYakutiaCitiesDirectory();`
- –û–±–Ω–æ–≤–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ `VirtualEntitiesGeneratorWorker`: —É–±—Ä–∞—Ç—å –ø–µ—Ä–µ–¥–∞—á—É `yakutiaCitiesDirectory` –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä

### 2.3 –§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è

1. `backend/data/reference/russia-federal-cities-reference.json`
2. `backend/src/shared/utils/unified-cities-loader.ts`

### 2.4 –§–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

1. `backend/src/application/workers/ODataSyncWorker.ts` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ unified-reference
2. `backend/src/application/workers/VirtualEntitiesGeneratorWorker.ts` - unified-cities-loader, `ensureCitiesConnectivity()`
3. `backend/src/infrastructure/workers/initializeWorkers.ts` - —É–¥–∞–ª–µ–Ω–∏–µ yakutiaCitiesDirectory

### 2.5 –¢–µ—Å—Ç—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

1. `backend/src/__tests__/unit/utils/unified-cities-loader.test.ts` (–ù–û–í–´–ô)
2. `backend/src/__tests__/unit/workers/VirtualEntitiesGeneratorWorker.test.ts` (–û–ë–ù–û–í–ò–¢–¨)
3. `backend/src/__tests__/unit/workers/ODataSyncWorker.test.ts` (–û–ë–ù–û–í–ò–¢–¨)

---

## 3. –ú–∞—Ä—à—Ä—É—Ç—ã –†–æ—Å—Å–∏—è ‚Üí –Ø–∫—É—Ç–∏—è

### 3.1 –¢—Ä–µ–±—É–µ–º—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã

1. –ú–æ—Å–∫–≤–∞ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö (–∞–≤–∏–∞ ‚Üí –ø–µ—Ä–µ–ø—Ä–∞–≤–∞)
2. –ú–æ—Å–∫–≤–∞ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –ß—É—Ä–∞–ø—á–∞ (–∞–≤–∏–∞ ‚Üí –∞–≤—Ç–æ–±—É—Å)
3. –ú–æ—Å–∫–≤–∞ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –ª—é–±–æ–π –≥–æ—Ä–æ–¥ –Ø–∫—É—Ç–∏–∏ (hub-based)
4. –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –û–ª—ë–∫–º–∏–Ω—Å–∫ (–∞–≤–∏–∞ ‚Üí –∞–≤—Ç–æ–±—É—Å)
5. –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –ú–∏—Ä–Ω—ã–π (–∞–≤–∏–∞ ‚Üí –∞–≤—Ç–æ–±—É—Å)

### 3.2 –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

#### –®–∞–≥ 3.1: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ mock-–¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤

**–§–∞–π–ª:** `backend/data/mock/stops.json`

**–î–æ–±–∞–≤–∏—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–∫–∏:**
- `stop-030`: "–ê—ç—Ä–æ–ø–æ—Ä—Ç –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫ –¢–æ–ª–º–∞—á—ë–≤–æ" (55.0084, 82.9357, airport, cityId: "–Ω–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫")
- `stop-031`: "–ê—ç—Ä–æ–ø–æ—Ä—Ç –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫ –ï–º–µ–ª—å—è–Ω–æ–≤–æ" (56.0089, 92.8537, airport, cityId: "–∫—Ä–∞—Å–Ω–æ—è—Ä—Å–∫")
- `stop-032`: "–ê—ç—Ä–æ–ø–æ—Ä—Ç –•–∞–±–∞—Ä–æ–≤—Å–∫" (48.4802, 135.0719, airport, cityId: "—Ö–∞–±–∞—Ä–æ–≤—Å–∫")
- `stop-033`: "–ê—ç—Ä–æ–ø–æ—Ä—Ç –í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫" (43.1155, 131.8855, airport, cityId: "–≤–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫")
- `stop-034`: "–ê—ç—Ä–æ–ø–æ—Ä—Ç –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥ –ö–æ–ª—å—Ü–æ–≤–æ" (56.8431, 60.6454, airport, cityId: "–µ–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥")
- `stop-035`: "–ê—ç—Ä–æ–ø–æ—Ä—Ç –ö–∞–∑–∞–Ω—å" (55.8304, 49.0661, airport, cityId: "–∫–∞–∑–∞–Ω—å")
- `stop-036`: "–ê—ç—Ä–æ–ø–æ—Ä—Ç –ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥ –°—Ç—Ä–∏–≥–∏–Ω–æ" (56.2965, 43.9361, airport, cityId: "–Ω–∏–∂–Ω–∏–π –Ω–æ–≤–≥–æ—Ä–æ–¥")

**–§–∞–π–ª:** `backend/data/mock/routes.json`

**–î–æ–±–∞–≤–∏—Ç—å –∞–≤–∏–∞–º–∞—Ä—à—Ä—É—Ç—ã:**
- `route-030`: "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫ - –Ø–∫—É—Ç—Å–∫ (–ê–≤–∏–∞)"
  - fromStopId: `stop-030`, toStopId: `stop-001` (–Ø–∫—É—Ç—Å–∫)
  - transportType: `PLANE`
  - durationMinutes: 240
  - distanceKm: 2800
  - baseFare: 15000
- `route-031`: "–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫ - –Ø–∫—É—Ç—Å–∫ (–ê–≤–∏–∞)"
  - fromStopId: `stop-031`, toStopId: `stop-001`
  - transportType: `PLANE`
  - durationMinutes: 180
  - distanceKm: 2200
  - baseFare: 12000
- `route-032`: "–•–∞–±–∞—Ä–æ–≤—Å–∫ - –Ø–∫—É—Ç—Å–∫ (–ê–≤–∏–∞)"
  - fromStopId: `stop-032`, toStopId: `stop-001`
  - transportType: `PLANE`
  - durationMinutes: 300
  - distanceKm: 3200
  - baseFare: 18000

**–§–∞–π–ª:** `backend/data/mock/flights.json`

**–î–æ–±–∞–≤–∏—Ç—å —Ä–µ–π—Å—ã –¥–ª—è –Ω–æ–≤—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤:**
- –ï–∂–µ–¥–Ω–µ–≤–Ω–æ, 2-3 —Ä–µ–π—Å–∞ –≤ –¥–µ–Ω—å: 08:00, 14:00, 20:00
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞ —Å–æ–∑–¥–∞—Ç—å —Ä–µ–π—Å—ã –Ω–∞ –±–ª–∏–∂–∞–π—à–∏–µ 30 –¥–Ω–µ–π

#### –®–∞–≥ 3.2: –°–æ–∑–¥–∞–Ω–∏–µ `AirRouteGeneratorWorker`

**–§–∞–π–ª:** `backend/src/application/workers/AirRouteGeneratorWorker.ts` (–ù–û–í–´–ô)

**–ö–ª–∞—Å—Å:** `AirRouteGeneratorWorker extends BaseBackgroundWorker`

**–ú–µ—Ç–æ–¥—ã:**
- `canRun(): Promise<boolean>`
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ dataset
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ ODataSyncWorker —É–∂–µ –≤—ã–ø–æ–ª–Ω–∏–ª—Å—è
- `executeWorkerLogic(): Promise<WorkerExecutionResult>`
  1. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ –∏–∑ unified-reference —á–µ—Ä–µ–∑ `getAllFederalCities()`
  2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞:
     - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∞–≤–∏–∞–º–∞—Ä—à—Ä—É—Ç–∞ –≤ –ë–î (–Ø–∫—É—Ç—Å–∫ ‚Üî —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥)
     - –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí —Å–æ–∑–¥–∞–µ—Ç –º–∞—Ä—à—Ä—É—Ç:
       - –ü—Ä—è–º–æ–π: —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥ ‚Üí –Ø–∫—É—Ç—Å–∫ (PLANE, 240 –º–∏–Ω, 2000 –∫–º)
       - –û–±—Ä–∞—Ç–Ω—ã–π: –Ø–∫—É—Ç—Å–∫ ‚Üí —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥ (PLANE, 240 –º–∏–Ω, 2000 –∫–º)
     - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–µ–π—Å—ã –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–æ–≤ (–µ–∂–µ–¥–Ω–µ–≤–Ω–æ, 2-3 —Ä–µ–π—Å–∞: 08:00, 14:00, 20:00)
  3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –º–∞—Ä—à—Ä—É—Ç—ã –∏ —Ä–µ–π—Å—ã –≤ –ë–î

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- –ó–∞–ø—É—Å–∫–∞—Ç—å –ø–æ—Å–ª–µ `ODataSyncWorker`
- –ü–µ—Ä–µ–¥ `VirtualEntitiesGeneratorWorker`
- –ü–æ—Ä—è–¥–æ–∫: ODataSyncWorker ‚Üí **AirRouteGeneratorWorker** ‚Üí VirtualEntitiesGeneratorWorker ‚Üí GraphBuilderWorker

#### –®–∞–≥ 3.3: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `GraphBuilderWorker` –¥–ª—è –º–Ω–æ–≥–æ—ç—Ç–∞–ø–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤

**–§–∞–π–ª:** `backend/src/application/workers/GraphBuilderWorker.ts`

**–ú–µ—Ç–æ–¥:** `buildGraphStructure()`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
1. **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ –ø–æ –≥–æ—Ä–æ–¥–∞–º:**
   - –°–æ–∑–¥–∞—Ç—å Map: `stopsByCity: Map<string, Stop[]>`
   - –ö–ª—é—á: `cityId` (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π)
   - –ó–Ω–∞—á–µ–Ω–∏–µ: –º–∞—Å—Å–∏–≤ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ –≤ —ç—Ç–æ–º –≥–æ—Ä–æ–¥–µ

2. **–°–æ–∑–¥–∞–Ω–∏–µ —Ä—ë–±–µ—Ä –ø–µ—Ä–µ—Å–∞–¥–∫–∏:**
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–æ—Ä–æ–¥–∞ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏:
     - –°–æ–∑–¥–∞—Ç—å –¥–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ä—ë–±—Ä–∞ –ø–µ—Ä–µ—Å–∞–¥–∫–∏ –º–µ–∂–¥—É –≤—Å–µ–º–∏ –ø–∞—Ä–∞–º–∏ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫
     - –¢–∏–ø —Ä–µ–±—Ä–∞: `TRANSFER` (–≤ `metadata.transportType`)
     - –í–µ—Å: —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å —á–µ—Ä–µ–∑ `calculateTransferWeight(stop1, stop2)`

3. **–†–∞—Å—á–µ—Ç –≤–µ—Å–∞ –ø–µ—Ä–µ—Å–∞–¥–∫–∏:**
   - –°–º. —Ä–∞–∑–¥–µ–ª 5.2

#### –®–∞–≥ 3.4: –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —Ö–∞–±–∞ –Ø–∫—É—Ç—Å–∫

**–õ–æ–≥–∏–∫–∞ hub-based –º–∞—Ä—à—Ä—É—Ç–æ–≤:**

1. **–§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –≥–æ—Ä–æ–¥ –Ø–∫—É—Ç–∏–∏:**
   - –°–µ–≥–º–µ–Ω—Ç 1: —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥ ‚Üí –Ø–∫—É—Ç—Å–∫ (PLANE, 240 –º–∏–Ω)
   - –ü–µ—Ä–µ—Å–∞–¥–∫–∞ –≤ –Ø–∫—É—Ç—Å–∫–µ: TRANSFER (90 –º–∏–Ω)
   - –°–µ–≥–º–µ–Ω—Ç 2: –Ø–∫—É—Ç—Å–∫ ‚Üí –≥–æ—Ä–æ–¥ –Ø–∫—É—Ç–∏–∏ (BUS, 180 –º–∏–Ω)
   - –ò—Ç–æ–≥–æ–≤—ã–π –≤–µ—Å: 240 + 90 + 180 = 510 –º–∏–Ω—É—Ç

2. **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ `VirtualEntitiesGeneratorWorker.ensureCitiesConnectivity()`:**
   - –î–ª—è –ø–∞—Ä—ã (—Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥, –≥–æ—Ä–æ–¥ –Ø–∫—É—Ç–∏–∏):
     - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –ø—Ä—è–º–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞
     - –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí —Å–æ–∑–¥–∞—Ç—å –¥–≤–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–∞:
       - –ú–∞—Ä—à—Ä—É—Ç 1: —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥ ‚Üí –Ø–∫—É—Ç—Å–∫ (PLANE)
       - –ú–∞—Ä—à—Ä—É—Ç 2: –Ø–∫—É—Ç—Å–∫ ‚Üí –≥–æ—Ä–æ–¥ –Ø–∫—É—Ç–∏–∏ (BUS)
     - –ì—Ä–∞—Ñ —Å–∞–º –ø–æ—Å—Ç—Ä–æ–∏—Ç –ø—É—Ç—å —á–µ—Ä–µ–∑ –ø–µ—Ä–µ—Å–∞–¥–∫—É –≤ –Ø–∫—É—Ç—Å–∫–µ

### 3.3 –§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è

1. `backend/src/application/workers/AirRouteGeneratorWorker.ts`

### 3.4 –§–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

1. `backend/data/mock/stops.json` - –¥–æ–±–∞–≤–∏—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
2. `backend/data/mock/routes.json` - –¥–æ–±–∞–≤–∏—Ç—å –∞–≤–∏–∞–º–∞—Ä—à—Ä—É—Ç—ã –∏–∑ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
3. `backend/data/mock/flights.json` - –¥–æ–±–∞–≤–∏—Ç—å —Ä–µ–π—Å—ã –¥–ª—è –Ω–æ–≤—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤
4. `backend/src/application/workers/GraphBuilderWorker.ts` - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫, —Ä—ë–±—Ä–∞ –ø–µ—Ä–µ—Å–∞–¥–∫–∏
5. `backend/src/application/workers/VirtualEntitiesGeneratorWorker.ts` - hub-based –º–∞—Ä—à—Ä—É—Ç—ã
6. `backend/src/infrastructure/workers/initializeWorkers.ts` - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è AirRouteGeneratorWorker

### 3.5 –¢–µ—Å—Ç—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

1. `backend/src/__tests__/unit/workers/AirRouteGeneratorWorker.test.ts` (–ù–û–í–´–ô)
2. `backend/src/__tests__/unit/workers/GraphBuilderWorker.test.ts` (–û–ë–ù–û–í–ò–¢–¨)
3. `backend/src/__tests__/integration/use-cases/OptimizedBuildRouteUseCase.integration.test.ts` (–û–ë–ù–û–í–ò–¢–¨)

---

## 4. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–ø—Ä–∞–≤—ã (FERRY)

### 4.1 –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø–µ—Ä–µ–ø—Ä–∞–≤–µ

- –ú–∞—Ä—à—Ä—É—Ç: –Ø–∫—É—Ç—Å–∫ ‚Üî –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö
- –í—Ä–µ–º—è –ø–µ—Ä–µ–ø—Ä–∞–≤—ã: 20 –º–∏–Ω—É—Ç
- –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è: 15-45 –º–∏–Ω—É—Ç (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–µ–∑–æ–Ω–∞)
- –°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å: –ª–µ—Ç–æ (—á–∞—â–µ, 15-20 –º–∏–Ω –æ–∂–∏–¥–∞–Ω–∏—è) / –∑–∏–º–∞ (—Ä–µ–∂–µ, 30-45 –º–∏–Ω –æ–∂–∏–¥–∞–Ω–∏—è)
- –¢–∏–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞: FERRY

### 4.2 –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

#### –®–∞–≥ 4.1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ ferry terminal

**–§–∞–π–ª:** `backend/data/mock/stops.json`

**–î–æ–±–∞–≤–∏—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–∫–∏:**
- `stop-027`: "–ü–∞—Ä–æ–º–Ω–∞—è –ø–µ—Ä–µ–ø—Ä–∞–≤–∞ –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö"
  - coordinates: { latitude: 61.9500, longitude: 129.6000 }
  - type: `ferry_terminal`
  - cityId: `"—è–∫—É—Ç—Å–∫"` (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ suburbs-reference)
- `stop-028`: "–ü—Ä–∏—Å—Ç–∞–Ω—å –Ø–∫—É—Ç—Å–∫"
  - coordinates: { latitude: 62.0278, longitude: 129.7042 }
  - type: `ferry_terminal`
  - cityId: `"—è–∫—É—Ç—Å–∫"`

#### –®–∞–≥ 4.2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ ferry-–º–∞—Ä—à—Ä—É—Ç–æ–≤

**–§–∞–π–ª:** `backend/data/mock/routes.json`

**–î–æ–±–∞–≤–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã:**
- `route-040`: "–Ø–∫—É—Ç—Å–∫ - –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö (–ü–∞—Ä–æ–º)"
  - fromStopId: `stop-028` (–ü—Ä–∏—Å—Ç–∞–Ω—å –Ø–∫—É—Ç—Å–∫)
  - toStopId: `stop-027` (–ü–∞—Ä–æ–º–Ω–∞—è –ø–µ—Ä–µ–ø—Ä–∞–≤–∞ –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö)
  - transportType: `FERRY`
  - durationMinutes: 20
  - distanceKm: 15
  - baseFare: 500
  - metadata: {
      ferrySchedule: {
        summer: { start: "06:00", end: "23:00", frequency: 30 },
        winter: { start: "07:00", end: "22:00", frequency: 45 }
      }
    }
- `route-041`: "–ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö - –Ø–∫—É—Ç—Å–∫ (–ü–∞—Ä–æ–º)"
  - fromStopId: `stop-027`
  - toStopId: `stop-028`
  - transportType: `FERRY`
  - durationMinutes: 20
  - distanceKm: 15
  - baseFare: 500
  - metadata: { ferrySchedule: ... } (—Ç–æ –∂–µ —Å–∞–º–æ–µ)

#### –®–∞–≥ 4.3: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ FERRY –≤ TransportType

**–§–∞–π–ª:** `backend/src/domain/entities/Route.ts`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –°—Ç—Ä–æ–∫–∞ 6: –ò–∑–º–µ–Ω–∏—Ç—å `TransportType` type:
  - –ë—ã–ª–æ: `export type TransportType = 'BUS' | 'TRAIN' | 'PLANE' | 'WATER';`
  - –°—Ç–∞–ª–æ: `export type TransportType = 'BUS' | 'TRAIN' | 'PLANE' | 'WATER' | 'FERRY';`
- –°—Ç—Ä–æ–∫–∞ 79: –û–±–Ω–æ–≤–∏—Ç—å `validTransportTypes`:
  - –î–æ–±–∞–≤–∏—Ç—å `'FERRY'` –≤ –º–∞—Å—Å–∏–≤

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
- –ù–∞–π—Ç–∏ –≤—Å–µ –º–µ—Å—Ç–∞, –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `TransportType` –∏–∑ `Route.ts`
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤–µ–∑–¥–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è `'FERRY'`
- –ï—Å–ª–∏ –µ—Å—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç —Å `RouteSegment.TransportType` enum (–∫–æ—Ç–æ—Ä—ã–π —É–∂–µ –∏–º–µ–µ—Ç `FERRY = 'ferry'`), —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

#### –®–∞–≥ 4.4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `GraphBuilderWorker` –¥–ª—è ferry

**–§–∞–π–ª:** `backend/src/application/workers/GraphBuilderWorker.ts`

**–ú–µ—Ç–æ–¥:** `buildGraphStructure()`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
1. **–û–±—Ä–∞–±–æ—Ç–∫–∞ ferry-–º–∞—Ä—à—Ä—É—Ç–æ–≤:**
   - –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ä—ë–±–µ—Ä –∏–∑ –º–∞—Ä—à—Ä—É—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä—è—Ç—å `transportType === 'FERRY'`
   - –î–ª—è ferry-–º–∞—Ä—à—Ä—É—Ç–æ–≤ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å –≤–µ—Å —Å —É—á–µ—Ç–æ–º —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏:
     - –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–ø—Ä–∞–≤—ã: 20 –º–∏–Ω—É—Ç (–∏–∑ `route.durationMinutes`)
     - –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è:
       - –õ–µ—Ç–æ–º: 15-20 –º–∏–Ω—É—Ç (—á–∞—Å—Ç–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ, frequency: 30)
       - –ó–∏–º–æ–π: 30-45 –º–∏–Ω—É—Ç (—Ä–µ–¥–∫–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ, frequency: 45)
     - –ò—Ç–æ–≥–æ–≤—ã–π –≤–µ—Å: 20 + –æ–∂–∏–¥–∞–Ω–∏–µ (35-65 –º–∏–Ω—É—Ç)
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `metadata.ferrySchedule` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–µ–∑–æ–Ω–∞
   - –û–ø—Ä–µ–¥–µ–ª—è—Ç—å —Å–µ–∑–æ–Ω –ø–æ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç–µ (–º–µ—Å—è—Ü 4-9 = –ª–µ—Ç–æ, –æ—Å—Ç–∞–ª—å–Ω–æ–µ = –∑–∏–º–∞)

2. **–ú–µ—Ç–æ–¥ —Ä–∞—Å—á–µ—Ç–∞ –≤–µ—Å–∞ ferry:**
   - `calculateFerryWeight(route: Route, currentDate: Date): number`
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: –º–∞—Ä—à—Ä—É—Ç —Å `metadata.ferrySchedule`, —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞
   - –õ–æ–≥–∏–∫–∞:
     - –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–µ–∑–æ–Ω (–ª–µ—Ç–æ/–∑–∏–º–∞)
     - –ü–æ–ª—É—á–∏—Ç—å `frequency` –∏–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ —Å–µ–∑–æ–Ω–∞
     - –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è: `frequency / 2`
     - –í–µ—Ä–Ω—É—Ç—å: `route.durationMinutes + waitTime`

#### –®–∞–≥ 4.5: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `RouteGraphBuilder` –¥–ª—è ferry

**–§–∞–π–ª:** `backend/src/application/route-builder/RouteGraphBuilder.ts`

**–ú–µ—Ç–æ–¥:** `buildFromDataset()` (–∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π)

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –ü—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å —Ç–∏–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞:
  - –ï—Å–ª–∏ `transportType === 'FERRY'` ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `TransportType.FERRY` (–∏–∑ RouteSegment enum)
- –°–æ–∑–¥–∞–≤–∞—Ç—å —Ä—ë–±—Ä–∞ –¥–ª—è ferry-–º–∞—Ä—à—Ä—É—Ç–æ–≤ —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º –≤–µ—Å–æ–º:
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `duration` –∏–∑ –º–∞—Ä—à—Ä—É—Ç–∞ (20 –º–∏–Ω—É—Ç)
  - –î–æ–±–∞–≤–ª—è—Ç—å –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∏–∑ `metadata.ferrySchedule`
  - –†–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å –∏—Ç–æ–≥–æ–≤—ã–π –≤–µ—Å: `duration + waitTime`

#### –®–∞–≥ 4.6: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–π—Å–æ–≤ ferry

**–§–∞–π–ª:** `backend/data/mock/flights.json`

**–î–æ–±–∞–≤–∏—Ç—å "—Ä–µ–π—Å—ã" –¥–ª—è ferry-–º–∞—Ä—à—Ä—É—Ç–æ–≤:**
- –î–ª—è `route-040` –∏ `route-041`:
  - –õ–µ—Ç–æ–º: –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç —Å 06:00 –¥–æ 23:00
  - –ó–∏–º–æ–π: –∫–∞–∂–¥—ã–µ 45 –º–∏–Ω—É—Ç —Å 07:00 –¥–æ 22:00
- –°–æ–∑–¥–∞—Ç—å —Ä–µ–π—Å—ã –Ω–∞ –±–ª–∏–∂–∞–π—à–∏–µ 30 –¥–Ω–µ–π

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –í —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ ferry-—Ä–µ–π—Å—ã –º–æ–≥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è, –Ω–æ –¥–ª—è mock-–¥–∞–Ω–Ω—ã—Ö –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–π—Å—ã.

### 4.3 –§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è

**–ù–µ—Ç –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤** (–∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã)

### 4.4 –§–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

1. `backend/data/mock/stops.json` - –¥–æ–±–∞–≤–∏—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–µ—Ä–µ–ø—Ä–∞–≤—ã
2. `backend/data/mock/routes.json` - –¥–æ–±–∞–≤–∏—Ç—å ferry-–º–∞—Ä—à—Ä—É—Ç—ã
3. `backend/data/mock/flights.json` - –¥–æ–±–∞–≤–∏—Ç—å —Ä–µ–π—Å—ã ferry
4. `backend/src/domain/entities/Route.ts` - –¥–æ–±–∞–≤–∏—Ç—å `'FERRY'` –≤ `TransportType`
5. `backend/src/application/workers/GraphBuilderWorker.ts` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ ferry, —Ä–∞—Å—á–µ—Ç –≤–µ—Å–∞ —Å —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å—é
6. `backend/src/application/route-builder/RouteGraphBuilder.ts` - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ ferry

### 4.5 –¢–µ—Å—Ç—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

1. `backend/src/__tests__/unit/workers/GraphBuilderWorker.test.ts` (–û–ë–ù–û–í–ò–¢–¨) - —Ç–µ—Å—Ç—ã –¥–ª—è ferry
2. `backend/src/__tests__/unit/route-builder/RouteGraphBuilder.test.ts` (–û–ë–ù–û–í–ò–¢–¨) - —Ç–µ—Å—Ç—ã –¥–ª—è ferry
3. `backend/src/__tests__/integration/use-cases/OptimizedBuildRouteUseCase.integration.test.ts` (–û–ë–ù–û–í–ò–¢–¨) - —Ç–µ—Å—Ç—ã –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–æ–≤ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–ø—Ä–∞–≤—É

---

## 5. –£–ª—É—á—à–µ–Ω–∏–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∞

### 5.1 –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —É–ª—É—á—à–µ–Ω–∏—è–º

1. –î–æ–±–∞–≤–∏—Ç—å —Ä—ë–±—Ä–∞ –ø–µ—Ä–µ—Å–∞–¥–∫–∏ –≤–Ω—É—Ç—Ä–∏ –≥–æ—Ä–æ–¥–∞
2. –†–∞—Å—Å—á–∏—Ç–∞—Ç—å transfer-–≤–µ—Å –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
3. –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ `city_id`
4. –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –≥—Ä–∞—Ñ: —Å–≤—è–∑–Ω–æ—Å—Ç—å, –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤–µ—Å–æ–≤, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —É–∑–ª–æ–≤

### 5.2 –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

#### –®–∞–≥ 5.1: –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ –ø–æ –≥–æ—Ä–æ–¥–∞–º

**–§–∞–π–ª:** `backend/src/application/workers/GraphBuilderWorker.ts`

**–ú–µ—Ç–æ–¥:** `buildGraphStructure()`

**–õ–æ–≥–∏–∫–∞ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏:**
1. –°–æ–∑–¥–∞—Ç—å Map: `stopsByCity: Map<string, Stop[]>`
2. –î–ª—è –∫–∞–∂–¥–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏:
   - –ü–æ–ª—É—á–∏—Ç—å `cityId` (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π)
   - –î–æ–±–∞–≤–∏—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–∫—É –≤ Map –ø–æ –∫–ª—é—á—É `cityId`
3. –†–µ–∑—É–ª—å—Ç–∞—Ç: Map, –≥–¥–µ –∫–ª—é—á = –≥–æ—Ä–æ–¥, –∑–Ω–∞—á–µ–Ω–∏–µ = –º–∞—Å—Å–∏–≤ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ –≤ —ç—Ç–æ–º –≥–æ—Ä–æ–¥–µ

#### –®–∞–≥ 5.2: –†–∞—Å—á–µ—Ç transfer-–≤–µ—Å–∞

**–§–∞–π–ª:** `backend/src/application/workers/GraphBuilderWorker.ts`

**–ú–µ—Ç–æ–¥:** `calculateTransferWeight(stop1: Stop, stop2: Stop): number`

**–õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–æ–≤ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫:**
- `isAirport`: –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ `stop.isAirport` –∏–ª–∏ `stop.name.toLowerCase().includes('–∞—ç—Ä–æ–ø–æ—Ä—Ç')`
- `isFerryTerminal`: –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ `stop.name.toLowerCase().includes('–ø–µ—Ä–µ–ø—Ä–∞–≤–∞')` –∏–ª–∏ `stop.name.toLowerCase().includes('–ø—Ä–∏—Å—Ç–∞–Ω—å')`
- `isGround`: –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ `stop.name.toLowerCase().includes('–∞–≤—Ç–æ—Å—Ç–∞–Ω—Ü–∏—è')` –∏–ª–∏ `stop.name.toLowerCase().includes('–≤–æ–∫–∑–∞–ª')`

**–¢–∞–±–ª–∏—Ü–∞ –≤–µ—Å–æ–≤ –ø–µ—Ä–µ—Å–∞–¥–∫–∏:**

| –¢–∏–ø –ø–µ—Ä–µ—Å–∞–¥–∫–∏ | –í–µ—Å (–º–∏–Ω—É—Ç—ã) | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ |
|---------------|--------------|-------------|
| Air ‚Üí Ground | 90 | –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–≥–∞–∂–∞, –ø–µ—Ä–µ—Ö–æ–¥ –∏–∑ –∞—ç—Ä–æ–ø–æ—Ä—Ç–∞ –≤ –≥–æ—Ä–æ–¥ |
| Ground ‚Üí Air | 120 | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –¥–æ—Å–º–æ—Ç—Ä, –ø–µ—Ä–µ—Ö–æ–¥ –≤ –∞—ç—Ä–æ–ø–æ—Ä—Ç |
| Ground ‚Üí Ground | 60 | –ü–µ—Ä–µ—Å–∞–¥–∫–∞ –Ω–∞ –∞–≤—Ç–æ–±—É—Å/—Ç–∞–∫—Å–∏ |
| Air ‚Üí Ferry | 90 | –ü–µ—Ä–µ—Ö–æ–¥ –∏–∑ –∞—ç—Ä–æ–ø–æ—Ä—Ç–∞ –Ω–∞ –ø—Ä–∏—Å—Ç–∞–Ω—å |
| Ferry ‚Üí Ground | 30 | –ë—ã—Å—Ç—Ä–∞—è –ø–µ—Ä–µ—Å–∞–¥–∫–∞ —Å –ø–∞—Ä–æ–º–∞ |
| Ferry ‚Üí Ferry | 20 | –ü–µ—Ä–µ—Å–∞–¥–∫–∞ –º–µ–∂–¥—É –ø–∞—Ä–æ–º–∞–º–∏ (—Ä–µ–¥–∫–æ) |
| –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | 60 | –ï—Å–ª–∏ —Ç–∏–ø –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω |

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```typescript
// –ü—Å–µ–≤–¥–æ–∫–æ–¥
if (isAirport(stop1) && isGround(stop2)) return 90;
if (isGround(stop1) && isAirport(stop2)) return 120;
if (isGround(stop1) && isGround(stop2)) return 60;
if (isAirport(stop1) && isFerryTerminal(stop2)) return 90;
if (isFerryTerminal(stop1) && isGround(stop2)) return 30;
if (isFerryTerminal(stop1) && isFerryTerminal(stop2)) return 20;
return 60; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
```

#### –®–∞–≥ 5.3: –°–æ–∑–¥–∞–Ω–∏–µ —Ä—ë–±–µ—Ä –ø–µ—Ä–µ—Å–∞–¥–∫–∏

**–§–∞–π–ª:** `backend/src/application/workers/GraphBuilderWorker.ts`

**–ú–µ—Ç–æ–¥:** `buildGraphStructure()`

**–õ–æ–≥–∏–∫–∞:**
1. –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ä—ë–±–µ—Ä –∏–∑ –º–∞—Ä—à—Ä—É—Ç–æ–≤:
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–æ—Ä–æ–¥–∞ –∏–∑ `stopsByCity`:
     - –ï—Å–ª–∏ –≤ –≥–æ—Ä–æ–¥–µ >= 2 –æ—Å—Ç–∞–Ω–æ–≤–∫–∏:
       - –î–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ (i, j):
         - –°–æ–∑–¥–∞—Ç—å –¥–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ä—ë–±—Ä–∞ –ø–µ—Ä–µ—Å–∞–¥–∫–∏:
           - –†–µ–±—Ä–æ 1: `stop[i] ‚Üí stop[j]` (–≤–µ—Å: `calculateTransferWeight(stop[i], stop[j])`)
           - –†–µ–±—Ä–æ 2: `stop[j] ‚Üí stop[i]` (–≤–µ—Å: `calculateTransferWeight(stop[j], stop[i])`)
         - –¢–∏–ø —Ä–µ–±—Ä–∞: `TRANSFER` (–≤ `metadata.transportType`)
         - –î–æ–±–∞–≤–∏—Ç—å –≤ –º–∞—Å—Å–∏–≤ `edges`

2. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–±—Ä–∞ –ø–µ—Ä–µ—Å–∞–¥–∫–∏:**
   - `fromStopId`: ID –ø–µ—Ä–≤–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
   - `toStopId`: ID –≤—Ç–æ—Ä–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
   - `weight`: –≤–µ—Å –ø–µ—Ä–µ—Å–∞–¥–∫–∏ (–∏–∑ `calculateTransferWeight()`)
   - `metadata.transportType`: `'TRANSFER'`
   - `metadata.isVirtual`: `true` (–ø–µ—Ä–µ—Å–∞–¥–∫–∞ - –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ —Ä–µ–±—Ä–æ)

#### –®–∞–≥ 5.4: –í–∞–ª–∏–¥–∞—Ü–∏—è –≥—Ä–∞—Ñ–∞

**–§–∞–π–ª:** `backend/src/shared/validators/graph-validator.ts` (–ù–û–í–´–ô)

**–§—É–Ω–∫—Ü–∏–∏:**
1. `validateGraphStructure(nodes: GraphNode[], edges: GraphNeighbor[]): GraphValidationResult`
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: –≤—Å–µ —Ä—ë–±—Ä–∞ –∏–º–µ—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤–µ—Å (> 0, –Ω–µ NaN, –Ω–µ Infinity)
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: –≤—Å–µ —É–∑–ª—ã –∏–º–µ—é—Ç —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ –≤—Ö–æ–¥—è—â–µ–µ –∏–ª–∏ –∏—Å—Ö–æ–¥—è—â–µ–µ —Ä–µ–±—Ä–æ
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ 3: —Å–≤—è–∑–Ω–æ—Å—Ç—å –≥—Ä–∞—Ñ–∞ (BFS –æ—Ç hub-—É–∑–ª–∞ "–Ø–∫—É—Ç—Å–∫")
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–∑–ª–æ–≤, —Ä—ë–±–µ—Ä, –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —É–∑–ª–æ–≤, –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–≤—è–∑–Ω–æ—Å—Ç–∏
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `{ isValid: boolean, errors: string[], warnings: string[], stats: {...} }`

2. `validateTransferEdges(edges: GraphNeighbor[]): ValidationResult`
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: —Ä—ë–±—Ä–∞ –ø–µ—Ä–µ—Å–∞–¥–∫–∏ —Å–æ–∑–¥–∞–Ω—ã —Ç–æ–ª—å–∫–æ –º–µ–∂–¥—É –æ—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏ –≤ –æ–¥–Ω–æ–º –≥–æ—Ä–æ–¥–µ
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: –≤–µ—Å —Ä—ë–±–µ—Ä –ø–µ—Ä–µ—Å–∞–¥–∫–∏ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 30-120 –º–∏–Ω—É—Ç
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `{ isValid: boolean, errors: string[] }`

3. `validateFerryEdges(edges: GraphNeighbor[]): ValidationResult`
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: ferry-—Ä—ë–±—Ä–∞ –∏–º–µ—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤–µ—Å (20-65 –º–∏–Ω—É—Ç)
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: ferry-—Ä—ë–±—Ä–∞ —Å–≤—è–∑—ã–≤–∞—é—Ç —Ç–æ–ª—å–∫–æ ferry_terminal –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `{ isValid: boolean, errors: string[] }`

4. `bfsFromNode(startNodeId: string, edges: GraphNeighbor[]): Set<string>`
   - BFS –æ—Ç –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —É–∑–ª–∞
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç Set –¥–æ—Å—Ç–∏–∂–∏–º—ã—Ö —É–∑–ª–æ–≤
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–≤—è–∑–Ω–æ—Å—Ç–∏

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ `GraphBuilderWorker`:**
- –ü–æ—Å–ª–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∞ –≤—ã–∑–≤–∞—Ç—å `validateGraphStructure()`
- –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ä—ë–±–µ—Ä –ø–µ—Ä–µ—Å–∞–¥–∫–∏ –≤—ã–∑–≤–∞—Ç—å `validateTransferEdges()`
- –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è ferry-—Ä—ë–±–µ—Ä –≤—ã–∑–≤–∞—Ç—å `validateFerryEdges()`
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- –î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

#### –®–∞–≥ 5.5: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `GraphNeighbor` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ `transportType`

**–§–∞–π–ª:** `backend/src/domain/repositories/IGraphRepository.ts`

**–¢–∏–ø:** `GraphNeighbor`

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –£–∂–µ –µ—Å—Ç—å –ø–æ–ª–µ `metadata.transportType?: string` (—Å—Ç—Ä–æ–∫–∞ 22)
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ç–∏–ø–æ–≤ `TRANSFER`, `FERRY` –∏ —Ç.–¥.

**–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å:**
- –î–æ–±–∞–≤–∏—Ç—å —è–≤–Ω–æ–µ –ø–æ–ª–µ `transportType?: string` –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ (–µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç)
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ `metadata.transportType`

### 5.3 –§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è

1. `backend/src/shared/validators/graph-validator.ts`

### 5.4 –§–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

1. `backend/src/application/workers/GraphBuilderWorker.ts` - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞, —Ä—ë–±—Ä–∞ –ø–µ—Ä–µ—Å–∞–¥–∫–∏, –≤–∞–ª–∏–¥–∞—Ü–∏—è
2. `backend/src/domain/repositories/IGraphRepository.ts` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ `transportType` (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

### 5.5 –¢–µ—Å—Ç—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

1. `backend/src/__tests__/unit/validators/graph-validator.test.ts` (–ù–û–í–´–ô)
2. `backend/src/__tests__/unit/workers/GraphBuilderWorker.test.ts` (–û–ë–ù–û–í–ò–¢–¨)
3. `backend/src/__tests__/integration/use-cases/OptimizedBuildRouteUseCase.integration.test.ts` (–û–ë–ù–û–í–ò–¢–¨)

---

## 6. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–æ—Ä–∫–µ—Ä–æ–≤ –∏ –∏—Ö –ø–æ—Ä—è–¥–æ–∫

### 6.1 –¢–µ–∫—É—â–∏–π –ø–æ—Ä—è–¥–æ–∫ –≤–æ—Ä–∫–µ—Ä–æ–≤

1. ODataSyncWorker
2. VirtualEntitiesGeneratorWorker
3. GraphBuilderWorker

### 6.2 –ù–æ–≤—ã–π –ø–æ—Ä—è–¥–æ–∫ –≤–æ—Ä–∫–µ—Ä–æ–≤

1. **ODataSyncWorker** - –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
2. **AirRouteGeneratorWorker** - –∞–≤–∏–∞-–º–∞—Ä—à—Ä—É—Ç—ã —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ (–ù–û–í–´–ô)
3. **VirtualEntitiesGeneratorWorker** - –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —Ö–∞–±—ã
4. **GraphBuilderWorker** - –ø–µ—Ä–µ—Å–∞–¥–∫–∏, ferry, —Å–º–µ—à–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã

### 6.3 –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–æ—Ä–∫–µ—Ä–æ–≤

#### –í–æ—Ä–∫–µ—Ä 1: ODataSyncWorker

**–§–∞–π–ª:** `backend/src/application/workers/ODataSyncWorker.ts`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–∏—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ (—Å–º. —Ä–∞–∑–¥–µ–ª 1.2)
- –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é —á–µ—Ä–µ–∑ `stop-validator.ts`
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —á–µ—Ä–µ–∑ `isCityInUnifiedReference()`
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç (–ø–µ—Ä–≤—ã–π –≤–æ—Ä–∫–µ—Ä)

#### –í–æ—Ä–∫–µ—Ä 2: AirRouteGeneratorWorker (–ù–û–í–´–ô)

**–§–∞–π–ª:** `backend/src/application/workers/AirRouteGeneratorWorker.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∞–≤–∏–∞–º–∞—Ä—à—Ä—É—Ç–æ–≤ –∏–∑ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ –≤ –Ø–∫—É—Ç—Å–∫

**–ú–µ—Ç–æ–¥—ã:**
- `canRun(): Promise<boolean>` - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ dataset –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ ODataSyncWorker
- `executeWorkerLogic(): Promise<WorkerExecutionResult>` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∞—Ä—à—Ä—É—Ç–æ–≤ –∏ —Ä–µ–π—Å–æ–≤

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** ODataSyncWorker (–¥–æ–ª–∂–µ–Ω –≤—ã–ø–æ–ª–Ω–∏—Ç—å—Å—è –ø–µ—Ä–≤—ã–º)

#### –í–æ—Ä–∫–µ—Ä 3: VirtualEntitiesGeneratorWorker

**–§–∞–π–ª:** `backend/src/application/workers/VirtualEntitiesGeneratorWorker.ts`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `unified-cities-loader.ts` –≤–º–µ—Å—Ç–æ `yakutia-cities-loader.ts`
- –û–±–Ω–æ–≤–∏—Ç—å `generateVirtualStops()` –¥–ª—è —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
- –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –∏ –æ–±–Ω–æ–≤–∏—Ç—å `ensureCitiesConnectivity()` –¥–ª—è hub-based –º–∞—Ä—à—Ä—É—Ç–æ–≤

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** ODataSyncWorker, AirRouteGeneratorWorker

#### –í–æ—Ä–∫–µ—Ä 4: GraphBuilderWorker

**–§–∞–π–ª:** `backend/src/application/workers/GraphBuilderWorker.ts`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ –ø–æ –≥–æ—Ä–æ–¥–∞–º
- –î–æ–±–∞–≤–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Ä—ë–±–µ—Ä –ø–µ—Ä–µ—Å–∞–¥–∫–∏
- –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—á–µ—Ç –≤–µ—Å–∞ –¥–ª—è ferry —Å —É—á–µ—Ç–æ–º —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≥—Ä–∞—Ñ–∞

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** ODataSyncWorker, AirRouteGeneratorWorker, VirtualEntitiesGeneratorWorker

### 6.4 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `initializeWorkers.ts`

**–§–∞–π–ª:** `backend/src/infrastructure/workers/initializeWorkers.ts`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
1. **–ò–º–ø–æ—Ä—Ç—ã:**
   - –£–¥–∞–ª–∏—Ç—å: `getYakutiaCitiesDirectory` –∏–∑ `yakutia-cities-loader.ts`
   - –î–æ–±–∞–≤–∏—Ç—å: `AirRouteGeneratorWorker` –∏–∑ `application/workers`

2. **–§—É–Ω–∫—Ü–∏—è `initializeWorkers()`:**
   - –£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫—É: `const yakutiaCitiesDirectory = getYakutiaCitiesDirectory();`
   - –û–±–Ω–æ–≤–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ `VirtualEntitiesGeneratorWorker`: —É–±—Ä–∞—Ç—å –ø–µ—Ä–µ–¥–∞—á—É `yakutiaCitiesDirectory` –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä
   - –î–æ–±–∞–≤–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ `AirRouteGeneratorWorker`:
     ```typescript
     const airRouteGeneratorWorker = new AirRouteGeneratorWorker(
       stopRepository,
       routeRepository,
       flightRepository,
       datasetRepository
     );
     ```
   - –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–æ—Ä–∫–µ—Ä—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ:
     ```typescript
     orchestrator.registerWorker('odata-sync-worker', odataSyncWorker);
     orchestrator.registerWorker('air-route-generator', airRouteGeneratorWorker);
     orchestrator.registerWorker('virtual-entities-generator', virtualEntitiesWorker);
     orchestrator.registerWorker('graph-builder', graphBuilderWorker);
     ```

### 6.5 –§–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

1. `backend/src/application/workers/ODataSyncWorker.ts` - –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
2. `backend/src/application/workers/AirRouteGeneratorWorker.ts` - –Ω–æ–≤—ã–π –≤–æ—Ä–∫–µ—Ä
3. `backend/src/application/workers/VirtualEntitiesGeneratorWorker.ts` - unified-cities-loader, hub-based –º–∞—Ä—à—Ä—É—Ç—ã
4. `backend/src/application/workers/GraphBuilderWorker.ts` - –ø–µ—Ä–µ—Å–∞–¥–∫–∏, ferry, –≤–∞–ª–∏–¥–∞—Ü–∏—è
5. `backend/src/infrastructure/workers/initializeWorkers.ts` - –ø–æ—Ä—è–¥–æ–∫ –≤–æ—Ä–∫–µ—Ä–æ–≤, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è AirRouteGeneratorWorker

### 6.6 –¢–µ—Å—Ç—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

1. `backend/src/__tests__/unit/workers/AirRouteGeneratorWorker.test.ts` (–ù–û–í–´–ô)
2. `backend/src/__tests__/unit/workers/ODataSyncWorker.test.ts` (–û–ë–ù–û–í–ò–¢–¨)
3. `backend/src/__tests__/unit/workers/VirtualEntitiesGeneratorWorker.test.ts` (–û–ë–ù–û–í–ò–¢–¨)
4. `backend/src/__tests__/unit/workers/GraphBuilderWorker.test.ts` (–û–ë–ù–û–í–ò–¢–¨)
5. `backend/src/__tests__/integration/workers/WorkerPipeline.integration.test.ts` (–û–ë–ù–û–í–ò–¢–¨) - —Ç–µ—Å—Ç –ø–æ–ª–Ω–æ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞

---

## 7. –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã

### 7.1 –°–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤

| ‚Ññ | –ú–∞—Ä—à—Ä—É—Ç | –¢–∏–ø—ã —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ | –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç |
|---|---------|-----------------|---------------------|
| 1 | –ú–æ—Å–∫–≤–∞ ‚Üí –Ø–∫—É—Ç—Å–∫ | PLANE | –ü—Ä—è–º–æ–π –∞–≤–∏–∞–º–∞—Ä—à—Ä—É—Ç, 240 –º–∏–Ω—É—Ç |
| 2 | –ú–æ—Å–∫–≤–∞ ‚Üí –ß—É—Ä–∞–ø—á–∞ | PLANE + TRANSFER + BUS | –ê–≤–∏–∞ ‚Üí –ø–µ—Ä–µ—Å–∞–¥–∫–∞ (90 –º–∏–Ω) ‚Üí –∞–≤—Ç–æ–±—É—Å, ~510 –º–∏–Ω—É—Ç |
| 3 | –ú–æ—Å–∫–≤–∞ ‚Üí –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö | PLANE + TRANSFER + FERRY | –ê–≤–∏–∞ ‚Üí –ø–µ—Ä–µ—Å–∞–¥–∫–∞ (90 –º–∏–Ω) ‚Üí –ø–µ—Ä–µ–ø—Ä–∞–≤–∞ (40 –º–∏–Ω), ~370 –º–∏–Ω—É—Ç |
| 4 | –ú–æ—Å–∫–≤–∞ ‚Üí –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö (–∑–∏–º–∞) | PLANE + TRANSFER + FERRY | –ê–≤–∏–∞ ‚Üí –ø–µ—Ä–µ—Å–∞–¥–∫–∞ (90 –º–∏–Ω) ‚Üí –ø–µ—Ä–µ–ø—Ä–∞–≤–∞ (65 –º–∏–Ω), ~395 –º–∏–Ω—É—Ç |
| 5 | –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –û–ª—ë–∫–º–∏–Ω—Å–∫ | PLANE + TRANSFER + BUS | –ê–≤–∏–∞ ‚Üí –ø–µ—Ä–µ—Å–∞–¥–∫–∞ (90 –º–∏–Ω) ‚Üí –∞–≤—Ç–æ–±—É—Å, ~510 –º–∏–Ω—É—Ç |
| 6 | –•–∞–±–∞—Ä–æ–≤—Å–∫ ‚Üí –Ø–∫—É—Ç—Å–∫ | PLANE | –ü—Ä—è–º–æ–π –∞–≤–∏–∞–º–∞—Ä—à—Ä—É—Ç, 300 –º–∏–Ω—É—Ç |
| 7 | –í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –ú–∏—Ä–Ω—ã–π | PLANE + TRANSFER + BUS | –ê–≤–∏–∞ ‚Üí –ø–µ—Ä–µ—Å–∞–¥–∫–∞ (90 –º–∏–Ω) ‚Üí –∞–≤—Ç–æ–±—É—Å, ~510 –º–∏–Ω—É—Ç |

### 7.2 –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤

#### –ú–∞—Ä—à—Ä—É—Ç 1: –ú–æ—Å–∫–≤–∞ ‚Üí –Ø–∫—É—Ç—Å–∫
- **–¢–∏–ø:** –ü—Ä—è–º–æ–π –∞–≤–∏–∞–º–∞—Ä—à—Ä—É—Ç
- **–°–µ–≥–º–µ–Ω—Ç—ã:** 1 (PLANE)
- **–í—Ä–µ–º—è:** 240 –º–∏–Ω—É—Ç (4 —á–∞—Å–∞)
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ú–∞—Ä—à—Ä—É—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞–π–¥–µ–Ω, —Ç–∏–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ = PLANE

#### –ú–∞—Ä—à—Ä—É—Ç 2: –ú–æ—Å–∫–≤–∞ ‚Üí –ß—É—Ä–∞–ø—á–∞
- **–¢–∏–ø:** –°–º–µ—à–∞–Ω–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç (hub-based)
- **–°–µ–≥–º–µ–Ω—Ç—ã:** 
  1. –ú–æ—Å–∫–≤–∞ ‚Üí –Ø–∫—É—Ç—Å–∫ (PLANE, 240 –º–∏–Ω)
  2. –ü–µ—Ä–µ—Å–∞–¥–∫–∞ –≤ –Ø–∫—É—Ç—Å–∫–µ (TRANSFER, 90 –º–∏–Ω)
  3. –Ø–∫—É—Ç—Å–∫ ‚Üí –ß—É—Ä–∞–ø—á–∞ (BUS, 180 –º–∏–Ω)
- **–û–±—â–µ–µ –≤—Ä–µ–º—è:** ~510 –º–∏–Ω—É—Ç (8.5 —á–∞—Å–æ–≤)
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ú–∞—Ä—à—Ä—É—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å 3 —Å–µ–≥–º–µ–Ω—Ç–∞, –ø–µ—Ä–µ—Å–∞–¥–∫–∞ –≤ –Ø–∫—É—Ç—Å–∫–µ

#### –ú–∞—Ä—à—Ä—É—Ç 3: –ú–æ—Å–∫–≤–∞ ‚Üí –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö (–ª–µ—Ç–æ)
- **–¢–∏–ø:** –°–º–µ—à–∞–Ω–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç —Å –ø–µ—Ä–µ–ø—Ä–∞–≤–æ–π
- **–°–µ–≥–º–µ–Ω—Ç—ã:**
  1. –ú–æ—Å–∫–≤–∞ ‚Üí –Ø–∫—É—Ç—Å–∫ (PLANE, 240 –º–∏–Ω)
  2. –ü–µ—Ä–µ—Å–∞–¥–∫–∞ –≤ –Ø–∫—É—Ç—Å–∫–µ (TRANSFER, 90 –º–∏–Ω)
  3. –Ø–∫—É—Ç—Å–∫ ‚Üí –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö (FERRY, 40 –º–∏–Ω: 20 –º–∏–Ω –ø–µ—Ä–µ–ø—Ä–∞–≤–∞ + 20 –º–∏–Ω –æ–∂–∏–¥–∞–Ω–∏–µ)
- **–û–±—â–µ–µ –≤—Ä–µ–º—è:** ~370 –º–∏–Ω—É—Ç (6.2 —á–∞—Å–∞)
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ú–∞—Ä—à—Ä—É—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å FERRY —Å–µ–≥–º–µ–Ω—Ç, –≤–µ—Å = 40 –º–∏–Ω—É—Ç

#### –ú–∞—Ä—à—Ä—É—Ç 4: –ú–æ—Å–∫–≤–∞ ‚Üí –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö (–∑–∏–º–∞)
- **–¢–∏–ø:** –°–º–µ—à–∞–Ω–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç —Å –ø–µ—Ä–µ–ø—Ä–∞–≤–æ–π (–∑–∏–º–Ω–µ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ)
- **–°–µ–≥–º–µ–Ω—Ç—ã:**
  1. –ú–æ—Å–∫–≤–∞ ‚Üí –Ø–∫—É—Ç—Å–∫ (PLANE, 240 –º–∏–Ω)
  2. –ü–µ—Ä–µ—Å–∞–¥–∫–∞ –≤ –Ø–∫—É—Ç—Å–∫–µ (TRANSFER, 90 –º–∏–Ω)
  3. –Ø–∫—É—Ç—Å–∫ ‚Üí –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö (FERRY, 65 –º–∏–Ω: 20 –º–∏–Ω –ø–µ—Ä–µ–ø—Ä–∞–≤–∞ + 45 –º–∏–Ω –æ–∂–∏–¥–∞–Ω–∏–µ)
- **–û–±—â–µ–µ –≤—Ä–µ–º—è:** ~395 –º–∏–Ω—É—Ç (6.6 —á–∞—Å–∞)
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ú–∞—Ä—à—Ä—É—Ç –¥–æ–ª–∂–µ–Ω —É—á–∏—Ç—ã–≤–∞—Ç—å –∑–∏–º–Ω–µ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ, –≤–µ—Å FERRY = 65 –º–∏–Ω—É—Ç

#### –ú–∞—Ä—à—Ä—É—Ç 5: –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –û–ª—ë–∫–º–∏–Ω—Å–∫
- **–¢–∏–ø:** –°–º–µ—à–∞–Ω–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç (hub-based)
- **–°–µ–≥–º–µ–Ω—Ç—ã:**
  1. –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫ ‚Üí –Ø–∫—É—Ç—Å–∫ (PLANE, 240 –º–∏–Ω)
  2. –ü–µ—Ä–µ—Å–∞–¥–∫–∞ –≤ –Ø–∫—É—Ç—Å–∫–µ (TRANSFER, 90 –º–∏–Ω)
  3. –Ø–∫—É—Ç—Å–∫ ‚Üí –û–ª—ë–∫–º–∏–Ω—Å–∫ (BUS, 180 –º–∏–Ω)
- **–û–±—â–µ–µ –≤—Ä–µ–º—è:** ~510 –º–∏–Ω—É—Ç (8.5 —á–∞—Å–æ–≤)
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ú–∞—Ä—à—Ä—É—Ç –¥–æ–ª–∂–µ–Ω –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ –Ø–∫—É—Ç—Å–∫ (hub)

#### –ú–∞—Ä—à—Ä—É—Ç 6: –•–∞–±–∞—Ä–æ–≤—Å–∫ ‚Üí –Ø–∫—É—Ç—Å–∫
- **–¢–∏–ø:** –ü—Ä—è–º–æ–π –∞–≤–∏–∞–º–∞—Ä—à—Ä—É—Ç
- **–°–µ–≥–º–µ–Ω—Ç—ã:** 1 (PLANE)
- **–í—Ä–µ–º—è:** 300 –º–∏–Ω—É—Ç (5 —á–∞—Å–æ–≤)
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ú–∞—Ä—à—Ä—É—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞–π–¥–µ–Ω, —Ç–∏–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ = PLANE

#### –ú–∞—Ä—à—Ä—É—Ç 7: –í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫ ‚Üí –Ø–∫—É—Ç—Å–∫ ‚Üí –ú–∏—Ä–Ω—ã–π
- **–¢–∏–ø:** –°–º–µ—à–∞–Ω–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç (hub-based)
- **–°–µ–≥–º–µ–Ω—Ç—ã:**
  1. –í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫ ‚Üí –Ø–∫—É—Ç—Å–∫ (PLANE, 300 –º–∏–Ω)
  2. –ü–µ—Ä–µ—Å–∞–¥–∫–∞ –≤ –Ø–∫—É—Ç—Å–∫–µ (TRANSFER, 90 –º–∏–Ω)
  3. –Ø–∫—É—Ç—Å–∫ ‚Üí –ú–∏—Ä–Ω—ã–π (BUS, 180 –º–∏–Ω)
- **–û–±—â–µ–µ –≤—Ä–µ–º—è:** ~570 –º–∏–Ω—É—Ç (9.5 —á–∞—Å–æ–≤)
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ú–∞—Ä—à—Ä—É—Ç –¥–æ–ª–∂–µ–Ω –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ –Ø–∫—É—Ç—Å–∫ (hub)

### 7.3 –ß–µ–∫–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤

**–ü–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**

- [ ] **–ú–∞—Ä—à—Ä—É—Ç 1:** –ú–æ—Å–∫–≤–∞ ‚Üí –Ø–∫—É—Ç—Å–∫ —Å—Ç—Ä–æ–∏—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] **–ú–∞—Ä—à—Ä—É—Ç 2:** –ú–æ—Å–∫–≤–∞ ‚Üí –ß—É—Ä–∞–ø—á–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–µ—Ä–µ—Å–∞–¥–∫—É –≤ –Ø–∫—É—Ç—Å–∫–µ
- [ ] **–ú–∞—Ä—à—Ä—É—Ç 3:** –ú–æ—Å–∫–≤–∞ ‚Üí –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö —Å–æ–¥–µ—Ä–∂–∏—Ç FERRY —Å–µ–≥–º–µ–Ω—Ç (–ª–µ—Ç–æ)
- [ ] **–ú–∞—Ä—à—Ä—É—Ç 4:** –ú–æ—Å–∫–≤–∞ ‚Üí –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö —É—á–∏—Ç—ã–≤–∞–µ—Ç –∑–∏–º–Ω–µ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ
- [ ] **–ú–∞—Ä—à—Ä—É—Ç 5:** –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫ ‚Üí –û–ª—ë–∫–º–∏–Ω—Å–∫ –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –Ø–∫—É—Ç—Å–∫
- [ ] **–ú–∞—Ä—à—Ä—É—Ç 6:** –•–∞–±–∞—Ä–æ–≤—Å–∫ ‚Üí –Ø–∫—É—Ç—Å–∫ —Å—Ç—Ä–æ–∏—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] **–ú–∞—Ä—à—Ä—É—Ç 7:** –í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫ ‚Üí –ú–∏—Ä–Ω—ã–π –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –Ø–∫—É—Ç—Å–∫

**–ú–µ—Ç–æ–¥—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:**
- –ó–∞–ø—Ä–æ—Å—ã –∫ API: `GET /api/v1/routes/search?from={from}&to={to}`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –æ—Ç–≤–µ—Ç–∞: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ–≥–º–µ–Ω—Ç–æ–≤, —Ç–∏–ø—ã —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞, –≤–µ—Å–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏–∫–∏: –ø–µ—Ä–µ—Å–∞–¥–∫–∏ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö, –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –≤–µ—Å–∞

---

## 8. –ö–æ–Ω–µ—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### 8.1 –ü–æ–ª–Ω—ã–π —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –ø–ª–∞–Ω –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ —ç—Ç–∞–ø–∞–º

#### –≠—Ç–∞–ø 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (2-3 –¥–Ω—è)

**–¶–µ–ª—å:** –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö, —É—Å—Ç—Ä–∞–Ω–∏—Ç—å –±–ª–æ–∫–∏—Ä—É—é—â–∏–µ –æ—à–∏–±–∫–∏

**–ó–∞–¥–∞—á–∏:**
1. –°–æ–∑–¥–∞—Ç—å —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ (airports, suburbs)
2. –°–æ–∑–¥–∞—Ç—å –∑–∞–≥—Ä—É–∑—á–∏–∫–∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤
3. –°–æ–∑–¥–∞—Ç—å –≤–∞–ª–∏–¥–∞—Ç–æ—Ä –æ—Å—Ç–∞–Ω–æ–≤–æ–∫
4. –ò—Å–ø—Ä–∞–≤–∏—Ç—å `extractCityFromStopName()`
5. –û–±–Ω–æ–≤–∏—Ç—å `ODataSyncWorker.parseODataResponse()`

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞:**
- ‚úÖ "–ê—ç—Ä–æ–ø–æ—Ä—Ç –Ø–∫—É—Ç—Å–∫ (–¢—É–π–º–∞–∞–¥–∞)" ‚Üí `city_id = "–Ø–∫—É—Ç—Å–∫"`
- ‚úÖ "–ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö" ‚Üí `city_id = "–Ø–∫—É—Ç—Å–∫"`
- ‚úÖ "–¢—É–π–º–∞–∞–¥–∞" –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥
- ‚úÖ –ú—É—Å–æ—Ä–Ω—ã–µ –∑–∞–ø–∏—Å–∏ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è

#### –≠—Ç–∞–ø 2: –§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ (3-4 –¥–Ω—è)

**–¶–µ–ª—å:** –î–æ–±–∞–≤–∏—Ç—å 10 —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤, –æ–±–µ—Å–ø–µ—á–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã –†–æ—Å—Å–∏—è ‚Üí –Ø–∫—É—Ç–∏—è

**–ó–∞–¥–∞—á–∏:**
1. –°–æ–∑–¥–∞—Ç—å —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
2. –°–æ–∑–¥–∞—Ç—å unified-cities-loader
3. –û–±–Ω–æ–≤–∏—Ç—å ODataSyncWorker –¥–ª—è unified-reference
4. –û–±–Ω–æ–≤–∏—Ç—å VirtualEntitiesGeneratorWorker
5. –û–±–Ω–æ–≤–∏—Ç—å initializeWorkers.ts

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞:**
- ‚úÖ 10 —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Å–∏—Å—Ç–µ–º–µ
- ‚úÖ –ú–∞—Ä—à—Ä—É—Ç—ã –∏–∑ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ –≤ –Ø–∫—É—Ç–∏—é —Å—Ç—Ä–æ—è—Ç—Å—è
- ‚úÖ Hub-based –º–∞—Ä—à—Ä—É—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç

#### –≠—Ç–∞–ø 3: –°–º–µ—à–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –∏ –ø–µ—Ä–µ–ø—Ä–∞–≤–∞ (4-5 –¥–Ω–µ–π)

**–¶–µ–ª—å:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–º–µ—à–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã (air + ground + ferry), –ø–µ—Ä–µ–ø—Ä–∞–≤—É

**–ó–∞–¥–∞—á–∏:**
1. –†–∞—Å—à–∏—Ä–∏—Ç—å mock-–¥–∞–Ω–Ω—ã–µ (stops, routes, flights)
2. –î–æ–±–∞–≤–∏—Ç—å FERRY –≤ TransportType
3. –û–±–Ω–æ–≤–∏—Ç—å GraphBuilderWorker –¥–ª—è –ø–µ—Ä–µ—Å–∞–¥–æ–∫
4. –û–±–Ω–æ–≤–∏—Ç—å RouteGraphBuilder –¥–ª—è ferry
5. –°–æ–∑–¥–∞—Ç—å AirRouteGeneratorWorker

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞:**
- ‚úÖ –°–º–µ—à–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã —Å—Ç—Ä–æ—è—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ü–µ—Ä–µ–ø—Ä–∞–≤–∞ –Ø–∫—É—Ç—Å–∫ ‚Üî –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ü–µ—Ä–µ—Å–∞–¥–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –≤–µ—Å–∞–º–∏

#### –≠—Ç–∞–ø 4: –ì—Ä–∞—Ñ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è (3-4 –¥–Ω—è)

**–¶–µ–ª—å:** –í–∞–ª–∏–¥–∞—Ü–∏—è –≥—Ä–∞—Ñ–∞, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è, —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

**–ó–∞–¥–∞—á–∏:**
1. –°–æ–∑–¥–∞—Ç—å graph-validator
2. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤ GraphBuilderWorker
3. –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–µ—Ç—Ä–∏–∫–∏
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞:**
- ‚úÖ –ì—Ä–∞—Ñ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å
- ‚úÖ –í—Å–µ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã —Å—Ç—Ä–æ—è—Ç—Å—è
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —É—Å—Ç–æ–π—á–∏–≤–∞ –∫ –æ—à–∏–±–∫–∞–º

### 8.2 –°–ø–∏—Å–æ–∫ –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤

**–í—Å–µ–≥–æ –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤: 9**

#### –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ (3 —Ñ–∞–π–ª–∞)
1. `backend/data/reference/airports-reference.json`
2. `backend/data/reference/suburbs-reference.json`
3. `backend/data/reference/russia-federal-cities-reference.json`

#### –£—Ç–∏–ª–∏—Ç—ã (3 —Ñ–∞–π–ª–∞)
4. `backend/src/shared/utils/airports-loader.ts`
5. `backend/src/shared/utils/suburbs-loader.ts`
6. `backend/src/shared/utils/unified-cities-loader.ts`

#### –í–∞–ª–∏–¥–∞—Ç–æ—Ä—ã (2 —Ñ–∞–π–ª–∞)
7. `backend/src/shared/validators/stop-validator.ts`
8. `backend/src/shared/validators/graph-validator.ts`

#### –í–æ—Ä–∫–µ—Ä—ã (1 —Ñ–∞–π–ª)
9. `backend/src/application/workers/AirRouteGeneratorWorker.ts`

### 8.3 –°–ø–∏—Å–æ–∫ –æ–±–Ω–æ–≤–ª—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤

**–í—Å–µ–≥–æ –æ–±–Ω–æ–≤–ª—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤: 11**

#### –£—Ç–∏–ª–∏—Ç—ã (1 —Ñ–∞–π–ª)
1. `backend/src/shared/utils/city-normalizer.ts` - —Ñ—É–Ω–∫—Ü–∏—è `extractCityFromStopName()`

#### –í–æ—Ä–∫–µ—Ä—ã (4 —Ñ–∞–π–ª–∞)
2. `backend/src/application/workers/ODataSyncWorker.ts` - –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
3. `backend/src/application/workers/VirtualEntitiesGeneratorWorker.ts` - unified-cities-loader, hub-based –º–∞—Ä—à—Ä—É—Ç—ã
4. `backend/src/application/workers/GraphBuilderWorker.ts` - –ø–µ—Ä–µ—Å–∞–¥–∫–∏, ferry, –≤–∞–ª–∏–¥–∞—Ü–∏—è
5. `backend/src/infrastructure/workers/initializeWorkers.ts` - –ø–æ—Ä—è–¥–æ–∫ –≤–æ—Ä–∫–µ—Ä–æ–≤, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è AirRouteGeneratorWorker

#### –ü–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª–∏ –≥—Ä–∞—Ñ–∞ (1 —Ñ–∞–π–ª)
6. `backend/src/application/route-builder/RouteGraphBuilder.ts` - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ ferry

#### –î–æ–º–µ–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ (1 —Ñ–∞–π–ª)
7. `backend/src/domain/entities/Route.ts` - –¥–æ–±–∞–≤–∏—Ç—å `'FERRY'` –≤ `TransportType`

#### –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (1 —Ñ–∞–π–ª)
8. `backend/src/domain/repositories/IGraphRepository.ts` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ `transportType` (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

#### Mock-–¥–∞–Ω–Ω—ã–µ (3 —Ñ–∞–π–ª–∞)
9. `backend/data/mock/stops.json` - –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ –∏ –ø–µ—Ä–µ–ø—Ä–∞–≤—ã
10. `backend/data/mock/routes.json` - –∞–≤–∏–∞–º–∞—Ä—à—Ä—É—Ç—ã –∏ ferry-–º–∞—Ä—à—Ä—É—Ç—ã
11. `backend/data/mock/flights.json` - —Ä–µ–π—Å—ã –¥–ª—è –Ω–æ–≤—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤

### 8.4 –°–ø–∏—Å–æ–∫ —Ñ—É–Ω–∫—Ü–∏–π –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

#### –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–µ—Ä–µ–ø–∏—Å–∞–Ω–∏—è/–¥–æ–±–∞–≤–ª–µ–Ω–∏—è (8 —Ñ—É–Ω–∫—Ü–∏–π)

1. **`extractCityFromStopName()`** –≤ `city-normalizer.ts`
   - –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∞—ç—Ä–æ–ø–æ—Ä—Ç–æ–≤
   - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ –∞—ç—Ä–æ–ø–æ—Ä—Ç–æ–≤

2. **`parseODataResponse()`** –≤ `ODataSyncWorker.ts`
   - –î–æ–±–∞–≤–∏—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏
   - –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é —á–µ—Ä–µ–∑ stop-validator
   - –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —á–µ—Ä–µ–∑ unified-reference

3. **`generateVirtualStops()`** –≤ `VirtualEntitiesGeneratorWorker.ts`
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å unified-cities-loader
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤

4. **`ensureYakutiaCitiesConnectivity()` ‚Üí `ensureCitiesConnectivity()`** –≤ `VirtualEntitiesGeneratorWorker.ts`
   - –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å
   - –î–æ–±–∞–≤–∏—Ç—å hub-based –º–∞—Ä—à—Ä—É—Ç—ã –¥–ª—è —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤

5. **`buildGraphStructure()`** –≤ `GraphBuilderWorker.ts`
   - –î–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ –ø–æ –≥–æ—Ä–æ–¥–∞–º
   - –î–æ–±–∞–≤–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Ä—ë–±–µ—Ä –ø–µ—Ä–µ—Å–∞–¥–∫–∏
   - –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É ferry —Å —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å—é

6. **`calculateTransferWeight()`** –≤ `GraphBuilderWorker.ts` (–ù–û–í–ê–Ø)
   - –†–∞—Å—á–µ—Ç –≤–µ—Å–∞ –ø–µ—Ä–µ—Å–∞–¥–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

7. **`calculateFerryWeight()`** –≤ `GraphBuilderWorker.ts` (–ù–û–í–ê–Ø)
   - –†–∞—Å—á–µ—Ç –≤–µ—Å–∞ ferry —Å —É—á–µ—Ç–æ–º —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏

8. **`executeWorkerLogic()`** –≤ `GraphBuilderWorker.ts`
   - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≥—Ä–∞—Ñ–∞

#### –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è (3 —Å—Ç—Ä—É–∫—Ç—É—Ä—ã)

1. **`TransportType`** –≤ `Route.ts`
   - –î–æ–±–∞–≤–∏—Ç—å `'FERRY'` –≤ union type
   - –û–±–Ω–æ–≤–∏—Ç—å `validTransportTypes`

2. **`GraphNeighbor`** –≤ `IGraphRepository.ts`
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ `metadata.transportType`
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç `TRANSFER`, `FERRY`

3. **`Route.metadata`** (—É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è `ferrySchedule` (—É–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `Record<string, unknown>`)

### 8.5 –°–ø–∏—Å–æ–∫ —Ç–µ—Å—Ç–æ–≤

**–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤: 15 —Ñ–∞–π–ª–æ–≤ (9 –Ω–æ–≤—ã—Ö + 6 –æ–±–Ω–æ–≤–ª—è–µ–º—ã—Ö)**

#### –ù–æ–≤—ã–µ —Ç–µ—Å—Ç—ã (9 —Ñ–∞–π–ª–æ–≤)

1. `backend/src/__tests__/unit/utils/airports-loader.test.ts`
2. `backend/src/__tests__/unit/utils/suburbs-loader.test.ts`
3. `backend/src/__tests__/unit/utils/unified-cities-loader.test.ts`
4. `backend/src/__tests__/unit/validators/stop-validator.test.ts`
5. `backend/src/__tests__/unit/validators/graph-validator.test.ts`
6. `backend/src/__tests__/unit/workers/AirRouteGeneratorWorker.test.ts`

#### –û–±–Ω–æ–≤–ª—è–µ–º—ã–µ —Ç–µ—Å—Ç—ã (6 —Ñ–∞–π–ª–æ–≤)

1. `backend/src/__tests__/unit/utils/city-normalizer.test.ts` - —Ç–µ—Å—Ç—ã –¥–ª—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∞—ç—Ä–æ–ø–æ—Ä—Ç–æ–≤
2. `backend/src/__tests__/unit/workers/ODataSyncWorker.test.ts` - —Ç–µ—Å—Ç—ã –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
3. `backend/src/__tests__/unit/workers/VirtualEntitiesGeneratorWorker.test.ts` - —Ç–µ—Å—Ç—ã –¥–ª—è unified-cities-loader, hub-based –º–∞—Ä—à—Ä—É—Ç–æ–≤
4. `backend/src/__tests__/unit/workers/GraphBuilderWorker.test.ts` - —Ç–µ—Å—Ç—ã –¥–ª—è –ø–µ—Ä–µ—Å–∞–¥–æ–∫, ferry, –≤–∞–ª–∏–¥–∞—Ü–∏–∏
5. `backend/src/__tests__/unit/route-builder/RouteGraphBuilder.test.ts` - —Ç–µ—Å—Ç—ã –¥–ª—è ferry
6. `backend/src/__tests__/integration/use-cases/OptimizedBuildRouteUseCase.integration.test.ts` - —Ç–µ—Å—Ç—ã –¥–ª—è —Å–º–µ—à–∞–Ω–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤

### 8.6 –ü–æ—Ä—è–¥–æ–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

#### –§–∞–∑–∞ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ (–º–æ–∂–Ω–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)
1. –°–æ–∑–¥–∞—Ç—å `airports-reference.json`
2. –°–æ–∑–¥–∞—Ç—å `suburbs-reference.json`
3. –°–æ–∑–¥–∞—Ç—å `russia-federal-cities-reference.json`

#### –§–∞–∑–∞ 2: –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑—á–∏–∫–æ–≤
4. –°–æ–∑–¥–∞—Ç—å `airports-loader.ts` + —Ç–µ—Å—Ç—ã
5. –°–æ–∑–¥–∞—Ç—å `suburbs-loader.ts` + —Ç–µ—Å—Ç—ã
6. –°–æ–∑–¥–∞—Ç—å `unified-cities-loader.ts` + —Ç–µ—Å—Ç—ã

#### –§–∞–∑–∞ 3: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ)
7. –°–æ–∑–¥–∞—Ç—å `stop-validator.ts` + —Ç–µ—Å—Ç—ã
8. –ò—Å–ø—Ä–∞–≤–∏—Ç—å `extractCityFromStopName()` –≤ `city-normalizer.ts` + —Ç–µ—Å—Ç—ã
9. –û–±–Ω–æ–≤–∏—Ç—å `parseODataResponse()` –≤ `ODataSyncWorker.ts` + —Ç–µ—Å—Ç—ã
10. **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ó–∞–ø—É—Å—Ç–∏—Ç—å ODataSyncWorker, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é

#### –§–∞–∑–∞ 4: –§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ)
11. –û–±–Ω–æ–≤–∏—Ç—å `ODataSyncWorker` –¥–ª—è unified-reference
12. –û–±–Ω–æ–≤–∏—Ç—å `VirtualEntitiesGeneratorWorker` + —Ç–µ—Å—Ç—ã
13. –û–±–Ω–æ–≤–∏—Ç—å `initializeWorkers.ts`
14. **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤–æ—Ä–∫–µ—Ä—ã, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞

#### –§–∞–∑–∞ 5: –°–º–µ—à–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ)
15. –û–±–Ω–æ–≤–∏—Ç—å mock-–¥–∞–Ω–Ω—ã–µ (stops.json, routes.json, flights.json)
16. –î–æ–±–∞–≤–∏—Ç—å `'FERRY'` –≤ `TransportType` –≤ `Route.ts`
17. –°–æ–∑–¥–∞—Ç—å `AirRouteGeneratorWorker.ts` + —Ç–µ—Å—Ç—ã
18. –û–±–Ω–æ–≤–∏—Ç—å `GraphBuilderWorker` –¥–ª—è –ø–µ—Ä–µ—Å–∞–¥–æ–∫ + —Ç–µ—Å—Ç—ã
19. –û–±–Ω–æ–≤–∏—Ç—å `RouteGraphBuilder` –¥–ª—è ferry + —Ç–µ—Å—Ç—ã
20. **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–º–µ—à–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã, –ø–µ—Ä–µ–ø—Ä–∞–≤—É

#### –§–∞–∑–∞ 6: –í–∞–ª–∏–¥–∞—Ü–∏—è –≥—Ä–∞—Ñ–∞ (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ)
21. –°–æ–∑–¥–∞—Ç—å `graph-validator.ts` + —Ç–µ—Å—Ç—ã
22. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤ `GraphBuilderWorker` + —Ç–µ—Å—Ç—ã
23. –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–µ—Ç—Ä–∏–∫–∏
24. **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã

#### –§–∞–∑–∞ 7: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
25. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ unit-—Ç–µ—Å—Ç—ã
26. –ó–∞–ø—É—Å—Ç–∏—Ç—å integration-—Ç–µ—Å—Ç—ã
27. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
28. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

### 8.7 –†–∏—Å–∫–∏ –∏ –ø—É—Ç–∏ —Ä–µ—à–µ–Ω–∏—è

#### –†–∏—Å–∫ 1: –ö–æ–Ω—Ñ–ª–∏–∫—Ç TransportType (Route.ts vs RouteSegment.ts)

**–ü—Ä–æ–±–ª–µ–º–∞:** 
- `Route.ts` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç union type: `'BUS' | 'TRAIN' | 'PLANE' | 'WATER'`
- `RouteSegment.ts` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç enum: `TransportType { FERRY = 'ferry', ... }`
- –ú–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–∏—Ç—å `'FERRY'` –≤ `Route.ts` union type
- –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: –≤–µ–∑–¥–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `'FERRY'` (lowercase) –∏–ª–∏ enum
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –º–µ—Å—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –µ–¥–∏–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É

#### –†–∏—Å–∫ 2: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≥—Ä–∞—Ñ–∞ —Å –ø–µ—Ä–µ—Å–∞–¥–∫–∞–º–∏

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ –≤ –≥–æ—Ä–æ–¥–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä—ë–±–µ—Ä –ø–µ—Ä–µ—Å–∞–¥–∫–∏ —Ä–∞—Å—Ç–µ—Ç –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ
- –î–ª—è –≥–æ—Ä–æ–¥–∞ —Å N –æ—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏: N*(N-1) —Ä—ë–±–µ—Ä –ø–µ—Ä–µ—Å–∞–¥–∫–∏

**–†–µ—à–µ–Ω–∏–µ:**
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Map)
- –†–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–∞–ª—å–Ω–æ —Å–≤—è–∑–∞–Ω—ã –º–∞—Ä—à—Ä—É—Ç–∞–º–∏
- –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
- –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä—ë–±–µ—Ä –ø–µ—Ä–µ—Å–∞–¥–∫–∏ (—Ç–æ–ª—å–∫–æ –º–µ–∂–¥—É –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏)

#### –†–∏—Å–∫ 3: –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–æ—Å–ª–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –ë–î –º–æ–≥—É—Ç –∏–º–µ—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ `city_id`
- –ú–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –º–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

**–†–µ—à–µ–Ω–∏–µ:**
- –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å: –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å `city_id`
- –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π
- –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ë–î

#### –†–∏—Å–∫ 4: –û—à–∏–±–∫–∏ –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞—Ö

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞—Ö –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏

**–†–µ—à–µ–Ω–∏–µ:**
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
- Unit-—Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

#### –†–∏—Å–∫ 5: –°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏ —Å–º–µ—à–∞–Ω–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ú–Ω–æ–≥–æ—ç—Ç–∞–ø–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã —Å–ª–æ–∂–Ω–æ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–æ—á–µ–≤–∏–¥–Ω–æ, –ø–æ—á–µ–º—É –º–∞—Ä—à—Ä—É—Ç –Ω–µ —Å—Ç—Ä–æ–∏—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–∞
- –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ–≥–º–µ–Ω—Ç–æ–≤, —Ç–∏–ø—ã —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞, –≤–µ—Å–∞
- –°–æ–∑–¥–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∞
- –î–æ–±–∞–≤–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ endpoints –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥—Ä–∞—Ñ–∞

### 8.8 –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞

#### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

- **–ù–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤:** 9
- **–û–±–Ω–æ–≤–ª—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:** 11
- **–ù–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π:** 8
- **–°—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:** 3
- **–§–∞–π–ª–æ–≤ —Ç–µ—Å—Ç–æ–≤:** 15 (9 –Ω–æ–≤—ã—Ö + 6 –æ–±–Ω–æ–≤–ª—è–µ–º—ã—Ö)
- **–û–±—â–µ–µ –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:** 12-16 –¥–Ω–µ–π

#### –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

1. ‚úÖ –Ø–∫—É—Ç—Å–∫ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
2. ‚úÖ "–¢—É–π–º–∞–¥–∞" –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥
3. ‚úÖ –ú—É—Å–æ—Ä–Ω—ã–µ –∑–∞–ø–∏—Å–∏ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö
4. ‚úÖ 10 —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Å–∏—Å—Ç–µ–º–µ
5. ‚úÖ –ú–∞—Ä—à—Ä—É—Ç—ã –∏–∑ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ –≤ –Ø–∫—É—Ç–∏—é —Å—Ç—Ä–æ—è—Ç—Å—è
6. ‚úÖ –°–º–µ—à–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã (air + ground + ferry) —Å—Ç—Ä–æ—è—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
7. ‚úÖ –ü–µ—Ä–µ–ø—Ä–∞–≤–∞ –Ø–∫—É—Ç—Å–∫ ‚Üî –ù–∏–∂–Ω–∏–π –ë–µ—Å—Ç—è—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ ferry-—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç
8. ‚úÖ –ü–µ—Ä–µ—Å–∞–¥–∫–∏ –º–µ–∂–¥—É —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞–º–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
9. ‚úÖ –ì—Ä–∞—Ñ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —É–∑–ª–æ–≤ –∏ –≤–µ—Å–æ–≤
10. ‚úÖ –í—Å–µ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã —Å—Ç—Ä–æ—è—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
11. ‚úÖ –°–∏—Å—Ç–µ–º–∞ —É—Å—Ç–æ–π—á–∏–≤–∞ –∫ –æ—à–∏–±–∫–∞–º, –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –æ—à–∏–±–∫–∏ –Ω–µ –≤–æ–∑–Ω–∏–∫–∞—é—Ç

#### –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—É—Ç—å –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏:**
1. –≠—Ç–∞–ø 1 ‚Üí –≠—Ç–∞–ø 2 ‚Üí –≠—Ç–∞–ø 3 ‚Üí –≠—Ç–∞–ø 4

**–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏:**
- –°–æ–∑–¥–∞–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ (airports, suburbs, federal cities)
- –ù–∞–ø–∏—Å–∞–Ω–∏–µ unit-—Ç–µ—Å—Ç–æ–≤ –¥–ª—è –Ω–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ mock-–¥–∞–Ω–Ω—ã—Ö

#### –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

–ü–ª–∞–Ω –≥–æ—Ç–æ–≤ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é. –í—Å–µ —Ñ–∞–π–ª—ã, —Ñ—É–Ω–∫—Ü–∏–∏ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã.

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –î–æ–∂–¥–∞—Ç—å—Å—è –∫–æ–º–∞–Ω–¥—ã "–≤—ã–ø–æ–ª–Ω—è–π" –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.

---

**–ö–æ–Ω–µ—Ü –¥–æ–∫—É–º–µ–Ω—Ç–∞**