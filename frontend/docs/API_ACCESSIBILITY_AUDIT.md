# –ü–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Backend-API –∏–∑ Frontend

**–î–∞—Ç–∞:** 2025-01-XX  
**–°—Ç–∞—Ç—É—Å:** –ê–Ω–∞–ª–∏–∑ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ 1. Env-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

### –§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**–ù–∞–π–¥–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `frontend/env.local` ‚Äî –ª–æ–∫–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- `docker-compose.yml` ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Docker

### –ê–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

**–§–∞–π–ª:** `frontend/env.local`
```env
NEXT_PUBLIC_API_URL=http://localhost:5000
NEXT_PUBLIC_API_VERSION=v1
```

**–§–∞–π–ª:** `docker-compose.yml` (—Å—Ç—Ä–æ–∫–∏ 144-145)
```yaml
environment:
  NEXT_PUBLIC_API_URL: ${NEXT_PUBLIC_API_URL:-http://localhost:5000}
  NEXT_PUBLIC_API_VERSION: ${NEXT_PUBLIC_API_VERSION:-v1}
```

**–§–∞–π–ª:** `frontend/src/shared/constants/api.ts` (—Å—Ç—Ä–æ–∫–∏ 10-16)
```typescript
export const API_URL = 
  typeof window !== 'undefined'
    ? (process.env.NEXT_PUBLIC_API_URL || 'http://localhost:5000')
    : (process.env.NEXT_PUBLIC_API_URL || process.env.API_URL || 'http://localhost:5000');

export const API_VERSION = process.env.NEXT_PUBLIC_API_VERSION || 'v1';
export const API_BASE_URL = `${API_URL}/api/${API_VERSION}`;
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ 1

‚úÖ **–°—Ç–∞—Ç—É—Å:** –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞

- **–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞:** `http://localhost:5000` (–∏–∑ `env.local`)
- **Docker:** `http://localhost:5000` (–∏–∑ `docker-compose.yml`)
- **Fallback:** `http://localhost:5000` (–∏–∑ –∫–æ–¥–∞)

**–ß—Ç–æ –≤–∏–¥–∏—Ç –±—Ä–∞—É–∑–µ—Ä:**
- `NEXT_PUBLIC_API_URL=http://localhost:5000` (—á–µ—Ä–µ–∑ `NEXT_PUBLIC_*` –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –±—Ä–∞—É–∑–µ—Ä–µ)

**–ß—Ç–æ –≤–∏–¥–∏—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ñ—Ä–æ–Ω—Ç–∞ (SSR):**
- `NEXT_PUBLIC_API_URL=http://localhost:5000` (–¥–ª—è SSR)
- `API_URL=http://localhost:5000` (fallback –¥–ª—è SSR)

**‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
- –í Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ —Ñ—Ä–æ–Ω—Ç–∞ `http://localhost:5000` –±—É–¥–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ —Å–∞–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –∞ –Ω–µ –Ω–∞ backend.
- –î–ª—è SSR –≤–Ω—É—Ç—Ä–∏ Docker –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –∏–º—è —Å–µ—Ä–≤–∏—Å–∞: `http://backend:5000`
- –ù–æ –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (–±—Ä–∞—É–∑–µ—Ä) `http://localhost:5000` –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π, —Ç–∞–∫ –∫–∞–∫ –ø–æ—Ä—Ç –ø—Ä–æ–±—Ä–æ—à–µ–Ω –Ω–∞—Ä—É–∂—É.

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ 2. –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ—Ä–æ–Ω—Ç

### –¶–µ–ø–æ—á–∫–∞ –≤—ã–∑–æ–≤–æ–≤

**1. Hook:** `frontend/src/shared/hooks/use-cities.ts`
```typescript
export function useCities(): UseCitiesResult {
  const { data, isLoading, error } = useQuery<string[]>({
    queryKey: ['cities'],
    queryFn: () => fetchCities(),
    // ...
  });
}
```

**2. API —Ñ—É–Ω–∫—Ü–∏—è:** `frontend/src/shared/utils/cities-api.ts`
```typescript
export async function fetchCities(): Promise<string[]> {
  try {
    const response = await fetchApi<CitiesResponse>('/cities');
    // ...
  }
}
```

**3. –ë–∞–∑–æ–≤—ã–π fetch:** `frontend/src/shared/utils/api.ts` (—Å—Ç—Ä–æ–∫–∞ 17)
```typescript
export async function fetchApi<T>(endpoint: string, options?: RequestInit): Promise<T> {
  const url = `${API_BASE_URL}${endpoint}`;
  // ...
}
```

### –§–∏–Ω–∞–ª—å–Ω—ã–π URL

**–°–±–æ—Ä–∫–∞ URL:**
- `API_BASE_URL` = `http://localhost:5000/api/v1` (–∏–∑ `api.ts`)
- `endpoint` = `/cities` (–∏–∑ `cities-api.ts`)
- **–ò—Ç–æ–≥–æ–≤—ã–π URL:** `http://localhost:5000/api/v1/cities`

### –†–µ–∞–ª—å–Ω—ã–π API endpoint

**Backend route:** `backend/src/presentation/routes/index.ts` (—Å—Ç—Ä–æ–∫–∞ 27-31)
```typescript
router.get(
  '/cities',
  validateRequest({ query: paginationSchema }),
  CitiesController.getCities
);
```

**–ü–æ–ª–Ω—ã–π –ø—É—Ç—å:** `/api/v1/cities` (–ø—Ä–µ—Ñ–∏–∫—Å `/api/v1` –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ `backend/src/index.ts`, —Å—Ç—Ä–æ–∫–∞ 101)

### –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ 2

‚úÖ **–°—Ç–∞—Ç—É—Å:** URL —Å–æ–≤–ø–∞–¥–∞–µ—Ç

- **–ü—Ä–æ—Ç–æ–∫–æ–ª:** `http`
- **–•–æ—Å—Ç:** `localhost`
- **–ü–æ—Ä—Ç:** `5000`
- **–ü—É—Ç—å:** `/api/v1/cities`
- **–ü–æ–ª–Ω—ã–π URL:** `http://localhost:5000/api/v1/cities`

**–°–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º API:** ‚úÖ –î–∞

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ CORS

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è CORS –Ω–∞ backend

**–§–∞–π–ª:** `backend/src/shared/utils/cors-config.ts`
```typescript
export function getCorsConfig() {
  const allowedOrigins = parseCorsOrigins(process.env.CORS_ORIGINS || process.env.CORS_ORIGIN);
  // ...
  return {
    origin: createCorsOriginValidator(allowedOrigins, logBlocked),
    credentials: true,
    methods: ['GET', 'POST', 'PUT', 'DELETE', 'OPTIONS', 'PATCH'],
    // ...
  };
}
```

**–§–∞–π–ª:** `docker-compose.yml` (—Å—Ç—Ä–æ–∫–∞ 105)
```yaml
CORS_ORIGIN: ${CORS_ORIGIN:-http://localhost:3000}
```

**–§—É–Ω–∫—Ü–∏—è –ø–∞—Ä—Å–∏–Ω–≥–∞:** `backend/src/shared/utils/cors-config.ts` (—Å—Ç—Ä–æ–∫–∏ 14-26)
```typescript
export function parseCorsOrigins(envValue?: string): string[] {
  if (!envValue) {
    return ['http://localhost:3000']; // Default for development
  }
  // Split by comma and trim whitespace
  const origins = envValue
    .split(',')
    .map(origin => origin.trim())
    .filter(origin => origin.length > 0);
  return origins.length > 0 ? origins : ['http://localhost:3000'];
}
```

### –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ origins

**–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `http://localhost:3000`  
**–ò–∑ docker-compose.yml:** `${CORS_ORIGIN:-http://localhost:3000}`

### Origin —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

**–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞:** `http://localhost:3000`  
**Docker:** `http://localhost:3000` (–ø–æ—Ä—Ç –ø—Ä–æ–±—Ä–æ—à–µ–Ω –Ω–∞—Ä—É–∂—É)

### –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ 3

‚úÖ **–°—Ç–∞—Ç—É—Å:** CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

- **–†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–π origin:** `http://localhost:3000`
- **Origin —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞:** `http://localhost:3000`
- **–°–æ–≤–ø–∞–¥–µ–Ω–∏–µ:** ‚úÖ –î–∞

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:**
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ origins —á–µ—Ä–µ–∑ `CORS_ORIGINS` (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö origins –≤–∫–ª—é—á–µ–Ω–æ –≤ development
- –ó–∞–ø—Ä–æ—Å—ã –±–µ–∑ origin —Ä–∞–∑—Ä–µ—à–µ–Ω—ã (–¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, Postman)

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ 4. Docker-—Å–µ—Ç—å

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker

**–§–∞–π–ª:** `docker-compose.yml`

**Backend —Å–µ—Ä–≤–∏—Å:**
```yaml
backend:
  container_name: travel-app-backend
  ports:
    - "${BACKEND_PORT:-5000}:5000"
  networks:
    - travel-app-network
```

**Frontend —Å–µ—Ä–≤–∏—Å:**
```yaml
frontend:
  container_name: travel-app-frontend
  environment:
    NEXT_PUBLIC_API_URL: ${NEXT_PUBLIC_API_URL:-http://localhost:5000}
  ports:
    - "${FRONTEND_PORT:-3000}:3000"
  networks:
    - travel-app-network
  depends_on:
    - backend
```

**–°–µ—Ç—å:**
```yaml
networks:
  travel-app-network:
    driver: bridge
```

### –ê–Ω–∞–ª–∏–∑ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

**–í–Ω—É—Ç—Ä–∏ Docker:**
- Backend –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∏–º–µ–Ω–∏ —Å–µ—Ä–≤–∏—Å–∞: `http://backend:5000`
- Frontend –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∏–º–µ–Ω–∏ —Å–µ—Ä–≤–∏—Å–∞: `http://frontend:3000`

**–°–Ω–∞—Ä—É–∂–∏ Docker (–±—Ä–∞—É–∑–µ—Ä):**
- Backend –¥–æ—Å—Ç—É–ø–µ–Ω: `http://localhost:5000` (–ø–æ—Ä—Ç –ø—Ä–æ–±—Ä–æ—à–µ–Ω)
- Frontend –¥–æ—Å—Ç—É–ø–µ–Ω: `http://localhost:3000` (–ø–æ—Ä—Ç –ø—Ä–æ–±—Ä–æ—à–µ–Ω)

### –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ 4

‚ö†Ô∏è **–°—Ç–∞—Ç—É—Å:** –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –¥–ª—è SSR

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –í `frontend/src/shared/constants/api.ts` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `http://localhost:5000` –¥–ª—è –≤—Å–µ—Ö —Å–ª—É—á–∞–µ–≤
- –î–ª—è **–∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤** (–±—Ä–∞—É–∑–µ—Ä) —ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ: `http://localhost:5000`
- –î–ª—è **SSR –∑–∞–ø—Ä–æ—Å–æ–≤** (–≤–Ω—É—Ç—Ä–∏ Docker) —ç—Ç–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `http://backend:5000`

**–¢–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞:**
```typescript
export const API_URL = 
  typeof window !== 'undefined'
    ? (process.env.NEXT_PUBLIC_API_URL || 'http://localhost:5000')  // –ë—Ä–∞—É–∑–µ—Ä ‚úÖ
    : (process.env.NEXT_PUBLIC_API_URL || process.env.API_URL || 'http://localhost:5000'); // SSR ‚ö†Ô∏è
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- –î–ª—è SSR –≤–Ω—É—Ç—Ä–∏ Docker –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `process.env.API_URL=http://backend:5000`
- –ù–æ —ç—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, –µ—Å–ª–∏ SSR –Ω–µ –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∫ API (–∏–ª–∏ –¥–µ–ª–∞–µ—Ç —á–µ—Ä–µ–∑ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–¥)

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤:**
- ‚úÖ –ü–æ—Ä—Ç 5000 –ø—Ä–æ–±—Ä–æ—à–µ–Ω –Ω–∞—Ä—É–∂—É: `${BACKEND_PORT:-5000}:5000`
- ‚úÖ –ü–æ—Ä—Ç 3000 –ø—Ä–æ–±—Ä–æ—à–µ–Ω –Ω–∞—Ä—É–∂—É: `${FRONTEND_PORT:-3000}:3000`

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ 5. Proxy –≤ Next.js

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Next.js

**–§–∞–π–ª:** `frontend/next.config.js`

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ proxy/rewrites:**
- ‚ùå –ù–µ—Ç —Å–µ–∫—Ü–∏–∏ `rewrites`
- ‚ùå –ù–µ—Ç —Å–µ–∫—Ü–∏–∏ `async rewrites()`
- ‚ùå –ù–µ—Ç middleware –¥–ª—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è

### –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ 5

‚úÖ **–°—Ç–∞—Ç—É—Å:** Proxy –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ)

**–í—ã–≤–æ–¥:**
- Frontend –¥–µ–ª–∞–µ—Ç –ø—Ä—è–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ `http://localhost:5000/api/v1/cities`
- Proxy –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- –≠—Ç–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–ª—è development –∏ production (–µ—Å–ª–∏ backend –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞–ø—Ä—è–º—É—é)

**‚ö†Ô∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:**
- –ï—Å–ª–∏ frontend –∏ backend –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –¥–æ–º–µ–Ω–∞—Ö –≤ production, –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è proxy –∏–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ CORS

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ 6. –†–µ–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API

### –í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

**URL –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:** `http://localhost:5000/api/v1/cities`

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**

1. **Network Error (ECONNREFUSED)**
   - Backend –Ω–µ –∑–∞–ø—É—â–µ–Ω
   - –ü–æ—Ä—Ç 5000 –Ω–µ —Å–ª—É—à–∞–µ—Ç—Å—è
   - Firewall –±–ª–æ–∫–∏—Ä—É–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ

2. **CORS Blocked**
   - Origin `http://localhost:3000` –Ω–µ —Ä–∞–∑—Ä–µ—à–µ–Ω
   - ‚ùå **–ù–ï –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ** (CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ)

3. **–ù–µ–≤–µ—Ä–Ω—ã–π URL**
   - –ü—É—Ç—å –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å backend route
   - ‚ùå **–ù–ï –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ** (–ø—É—Ç—å —Å–æ–≤–ø–∞–¥–∞–µ—Ç: `/api/v1/cities`)

4. **Timeout**
   - Backend —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ –æ—Ç–≤–µ—á–∞–µ—Ç
   - Network latency

5. **404 Not Found**
   - Route –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
   - ‚ùå **–ù–ï –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ** (route –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω)

6. **500 Internal Server Error**
   - –û—à–∏–±–∫–∞ –Ω–∞ backend
   - –ü—Ä–æ–±–ª–µ–º–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

### –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ API

**Backend –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `backend/src/presentation/controllers/CitiesController.ts` (—Å—Ç—Ä–æ–∫–∏ 200-213)
```typescript
const response = createPaginatedResponse(paginatedCities, total, page, limit);

res.json({
  ...response,  // { data: [...], pagination: {...} }
  mode: 'database',
  quality: 100,
  source: 'PostgreSQL',
  loadedAt: new Date().toISOString(),
  statistics: { ... }
});
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "data": ["–Ø–∫—É—Ç—Å–∫", "–ú–∏—Ä–Ω—ã–π", ...],
  "pagination": {
    "page": 1,
    "limit": 10,
    "total": 50,
    "totalPages": 5,
    "hasNext": true,
    "hasPrev": false
  },
  "mode": "database",
  "quality": 100,
  "source": "PostgreSQL",
  "loadedAt": "2025-01-XX...",
  "statistics": { ... }
}
```

**Frontend –æ–∂–∏–¥–∞–µ—Ç:** `frontend/src/shared/schemas/cities.schema.ts`
```typescript
export const CitiesResponseSchema = z.object({
  cities: z.array(z.string().min(1)),  // ‚ùå –û–∂–∏–¥–∞–µ—Ç –ø–æ–ª–µ "cities"
  // ...
});
```

**Frontend –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å:** `frontend/src/shared/utils/cities-api.ts` (—Å—Ç—Ä–æ–∫–∞ 17)
```typescript
return validatedResponse.cities || [];  // ‚ùå –ò—â–µ—Ç –ø–æ–ª–µ "cities", –Ω–æ backend –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç "data"
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ 6

‚ùå **–°—Ç–∞—Ç—É—Å:** –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê ‚Äî –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ –æ—Ç–≤–µ—Ç–∞

**–ü—Ä–æ–±–ª–µ–º–∞:**
- Backend –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `{ data: [...], pagination: {...}, ... }`
- Frontend –æ–∂–∏–¥–∞–µ—Ç: `{ cities: [...] }`
- Frontend –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å: `response.cities` (–Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
- –†–µ–∑—É–ª—å—Ç–∞—Ç: `validatedResponse.cities` = `undefined`
- Fallback: –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–ø–∏—Å–æ–∫ –≥–æ—Ä–æ–¥–æ–≤

**–≠—Ç–æ –æ–±—ä—è—Å–Ω—è–µ—Ç, –ø–æ—á–µ–º—É:**
- –ó–∞–ø—Ä–æ—Å –º–æ–∂–µ—Ç –±—ã—Ç—å —É—Å–ø–µ—à–Ω—ã–º (200 OK)
- –ù–æ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–∞—Ä—Å—è—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback —Å–ø–∏—Å–æ–∫

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ 7. –§–∏–Ω–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥

### –¢–æ—á–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã

**–û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ –æ—Ç–≤–µ—Ç–∞ API

**–î–µ—Ç–∞–ª–∏:**
1. Backend –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–∞–≥–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç: `{ data: [...], pagination: {...} }`
2. Frontend –æ–∂–∏–¥–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫: `{ cities: [...] }`
3. –í–∞–ª–∏–¥–∞—Ü–∏—è Zod –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç (–∏–ª–∏ –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–∞—Å—Ç–∏—á–Ω–æ)
4. Frontend –∏—Å–ø–æ–ª—å–∑—É–µ—Ç fallback —Å–ø–∏—Å–æ–∫ –≥–æ—Ä–æ–¥–æ–≤

### –†–∞–∑—Ä—ã–≤ –Ω–∞ —à–∞–≥–µ

**–®–∞–≥ 6:** Frontend —Å–æ–±–∏—Ä–∞–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å –∫ –¥–∞–Ω–Ω—ã–º

**–ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ:**
- –ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ: ‚úÖ
- URL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π: ‚úÖ
- CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ: ‚úÖ
- Backend –æ—Ç–≤–µ—á–∞–µ—Ç: ‚úÖ (–ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ)
- **–ù–æ:** Frontend –Ω–µ –º–æ–∂–µ—Ç —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å –æ—Ç–≤–µ—Ç –∏–∑-–∑–∞ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ñ–æ—Ä–º–∞—Ç–∞

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **SSR –≤ Docker:**
   - –î–ª—è SSR –∑–∞–ø—Ä–æ—Å–æ–≤ –≤–Ω—É—Ç—Ä–∏ Docker –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `http://backend:5000`
   - –°–µ–π—á–∞—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `http://localhost:5000` (–º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ Docker)

2. **–í–∞–ª–∏–¥–∞—Ü–∏—è Zod:**
   - –°—Ö–µ–º–∞ `CitiesResponseSchema` –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–º—É –æ—Ç–≤–µ—Ç—É backend
   - –ù—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ö–µ–º—É –∏–ª–∏ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞:**
   - –í–∞—Ä–∏–∞–Ω—Ç A: –û–±–Ω–æ–≤–∏—Ç—å `CitiesResponseSchema` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ `{ data: [...], pagination: {...} }`
   - –í–∞—Ä–∏–∞–Ω—Ç B: –û–±–Ω–æ–≤–∏—Ç—å `cities-api.ts` –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ `response.data`
   - –í–∞—Ä–∏–∞–Ω—Ç C: –ò–∑–º–µ–Ω–∏—Ç—å backend –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ `{ cities: [...] }` (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è, –ª–æ–º–∞–µ—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏—é)

2. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å SSR –≤ Docker:**
   - –î–æ–±–∞–≤–∏—Ç—å `API_URL=http://backend:5000` –≤ `docker-compose.yml` –¥–ª—è frontend —Å–µ—Ä–≤–∏—Å–∞
   - –û–±–Ω–æ–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –≤ `api.ts` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `API_URL` –≤ SSR

3. **–î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–≤–µ—Ç –æ—Ç backend
   - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ Zod
   - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ fallback —Å–ø–∏—Å–∫–∞

---

## –ò—Ç–æ–≥–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø—Ä–æ–±–ª–µ–º

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å | –®–∞–≥ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è |
|---|----------|-------------|-----------------|
| 1 | –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ –æ—Ç–≤–µ—Ç–∞ (`data` vs `cities`) | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è | 6 |
| 2 | SSR –≤ Docker –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `localhost` –≤–º–µ—Å—Ç–æ `backend` | üü° –°—Ä–µ–¥–Ω—è—è | 4 |
| 3 | –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫ –ø–∞—Ä—Å–∏–Ω–≥–∞ | üü¢ –ù–∏–∑–∫–∞—è | 6 |

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ –æ—à–∏–±–∫–∏ "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É":**

–°–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, —ç—Ç–æ **–Ω–µ –ø—Ä–æ–±–ª–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**, –∞ –ø—Ä–æ–±–ª–µ–º–∞ **–ø–∞—Ä—Å–∏–Ω–≥–∞ –æ—Ç–≤–µ—Ç–∞**:
1. –ó–∞–ø—Ä–æ—Å —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è
2. Backend –æ—Ç–≤–µ—á–∞–µ—Ç (200 OK)
3. –ù–æ —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–Ω–∏—è–º frontend
4. –í–∞–ª–∏–¥–∞—Ü–∏—è Zod –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç
5. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback —Å–ø–∏—Å–æ–∫
6. –ï—Å–ª–∏ fallback –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ—Ä—è–¥–æ–∫ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
1. –û–±–Ω–æ–≤–∏—Ç—å `cities-api.ts` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–æ—Ä–º–∞—Ç–æ–º `{ data: [...] }`
2. –û–±–Ω–æ–≤–∏—Ç—å `CitiesResponseSchema` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø–∞–≥–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
3. –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
4. –ò—Å–ø—Ä–∞–≤–∏—Ç—å SSR –≤ Docker (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SSR –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API)

